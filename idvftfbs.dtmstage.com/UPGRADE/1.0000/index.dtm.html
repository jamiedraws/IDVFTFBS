

<!DOCTYPE html>
<html lang="en" class="dtm">
  
	<head>

		<title>Finishing Touch Flawless™</title>

		

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="The Flawless™ mission is to help women everywhere look and feel their best. We provide the best, innovative solutions for everyday beauty problems by making products that provide the Finishing Touch needed to look and feel Flawless™ every day.">

<!-- // Open Graph Metadata -->
<meta property="og:title" content="Finishing Touch Flawless™">
<meta property="og:type" content="website">
<meta property="og:description" content="The Flawless™ mission is to help women everywhere look and feel their best. We provide the best, innovative solutions for everyday beauty problems by making products that provide the Finishing Touch needed to look and feel Flawless™ every day.">
<meta property="og:url" content="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Index.dtm">
<meta property="og:image" content="https://idvftfbs.dtmstage.com/images/UPGRADE/social/share-banner.jpg">

<!-- // Twitter Metadata -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Finishing Touch Flawless™">
<meta name="twitter:description" content="The Flawless™ mission is to help women everywhere look and feel their best. We provide the best, innovative solutions for everyday beauty problems by making products that provide the Finishing Touch needed to look and feel Flawless™ every day.">
<meta name="twitter:image" content="https://idvftfbs.dtmstage.com/images/UPGRADE/social/share-banner.jpg">
<meta name="twitter:domain" content="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Index.dtm">




	<meta name="robots" content="noindex, nofollow">


<!-- // Favicon Metadata -->
<link rel="apple-touch-icon" sizes="180x180" href="https://idvftfbs.dtmstage.com/apple-touch-icon.png?fv=1">
<link rel="icon" type="image/png" sizes="32x32" href="https://idvftfbs.dtmstage.com/favicon-32x32.png?fv=1">
<link rel="icon" type="image/png" sizes="16x16" href="https://idvftfbs.dtmstage.com/favicon-16x16.png?fv=1">
<link rel="mask-icon" href="https://idvftfbs.dtmstage.com/safari-pinned-tab.svg?fv=1" color="#30b2e6">

<link rel="apple-touch-icon" sizes="180x180" href="https://idvftfbs.dtmstage.com/apple-touch-icon.png?fv=1">
<link rel="alternate icon" type="image/png" href="https://idvftfbs.dtmstage.com/android-chrome-192x192.png?fv=1">
<link rel="manifest" href="https://idvftfbs.dtmstage.com/site.webmanifest">


    <link rel="canonical" href="http://idvftfbs.dtmstage.com/UPGRADE/1.0000/index.dtm" />




<meta name="msapplication-TileColor" content="#FFFFFF">
<meta name="theme-color" content="#FFFFFF">

		

<style>
    .delay-render {
        opacity: 0;
        animation: none;
        transition: none;
    }
</style>
<noscript>
    <style>
        .delay-render {
            opacity: 1;
        }
    </style>
</noscript>

<link rel="preconnect" href="https://use.typekit.net/" crossorigin>
<link rel="dns-prefetch" href="https://use.typekit.net/">
<link rel="stylesheet" href="https://use.typekit.net/ctq6auo.css">

<link rel="preload" href="https://idvftfbs.dtmstage.com/css/UPGRADE/Site1/shell.css?cb=638343628120000000" as="style"><link rel="stylesheet" href="https://idvftfbs.dtmstage.com/css/UPGRADE/Site1/shell.css?cb=638343628120000000"><script defer src="https://idvftfbs.dtmstage.com/js/UPGRADE/Site1/app.es5.js?cb=638343628100000000"></script><script defer src="https://idvftfbs.dtmstage.com/js/UPGRADE/Site1/form.es5.js?cb=638343628100000000"></script>
        		
		
<link rel="preload" href="https://idvftfbs.dtmstage.com/css/UPGRADE/Site1/index.css?cb=638343628120000000" as="style"><link rel="stylesheet" href="https://idvftfbs.dtmstage.com/css/UPGRADE/Site1/index.css?cb=638343628120000000">

	</head>

	<body class="dtm__in">

		
		

<header class="view header">
    <span class="skip-link delay-render">
        <a href="index.dtm.html#main" class="skip-link__button" id="skip-link"><span>Skip To Main Content?</span></a>
    </span>
    

    <nav id="nav" aria-label="Website page links" class="section nav nav--is-start-page">
        <div class="section__in nav__in nav__group">
            
        <div class="nav__logo-tagline">
            
            <a 
                href="index.dtm.html#main" 
                id="navbar-logo" 
                class="nav__logo" 
                aria-label="Finishing Touch Flawless™">
                <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/logo.svg" alt="Finishing Touch Flawless™" width="300" height="81">
            </a>
        
        </div>
    

            
            <button type="button" class="nav__label" aria-label="Toggle Menu">
                <span></span>
            </button>
            <div class="nav__underlay"></div>
            <div class="nav__pane">
                <div class="nav__list">
                    
        <div class="nav__logo-tagline">
            
            <a 
                href="index.dtm.html#main" 
                id="navbar-header-logo" 
                class="nav__logo" 
                aria-label="Finishing Touch Flawless™">
                <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/logo.svg" alt="Finishing Touch Flawless™" width="300" height="81">
            </a>
        
        </div>
    

                    
                                    <div class="flyout flyout--full-width-container delay-input flyout--products-view delay-input--for-flyout" data-flyout-allow-hover>
                                        <button type="button" class="flyout__button nav__link" aria-controls="hairremoval-container">
                                            <span>Hair Removal</span>
                                        </button>
                                        <div id="hairremoval-container" class="flyout__container">
                                            <div class="flyout__content">
                                                <div class="product-card">
                                                    <div class="product-card__group">
                                                        <a href="https://idvftfbs.dtmstage.com/products/hair-removal/pblue?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/PBLUE/PBLUE.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/PBLUE/PBLUE.png" alt="" width="500" height="500" loading="lazy"></picture><span>Facial Hair Remover</span></a><a href="https://idvftfbs.dtmstage.com/products/hair-removal/browpb?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/BROWPB/BROWPB.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/BROWPB/BROWPB.png" alt="" width="500" height="500" loading="lazy"></picture><span>Brows</span></a><a href="https://idvftfbs.dtmstage.com/products/hair-removal/legs?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/LEGS/LEGS.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/LEGS/LEGS.png" alt="" width="500" height="500" loading="lazy"></picture><span>Legs</span></a><a href="https://idvftfbs.dtmstage.com/products/hair-removal/ua?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/UA/UA.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/UA/UA.png" alt="" width="500" height="500" loading="lazy"></picture><span>Underarm</span></a><a href="https://idvftfbs.dtmstage.com/products/hair-removal/shr?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/SHR/SHR.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/SHR/SHR.png" alt="" width="500" height="500" loading="lazy"></picture><span>Stray Hair Remover</span></a><a href="https://idvftfbs.dtmstage.com/products/hair-removal/bikini?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/BIKINI/BIKINI.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/BIKINI/BIKINI.png" alt="" width="500" height="500" loading="lazy"></picture><span>Bikini</span></a><a href="https://idvftfbs.dtmstage.com/products/hair-removal/nu?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/NU/NU.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/NU/NU.png" alt="" width="500" height="500" loading="lazy"></picture><span>Nu Razor&trade; Hair Remover </span></a><a href="https://idvftfbs.dtmstage.com/products/hair-removal/glo?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/GLO/GLO.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/GLO/GLO.png" alt="" width="500" height="500" loading="lazy"></picture><span>Dermaplane GLO</span></a>
                                                    </div>
                                                    <div class="product-card__button-group">
                                                        <a class="product-card__footer" href="https://idvftfbs.dtmstage.com/products/hair-removal?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">View All Hair Removal</a>
                                                        <a class="product-card__footer" href="https://idvftfbs.dtmstage.com/products?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">View All Products</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="flyout flyout--full-width-container delay-input flyout--products-view delay-input--for-flyout" data-flyout-allow-hover>
                                        <button type="button" class="flyout__button nav__link" aria-controls="naildevices-container">
                                            <span>Nail Devices</span>
                                        </button>
                                        <div id="naildevices-container" class="flyout__container">
                                            <div class="flyout__content">
                                                <div class="product-card">
                                                    <div class="product-card__group">
                                                        <a href="https://idvftfbs.dtmstage.com/products/nail-devices/nails?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/NAILS/NAILS.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/NAILS/NAILS.png" alt="" width="500" height="500" loading="lazy"></picture><span>Nail</span></a><a href="https://idvftfbs.dtmstage.com/products/nail-devices/pedi?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/PEDI/PEDI.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/PEDI/PEDI.png" alt="" width="500" height="500" loading="lazy"></picture><span>Pedi</span></a>
                                                    </div>
                                                    <div class="product-card__button-group">
                                                        <a class="product-card__footer" href="https://idvftfbs.dtmstage.com/products/nail-devices?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">View All Nail Devices</a>
                                                        <a class="product-card__footer" href="https://idvftfbs.dtmstage.com/products?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">View All Products</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="flyout flyout--full-width-container delay-input flyout--products-view delay-input--for-flyout" data-flyout-allow-hover>
                                        <button type="button" class="flyout__button nav__link" aria-controls="skindevices-container">
                                            <span>Skin Devices</span>
                                        </button>
                                        <div id="skindevices-container" class="flyout__container">
                                            <div class="flyout__content">
                                                <div class="product-card">
                                                    <div class="product-card__group">
                                                        <a href="https://idvftfbs.dtmstage.com/products/skin-devices/btu?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/BTU/BTU.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/BTU/BTU.png" alt="" width="500" height="500" loading="lazy"></picture><span>Body Touch Up</span></a><a href="https://idvftfbs.dtmstage.com/products/skin-devices/contour?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/CONTOUR/CONTOUR.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/CONTOUR/CONTOUR.png" alt="" width="500" height="500" loading="lazy"></picture><span>Contour</span></a><a href="https://idvftfbs.dtmstage.com/products/skin-devices/mitt?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/MITT/MITT.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/MITT/MITT.png" alt="" width="500" height="500" loading="lazy"></picture><span>Pure Clean</span></a><a href="https://idvftfbs.dtmstage.com/products/skin-devices/cleanse?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/CLEANSE/CLEANSE.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/CLEANSE/CLEANSE.png" alt="" width="500" height="500" loading="lazy"></picture><span>Cleanse</span></a><a href="https://idvftfbs.dtmstage.com/products/skin-devices/ice?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/ICE/ICE.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/ICE/ICE.png" alt="" width="500" height="500" loading="lazy"></picture><span>Ice Roller</span></a><a href="https://idvftfbs.dtmstage.com/products/skin-devices/spa?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7"><picture><source srcset="/images/UPGRADE/nav/products/SPA/SPA.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/SPA/SPA.png" alt="" width="500" height="500" loading="lazy"></picture><span>Cleanse Spa</span></a>
                                                    </div>
                                                    <div class="product-card__button-group">
                                                        <a class="product-card__footer" href="https://idvftfbs.dtmstage.com/products/skin-devices?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">View All Skin Devices</a>
                                                        <a class="product-card__footer" href="https://idvftfbs.dtmstage.com/products?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">View All Products</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                <div class="flyout flyout--full-width-container flyout--products-view delay-input delay-input--for-flyout" data-flyout-allow-hover>
                                    <button type="button" class="flyout__button nav__link" aria-controls="replacement-heads-container">
                                        <span>Replacement Heads</span>
                                    </button>
                                    <div id="replacement-heads-container" class="flyout__container">
                                        <div class="flyout__content">
                                            <div class="product-card">
                                                <div class="product-card__group">
                                                    
                                                            <a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Replacement.dtm#product-NUREPN">
                                                                <picture><source srcset="/images/UPGRADE/nav/products/NUREPN/NUREPN-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/NUREPN/NUREPN-0.png" alt="" width="500" height="500" loading="lazy"></picture>
                                                                <span>
                                                                    Nurazor
                                                                    
                                                                </span>
                                                            </a>
                                                            
                                                            <a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Replacement.dtm#product-PREPN">
                                                                <picture><source srcset="/images/UPGRADE/nav/products/PREPN/PREPN-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/PREPN/PREPN-0.png" alt="" width="500" height="500" loading="lazy"></picture>
                                                                <span>
                                                                    Pedi
                                                                    
                                                                </span>
                                                            </a>
                                                            
                                                            <a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Replacement.dtm#product-CSREPN">
                                                                <picture><source srcset="/images/UPGRADE/nav/products/CSREPN/CSREPN-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/CSREPN/CSREPN-0.png" alt="" width="500" height="500" loading="lazy"></picture>
                                                                <span>
                                                                    Cleanse Spa
                                                                    
                                                                </span>
                                                            </a>
                                                            
                                                            <a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Replacement.dtm#product-GLOREPN">
                                                                <picture><source srcset="/images/UPGRADE/nav/products/GLOREPN/GLOREPN-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/GLOREPN/GLOREPN-0.png" alt="" width="500" height="500" loading="lazy"></picture>
                                                                <span>
                                                                    Dermaplane GLO
                                                                    
                                                                </span>
                                                            </a>
                                                            
                                                            <a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Replacement.dtm#product-LEGREPN">
                                                                <picture><source srcset="/images/UPGRADE/nav/products/LEGREPN/LEGREPN-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/nav/products/LEGREPN/LEGREPN-0.png" alt="" width="500" height="500" loading="lazy"></picture>
                                                                <span>
                                                                    Legs
                                                                    
                                                                </span>
                                                            </a>
                                                            
                                                </div>
                                                
                                                <div class="product-card__button-group">
                                                    <a class="product-card__footer" href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Replacement.dtm">View All Replacement Heads</a>
                                                    <a class="product-card__footer" href="https://idvftfbs.dtmstage.com/Products?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">View All Products</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>                    
                                
                            <a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/HowTo.dtm" class="nav__link">
                                <span>Expert Tutorials</span>
                            </a>
                            
                </div>
            </div>
            <div class="nav__actions">
                <div class="text-button-icon">
                    <div class="text-button-icon__group">
                        <div id="search-form" class="flyout flyout--full-width-container delay-input delay-input--for-flyout">
                            <button type="button" class="flyout__button text-button-icon__button" aria-label="Toggle Search Form" aria-controls="search-form-container">
                                <svg class="icon text-button-icon__icon">
                                    <use href="#icon-search"></use>
                                </svg>
                            </button>
                            <div id="search-form-container" class="flyout__container">
                                <div class="flyout__content">
                                    <form action="https://idvftfbs.dtmstage.com/Search?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" data-processing-message="Searching" method="post" class="view search-form section">
                                        <input id="text" name="text" type="hidden" value="">
                                        <input id="versionNumber" name="versionNumber" type="hidden" value="1.0000">
                                        <div class="view__in search-form__in section__in">
                                            <div class="search-form__group message message--search">
                                                <div class="search-form__field message__select">
                                                    <div class="form form--field-button form--search">
                                                        <div class="form__contain form__field-button">
                                                            <input type="text" id="textS" name="textS" required data-required aria-label="Product Search" placeholder="Search..." title="Search for a product by name or by type" pattern="^[a-zA-Z0-9()-_ ]*$" class="form__field">
                                                            <button type="submit" class="button form__button">
                                                                <span>Search</span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="message__group" role="alert">
                                                    <span class="message__invalid">
                                                        Please enter a valid search term
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                                <a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Find-In-Store.dtm" aria-label="Find in Store" class="text-button-icon__button">
                                    <svg class="icon text-button-icon__icon">
                                        <use href="#icon-location"></use>
                                    </svg>
                                </a>
                                
                    </div>
                </div>
            </div>
            
        </div>
    </nav>
</header>

		



<main aria-labelledby="main-title" class="view content content--hero section">
    <div id="hero" class="view__anchor"></div>
    <div class="content__header">
        <div class="section__block">
            <h1 id="main-title" class="content__title content__title--first">Smart Innovation for Healthy Skin</h1>
        </div>
    </div>
    <div class="slide slide--hero-banner slide--vimeo-carousel" data-carousel-config='{ "delay" : 7000 }'>
        <div class="slide__into" tabindex="0" id="home-page-carousel">

            
            <div id="feature-banner-1" class="slide__item">
                <div class="hero-banner hero-banner--callout-product">
                    <div class="view__in hero-banner__in section__in">
                        <div class="hero-banner__group">
                            <div class="hero-banner__callout">
                                <h2 class="hero-banner__title">
                                    <span>Always be</span>
                                    <div class="hero-banner__logo">
                                        <svg class="icon icon--logo">
                                            <use href="#logo"></use>
                                        </svg>
                                    </div>
                                </h2>
                                <a href="https://idvftfbs.dtmstage.com/products/hair-removal?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="button">
                                    <span>View the Collection</span>
                                </a>
                            </div>
                            <picture class="hero-banner__product">
                                <source srcset="/images/UPGRADE/hero-banners/products-arrangement.webp" type="image/webp">
                                <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/hero-banners/products-arrangement.png" alt="Arrangment of Flawless products" width="798" height="450">
                            </picture>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        
    </div>
</main>

<section aria-labelledby="emmas-picks-title" class="view content content--emmas-picks section">
    <div id="emmas-picks" class="view__anchor"></div>
    <div class="view__in section__in content__in">
        <div class="content__group">
            <div class="content__text">
                <div class="content__header logo-title-hero logo-title-hero--for-emma">
                    <h2 class="logo-title-hero__group" id="emmas-picks-title">
                        <picture class="logo-title-hero__logo">
                            <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/logo.svg" loading="lazy" alt="Finishing Touch Flawless&trade;" width="300" height="81">
                        </picture>
                        <span class="logo-title-hero__title">Favorites</span>
                    </h2>
                </div>
                <div class="content__products">
                    <div class="product-grid product-grid--top-selling">
                        <div class="product-grid__group">
                         

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/hair-removal/pblue">
    <a href="https://idvftfbs.dtmstage.com/products/hair-removal/pblue?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/pages/index/PBLUE/PBLUE-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/pages/index/PBLUE/PBLUE-0.jpg" alt="" width="500" height="500" loading="lazy"></picture>
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Facial Hair Remover</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/hair-removal/pblue#reviews" data-bv-product-id="finishing-touch-flawless-facial"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-FACEBLUSHN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="FACEBLUSHN-PLP">
    
          <a href="https://www.amazon.com/dp/B0CCT1F19X?maas=maas_adg_30EC6A99BB9F62A65E574348DF1BEFFD_afap_abs&ref_=aa_maas&tag=maas" class="button" id="FACEBLUSHN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>
 

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/hair-removal/browpb">
    <a href="https://idvftfbs.dtmstage.com/products/hair-removal/browpb?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/pages/index/BROWPB/BROWPB-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/pages/index/BROWPB/BROWPB-0.jpg" alt="" width="500" height="500" loading="lazy"></picture>
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Brows</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/hair-removal/browpb#reviews" data-bv-product-id="finishing-touch-flawless-brows"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-BROWPBN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="BROWPBN-PLP">
    
          <a href="https://www.amazon.com/gp/product/B07MP15NQW/ref=ox_sc_act_title_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="BROWPBN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>

                        </div>
                    </div>
                </div>
            </div>
            <figure class="content__image">
                <picture>
                    <source srcset="/images/UPGRADE/content/bkg-girl.webp" type="image/webp">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/content/bkg-girl.png" loading="lazy" alt="A Girl holding Flawless Brows" width="512" height="663">
                </picture>
            </figure>
        </div>
    </div>
</section>

<section aria-label="Product description, ingredients, directions" class="view section">
    <div class="view__anchor" id="new"></div>
    <div class="view__in section__in">
        <div class="section__block">
            
            <div id="accordion" class="accordion accordion--tabs">
                <div class="accordion__group">
                    
                    <h2 class="accordion__header">
                        <button type="button" class="accordion__button" aria-expanded="true" aria-controls="new-products-section" id="new-products-title">New</button>
                    </h2>
                    
                    <h2 class="accordion__header">
                        <button type="button" class="accordion__button" aria-controls="best-sellers-section" id="best-sellers-title">Best Sellers</button>
                    </h2>                    
                    

                    <h2 class="accordion__header">
                        <a href="https://idvftfbs.dtmstage.com/products?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="accordion__link">See All</a>
                    </h2>
                </div>
                
                <section aria-labelledby="best-sellers-title" hidden id="best-sellers-section" class="accordion__section">
                    <div class="accordion__content">
                        <div class="product-grid product-grid--listing">
                            <div class="product-grid__group">
                             

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/hair-removal/pblue">
    <a href="https://idvftfbs.dtmstage.com/products/hair-removal/pblue?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/PBLUE/PBLUE-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/PBLUE/PBLUE-0.jpg" alt="" width="500" height="500" loading="lazy"></picture>
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Facial Hair Remover</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/hair-removal/pblue#reviews" data-bv-product-id="finishing-touch-flawless-facial"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-FACEBLUSHN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="FACEBLUSHN-PLP">
    
          <a href="https://www.amazon.com/dp/B0CCT1F19X?maas=maas_adg_30EC6A99BB9F62A65E574348DF1BEFFD_afap_abs&ref_=aa_maas&tag=maas" class="button" id="FACEBLUSHN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>
 

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/hair-removal/browpb">
    <a href="https://idvftfbs.dtmstage.com/products/hair-removal/browpb?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/BROWPB/BROWPB-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/BROWPB/BROWPB-0.jpg" alt="" width="500" height="500" loading="lazy"></picture>
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Brows</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/hair-removal/browpb#reviews" data-bv-product-id="finishing-touch-flawless-brows"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-BROWPBN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="BROWPBN-PLP">
    
          <a href="https://www.amazon.com/gp/product/B07MP15NQW/ref=ox_sc_act_title_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="BROWPBN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>
 

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/nail-devices/pedi">
    <a href="https://idvftfbs.dtmstage.com/products/nail-devices/pedi?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/PEDI/PEDI-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/PEDI/PEDI-0.jpg" alt="" width="500" height="500" loading="lazy"></picture>
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Pedi</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/nail-devices/pedi#reviews" data-bv-product-id="finishing-touch-flawless-pedi"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-PEDIN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="PEDIN-PLP">
    
          <a href="https://www.amazon.com/gp/product/B08NX1QJ3Q/ref=sw_img_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="PEDIN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>
 

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/nail-devices/nails">
    <a href="https://idvftfbs.dtmstage.com/products/nail-devices/nails?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/NAILS/NAILS-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/NAILS/NAILS-0.jpg" alt="" width="500" height="500" loading="lazy"></picture>
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Nail</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/nail-devices/nails#reviews" data-bv-product-id="finishing-touch-flawless-salon-nails"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-NAILSN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="NAILSN-PLP">
    
          <a href="https://www.amazon.com/gp/product/B08GQZ7T24/ref=sw_img_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="NAILSN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>

                            </div>
                        </div>   
                    </div>
                </section>                
                
                <section id="new-products-section" aria-labelledby="new-products-title" class="accordion__section">
                    <div class="accordion__content">
                        <div class="product-grid product-grid--listing slide slide--category-products">
                            <div id="new-product-category-carousel" class="slide__into">
                                
                                        <div class="slide__item">
                                             

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/hair-removal/bikini">
    <a href="https://idvftfbs.dtmstage.com/products/hair-removal/bikini?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/BIKINI/BIKINI-0-NEW.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/BIKINI/BIKINI-0-NEW.jpg" alt="" width="500" height="500" loading="lazy"></picture>
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Bikini</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/hair-removal/bikini#reviews" data-bv-product-id="20508450"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-BIKININ-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="BIKININ-PLP">
    
          <a href="https://www.amazon.com/gp/product/B09QDRJ8ZX/ref=ewc_pr_img_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="BIKININ_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>

                                        </div>
                                        
                                        <div class="slide__item">
                                             

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/skin-devices/mitt">
    <a href="https://idvftfbs.dtmstage.com/products/skin-devices/mitt?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/MITT/MITT-0-NEW.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/MITT/MITT-0-NEW.jpg" alt="" width="500" height="500" loading="lazy"></picture>
                    <span class="product__new"><b>New</b></span>
                    
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Pure Clean</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/skin-devices/mitt#reviews" data-bv-product-id="20508666"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-MITTN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="MITTN-PLP">
    
          <a href="https://www.amazon.com/gp/product/B0B2SFT3M8/ref=ewc_pr_img_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="MITTN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>

                                        </div>
                                        
                                        <div class="slide__item">
                                             

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/hair-removal/ua">
    <a href="https://idvftfbs.dtmstage.com/products/hair-removal/ua?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/UA/UA-0-NEW.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/UA/UA-0-NEW.jpg" alt="" width="500" height="500" loading="lazy"></picture>
                    <span class="product__new"><b>New</b></span>
                    
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Underarm</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/hair-removal/ua#reviews" data-bv-product-id="20508886"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-UAN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="UAN-PLP">
    
          <a href="https://www.amazon.com/gp/product/B0B2SH3YSX/ref=ewc_pr_img_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="UAN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>

                                        </div>
                                        
                                        <div class="slide__item">
                                             

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/hair-removal/shr">
    <a href="https://idvftfbs.dtmstage.com/products/hair-removal/shr?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/SHR/SHR-1-NEW.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/SHR/SHR-1-NEW.jpg" alt="" width="500" height="500" loading="lazy"></picture>
                    <span class="product__new"><b>New</b></span>
                    
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Stray Hair Remover</div>

    <hr />

    
        <div class="contain contain--bazaarvoice-inline-rating">
            <div data-variant-product-type="bazaarvoice-inline-rating" class="contain contain--bazaarvoice-inline-rating">
                <div data-bv-show="inline_rating" data-bv-redirect-url="https://idvftfbs.dtmstage.com/products/hair-removal/shr#reviews" data-bv-product-id="20508888"></div>
            </div>
        </div>
    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-SHRN-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="SHRN-PLP">
    
          <a href="https://www.amazon.com/gp/product/B0BBP7KWCX/ref=sw_img_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="SHRN_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>

                                        </div>
                                        
                                        <div class="slide__item">
                                             

<div class="category-product category-product--listing element-controller" data-variant-product-permalink="/products/skin-devices/btu">
    <a href="https://idvftfbs.dtmstage.com/products/skin-devices/btu?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7" class="category-product__picture product" data-variant-product-group="image" data-variant-product-router>
        <span class="contain contain--square product__image product__image-container" data-variant-product-type="image">
			<picture><source srcset="/images/UPGRADE/products/BTU/BTU-0.webp" type="image/webp"><img src="https://idvftfbs.dtmstage.com/images/UPGRADE/products/BTU/BTU-0.jpg" alt="" width="500" height="500" loading="lazy"></picture>
                    <span class="product__new"><b>New</b></span>
                    
        </span>
    </a>
    <div class="category-product__title" data-variant-product-type="name">Body Touch Up</div>

    <hr />

    
    
    <div class="product-price-info">
        <b class="product-price-info__callout" data-variant-product-type="product-price-info"></b>
    </div>

    <div class="category-product__cart">
        

<div 
        id="element-controller-BTU-PLP" 
        class="form form--icon-field-combobox form--label-combobox element-controller__element" data-element-controller-name="BTU-PLP">
    
          <a href="https://www.amazon.com/gp/product/B0C2JSVTH8/ref=sw_img_1?smid=ATVPDKIKX0DER&psc=1" class="button" id="BTU_Redirect" target="_blank">Buy On Amazon</a>
        
</div>
    </div>
</div>

                                        </div>
                                        
                            </div>
                            <div class="slide__nav">
                                <button aria-label="Previous" class="slide__prev" type="button">
                                    <svg class="icon">
                                        <use href="#icon-chevron"></use>
                                    </svg>
                                </button>
                                <button aria-label="Next" class="slide__next" type="button">
                                    <svg class="icon">
                                        <use href="#icon-chevron"></use>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
            </div>
        </div>
    </div>
</section>

<section aria-label="Finishing Touch Flawless has been featured in these publications" class="view content content--featured section">
    <div id="featured-publications" class="view__anchor"></div>
    <div class="view__in section__in">
        <a href="https://idvftfbs.dtmstage.com/Articles?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">
            <div class="logo-title-hero section__block">
                <h2 id="featured-title" class="logo-title-hero__group">
                    <img class="logo-title-hero__logo" src="https://idvftfbs.dtmstage.com/images/UPGRADE/logo.svg" loading="lazy" alt="Finishing Touch Flawless&trade;" width="300" height="81">
                    <span class="logo-title-hero__title">In the Press</span>
                </h2>
            </div>
            <div class="content__group">
                <picture class="content__bazaar">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/brands/bazaar.svg" alt="BAZAAR" loading="lazy" width="125" height="41">
                </picture>
                <picture class="content__elle">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/brands/elle.svg" alt="ELLE" loading="lazy" width="112" height="41">
                </picture>
                <picture class="marie-claire">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/brands/marie-claire.svg" alt="marie-claire" loading="lazy" width="175" height="41">
                </picture>
                <picture class="content__allure">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/brands/allure.svg" alt="allure" loading="lazy" width="114" height="41">
                </picture>
                <picture class="content__cosmopolitan">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/brands/cosmopolitan.svg" alt="COSMOPOLITAN" loading="lazy" width="176" height="41">
                </picture>
                <picture class="content__byrdie">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/brands/byrdie.svg" alt="BYRDIE" width="216" loading="lazy" height="41">
                </picture>
            </div>
        </a>
    </div>
</section>


<section aria-labelledby="seen-on-tiktok-title" class="view content content--tiktok section">
  <div id="seen-on-tiktok" class="view__anchor"></div>
  <div class="view__in section__in">
    <div class="section__block">
      <h2 id="seen-on-tiktok-title" class="content__title">As seen on <b>TikTok</b></h2>
    </div>
    <div class="section__block">
      <div class="slide slide--tiktok-videos">
        <div class="slide__into" tabindex="0" id="tiktokSlider">
          <div class="slide__item">
            <blockquote class="tiktok-embed" cite="https://www.tiktok.com/@flawlessbeauty/video/7224151323048971562" data-video-id="7224151323048971562" style="max-width: 605px;min-width: 325px;" >
              <section> <a target="_blank" title="@flawlessbeauty" href="https://www.tiktok.com/@flawlessbeauty?refer=embed">@flawlessbeauty</a> Mommas, say goodbye to the lady-stache and hello to ?FLAWLESS? Shop now on @amazon <a title="flawlessskin" target="_blank" href="https://www.tiktok.com/tag/flawlessskin?refer=embed">#flawlessskin</a> <a title="glassskin" target="_blank" href="https://www.tiktok.com/tag/glassskin?refer=embed">#glassskin</a> <a title="finishingtouchflawless" target="_blank" href="https://www.tiktok.com/tag/finishingtouchflawless?refer=embed">#finishingtouchflawless</a> <a title="mothersday" target="_blank" href="https://www.tiktok.com/tag/mothersday?refer=embed">#mothersday</a> <a target="_blank" title="? Sunshine - WIRA" href="https://www.tiktok.com/music/Sunshine-7087902657213384705?refer=embed">? Sunshine - WIRA</a> </section>
            </blockquote>
            <script async src="https://www.tiktok.com/embed.js"></script> 
          </div>
          <div class="slide__item">
            <blockquote class="tiktok-embed" cite="https://www.tiktok.com/@flawlessbeauty/video/7214121227202448686" data-video-id="7214121227202448686" style="max-width: 605px;min-width: 325px;" >
              <section> <a target="_blank" title="@flawlessbeauty" href="https://www.tiktok.com/@flawlessbeauty?refer=embed">@flawlessbeauty</a> Skip the painfull waxing and switch to the Flawless Brows device for pain free hair removal! Shop now at @target ? ?@malibumama__ <a title="flawlesspartner" target="_blank" href="https://www.tiktok.com/tag/flawlesspartner?refer=embed">#FlawlessPartner</a> <a target="_blank" title="? original sound  - flawlessbeauty" href="https://www.tiktok.com/music/original-sound-flawlessbeauty-7214122076444756782?refer=embed">? original sound  - flawlessbeauty</a> </section>
            </blockquote>
            <script async src="https://www.tiktok.com/embed.js"></script> 
          </div>
          <div class="slide__item">
            
                <blockquote class="tiktok-embed" cite="https://www.tiktok.com/@flawlessbeauty/video/7213379248332016938" data-video-id="7213379248332016938" style="max-width: 605px;min-width: 325px;" > <section> <a target="_blank" title="@flawlessbeauty" href="https://www.tiktok.com/@flawlessbeauty?refer=embed">@flawlessbeauty</a> The new Body Touch Up device is an absolute game changer! 🙌🏼 You wont want to leave the house without it! <a title="bodytouchup" target="_blank" href="https://www.tiktok.com/tag/bodytouchup?refer=embed">#BodyTouchUp</a> at @ultabeauty <a target="_blank" title="♬ original sound  - flawlessbeauty" href="https://www.tiktok.com/music/original-sound-flawlessbeauty-7214868548202646318?refer=embed">♬ original sound  - flawlessbeauty</a> </section> </blockquote> <script async src="https://www.tiktok.com/embed.js"></script>
            
          </div>
          <div class="slide__item">
            <blockquote class="tiktok-embed" cite="https://www.tiktok.com/@flawlessbeauty/video/7240109619962580270" data-video-id="7240109619962580270" style="max-width: 605px;min-width: 325px;" >
              <section> <a target="_blank" title="@flawlessbeauty" href="https://www.tiktok.com/@flawlessbeauty?refer=embed">@flawlessbeauty</a> ?@Caro Viee is taking a break from acrylics ? Save ? when you do your nails at home with the Flawless Salon Nails device. Find it today at @Ulta Beauty <a title="flawlesspartner" target="_blank" href="https://www.tiktok.com/tag/flawlesspartner?refer=embed">#flawlesspartner</a> <a title="athomenails" target="_blank" href="https://www.tiktok.com/tag/athomenails?refer=embed">#athomenails</a> <a title="athomemanicure" target="_blank" href="https://www.tiktok.com/tag/athomemanicure?refer=embed">#athomemanicure</a> <a title="nailtok" target="_blank" href="https://www.tiktok.com/tag/nailtok?refer=embed">#nailtok</a> <a target="_blank" title="? original sound - flawlessbeauty" href="https://www.tiktok.com/music/original-sound-7240109662383770414?refer=embed">? original sound - flawlessbeauty</a> </section>
            </blockquote>
            <script async src="https://www.tiktok.com/embed.js"></script> 
          </div>
        </div>
        <div class="slide__nav">
          <button aria-label="Previous" class="slide__prev" type="button">
          <svg class="icon">
            <use href="#icon-chevron"></use>
          </svg>
          </button>
          <button aria-label="Next" class="slide__next" type="button">
          <svg class="icon">
            <use href="#icon-chevron"></use>
          </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</section>




		

<section aria-label="View our feed and follow us on Instagram" class="view content content--instagram">
    <div id="instagram-feed" class="view__anchor"></div>
    <div class="section__block">
        <h2 class="content__title">Connect. Follow. Discover.</h2>
    </div>

    
    <div class="section__block">
        <div class="content__group">
            
                    <a href="https://www.instagram.com/flawlessbeauty/" aria-label="Instagram" class="social-media-favicon-link" href="index.dtm.html" target="_blank">
                        <span class="social-media-favicon-link__favicon">
                            <svg class="icon icon--favicon-circle">
                                <use href="#icon-favicon-circle"></use>
                            </svg>
                            <svg class="icon icon--social">
                                <use href="#icon-instagram"></use>
                            </svg>
                        </span>
                        
                                <span class="social-media-favicon-link__link">@flawlessbeauty</span>
                                
                    </a>
                    
                    <a href="https://www.facebook.com/FlawlessBeauty/" aria-label="Facebook" class="social-media-favicon-link" href="index.dtm.html" target="_blank">
                        <span class="social-media-favicon-link__favicon">
                            <svg class="icon icon--favicon-circle">
                                <use href="#icon-favicon-circle"></use>
                            </svg>
                            <svg class="icon icon--social">
                                <use href="#icon-facebook"></use>
                            </svg>
                        </span>
                        
                                <span class="social-media-favicon-link__link">@Flawlessbeauty</span>
                                
                    </a>
                    
                    <a href="https://www.youtube.com/c/FlawlessBeauty" aria-label="YouTube" class="social-media-favicon-link" href="index.dtm.html" target="_blank">
                        <span class="social-media-favicon-link__favicon">
                            <svg class="icon icon--favicon-circle">
                                <use href="#icon-favicon-circle"></use>
                            </svg>
                            <svg class="icon icon--social">
                                <use href="#icon-youtube"></use>
                            </svg>
                        </span>
                        
                                <span class="social-media-favicon-link__link">Flawlessbeauty</span>
                                
                    </a>
                    
                    <a href="https://www.tiktok.com/@flawlessbeauty" aria-label="TikTok" class="social-media-favicon-link" href="index.dtm.html" target="_blank">
                        <span class="social-media-favicon-link__favicon">
                            <svg class="icon icon--favicon-circle">
                                <use href="#icon-favicon-circle"></use>
                            </svg>
                            <svg class="icon icon--social">
                                <use href="#icon-tiktok"></use>
                            </svg>
                        </span>
                        
                                <span class="social-media-favicon-link__link">@flawlessbeauty</span>
                                
                    </a>
                    
        </div>
    </div>
    <div class="instafeed">
        <div class="slide slide--instagram-content">
            <div class="slide__into" tabindex="0" id="instagramSlider">
                <div class="slide__item">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/instagram/1.jpg" loading="lazy" alt="Emma Roberts getting ready">
                </div>
                <div class="slide__item">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/instagram/2.jpg" loading="lazy" alt="Flawless products with gold-plated design">
                </div>
                <div class="slide__item">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/instagram/3.jpg" loading="lazy" alt="Smooth face">
                </div>
                <div class="slide__item">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/instagram/4.jpg" loading="lazy" alt="Beauty fridge with beauty products">
                </div>
                <div class="slide__item">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/instagram/5.jpg" loading="lazy" alt="Flawless Pedi">
                </div>
                <div class="slide__item">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/instagram/6.jpg" loading="lazy" alt="Flawless products">
                </div>
                <div class="slide__item">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/instagram/7.jpg" loading="lazy" alt="Emma Roberts">
                </div>
                <div class="slide__item">
                    <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/instagram/8.jpg" loading="lazy" alt="Beauty fridge">
                </div>
              </div>
              <div class="slide__nav">
                  <button aria-label="Previous" class="slide__prev" type="button">
                    <svg class="icon">
                          <use href="#icon-chevron"></use>
                    </svg>
                  </button>
                  <button aria-label="Next" class="slide__next" type="button">
                      <svg class="icon">
                          <use href="#icon-chevron"></use>
                      </svg>
                  </button>
              </div>
        </div>
    </div>
</section>

		



<script>
    function submitEmailLead() {
        var emailAddress = typeof $('#emailSubscribe') != "undefined" && $('#emailSubscribe').length > 0 ? $('#emailSubscribe').val() : null;
        var url = '/Cart/Subscribe/Index?email=' + emailAddress;

        if (validateEmail(emailAddress)) {
            $('#emailSubscribeButton').prop('disabled', true);

            $.get(url, function (data) {
                $('#emailSubscribe').val('');
                window.cartToast.post("Successfully subscribed!");
                $("[data-validate-form-message]").html("For 10% off your order, checkout using <b>WELCOME10</b>");
                setTimeout(function () { window.cartToast.hide(); }, 3000);
                document.cookie = "lead=1; path=/";
            }).fail(function () {
                window.cartToast.post("Unable to process request at this time. Please try again.");
            }).always(function () {
                window.cartToast.show();
                setTimeout(function () { window.cartToast.hide(); }, 3000);
                $('#emailSubscribeButton').prop('disabled', false);
            });
        }
        else {
            window.cartToast.post("Email is invalid. Please try again.");
            window.cartToast.show();
            setTimeout(function () { window.cartToast.hide(); }, 3000);
        }
    }

    function validateEmail(email) {
        const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }
</script>


		

<footer aria-label="Social media, shop, help and special offers" class="view footer footer--container footer--wave  section @print-only-hide">
    <div id="footer" class="view__anchor"></div>
    <div class="view__in footer__in section__in">
        <div class="footer__group">
            <div class="footer footer--logo-social">
                <div class="footer__group">
                    <a href="index.dtm.html#main" aria-label="Finishing Touch Flawless™" class="footer__logo">
                        <svg class="icon icon--logo">
                            <use href="#logo"></use>
                        </svg>
                    </a>
                    
                            <p class="footer__text">Follow us for Tips/Tricks & giveaways</p>
                            
                                <a href="https://www.instagram.com/flawlessbeauty/" class="footer__icon" aria-label="Instagram" target="_blank">
                                    <svg class="icon icon--social">
                                        <use href="#icon-instagram"></use>
                                    </svg>
                                </a>
                                
                                <a href="https://www.facebook.com/FlawlessBeauty/" class="footer__icon" aria-label="Facebook" target="_blank">
                                    <svg class="icon icon--social">
                                        <use href="#icon-facebook"></use>
                                    </svg>
                                </a>
                                
                                <a href="https://www.youtube.com/c/FlawlessBeauty" class="footer__icon" aria-label="YouTube" target="_blank">
                                    <svg class="icon icon--social">
                                        <use href="#icon-youtube"></use>
                                    </svg>
                                </a>
                                
                                <a href="https://www.tiktok.com/@flawlessbeauty" class="footer__icon" aria-label="TikTok" target="_blank">
                                    <svg class="icon icon--social">
                                        <use href="#icon-tiktok"></use>
                                    </svg>
                                </a>
                                
                </div>
            </div>
            
            <div class="footer footer--sitemap">
                <div class="footer__group">
                    <nav class="footer__list" aria-labelledby="footer-shop-title">
                        <h2 class="footer__title" id="footer-shop-title">Shop</h2>
                        <a href="https://idvftfbs.dtmstage.com/products/hair-removal?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">Hair Removal</a><a href="https://idvftfbs.dtmstage.com/products/skin-devices?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">Skin Devices</a><a href="https://idvftfbs.dtmstage.com/products/nail-devices?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">Nail Devices</a><a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Replacement.dtm">Replacement Heads</a><a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/HowTo.dtm">Expert Tutorials</a>
                    </nav>
                    <nav class="footer__list" aria-labelledby="footer-help-title">
                        <h2 class="footer__title" id="footer-help-title">Help &amp; More</h2>
                        <a class="link" href="https://customerstatus.com/SearchUpdate.aspx" target="_blank">Track Your Order<span class="link__advisal"> <span class="link__container">Opens in a new window</span></span></a><a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Customer-Service.dtm">Contact Us</a><a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Shipping-Returns.dtm">Returns</a><a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Shipping-Returns.dtm">Guarantee</a><a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/International-Shop.dtm">International Shopping</a><a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/Find-In-Store.dtm">Find in Store</a><a href="https://idvftfbs.dtmstage.com/UPGRADE/1.0000/About.dtm">Our Purpose</a><a href="https://idvftfbs.dtmstage.com/Articles?cver=b6a095f0-0809-ed11-8b97-a0369f1303c7">Press</a>
                    </nav>
                </div>
            </div>
            <div class="footer__item">
                

<div class="footer footer--form">
    <div class="klaviyo-form-T9QMVM klaviyo-form-T9QMVM--contains-overrides"></div>
</div>
                <img src="https://idvftfbs.dtmstage.com/images/UPGRADE/mbg.svg" width="206" height="206" alt="60 Day Money Back Guarantee" class="footer__mbg">
            </div>
            
        </div>

        <div class="footer__legal">
            
            <p>&copy; Church & Dwight Co., Inc. 2022. | All rights reserved | 
                <a class="link" href="https://churchdwight.com/terms-conditions.aspx" target="_blank">Terms Of Service<span class="link__advisal"> <span class="link__container">Opens in a new window</span></span></a><a class="link" href="https://churchdwight.com/privacy-policy.aspx" target="_blank">Privacy Notice<span class="link__advisal"> <span class="link__container">Opens in a new window</span></span></a> | <span class="onetrust-privacy"></span>
            </p>
            <p>U.S. and International Patent(s) Pending | Web by: <a href="https://www.digitaltargetmarketing.com/" target="_blank" title="View the agency behind this site, opens in a new tab">Digital Target Marketing</a></p>
            
        </div>

        
    </div>  
</footer>

<span hidden>
    <svg>
        <symbol id="logo" x="0px" y="0px" viewBox="0 0 911.1 177.3" style="enable-background:new 0 0 911.1 177.3;">
            <style type="text/css">
                #logo .st0{fill:currentColor;}
                #logo .st1{fill:none;}
            </style>
            <polygon class="st0" points="2.1,0.5 29.1,0.5 29.1,7.3 9.9,7.3 9.9,14.5 26.8,14.5 26.8,21.4 9.9,21.4 9.9,34.6 2.1,34.6 "/>
            <rect x="38.4" y="0.5" class="st0" width="7.8" height="34.1"/>
            <polygon class="st0" points="57.8,0.5 65,0.5 81.7,21.5 81.7,0.5 89.4,0.5 89.4,34.6 82.7,34.6 65.5,12.9 65.5,34.6 57.8,34.6 "/>
            <rect x="101" y="0.5" class="st0" width="7.8" height="34.1"/>
            <path class="st0" d="M119.4,10.2L119.4,10.2c0,6.9,4.6,8.8,11.8,10.5c5.9,1.5,7.1,2.4,7.1,4.3v0.1c0,2-1.9,3.2-5.1,3.2
                c-4.1,0-7.4-1.6-10.6-4.1l-4.6,5.3c4.3,3.7,9.7,5.5,15.1,5.5c7.7,0,13-3.8,13-10.6v-0.1c0-5.9-4.1-8.4-11.2-10.2
                c-6.1-1.5-7.7-2.2-7.7-4.5v0c0-1.7,1.6-3,4.6-3s6.1,1.3,9.2,3.4l4.1-5.7c-3.6-2.8-8-4.3-13.2-4.3C124.5,0,119.4,4.1,119.4,10.2"/>
            <polygon class="st0" points="177.8,0.5 177.8,14 163.4,14 163.4,0.5 155.6,0.5 155.6,34.6 163.4,34.6 163.4,20.9 177.8,20.9 
                177.8,34.6 185.6,34.6 185.6,0.5 "/>
            <rect x="197.2" y="0.5" class="st0" width="7.8" height="34.1"/>
            <polygon class="st0" points="240.4,0.5 240.4,21.5 223.8,0.5 216.6,0.5 216.6,34.6 224.3,34.6 224.3,12.9 241.5,34.6 248.1,34.6 
                248.1,0.5 "/>
            <path class="st0" d="M257.8,17.5L257.8,17.5c0,10.2,7.6,17.6,18.6,17.6c6.5,0,11.5-2.4,15.2-5.4V14.9h-15.4v6.5h7.9v4.9
                c-2,1.4-4.5,2-7.3,2c-6.3,0-10.7-4.6-10.7-10.8v-0.1c0-5.8,4.5-10.6,10.2-10.6c4.1,0,6.5,1.3,9.3,3.5l4.9-5.7
                c-3.7-3-7.6-4.7-13.9-4.7C265.6-0.1,257.8,7.8,257.8,17.5"/>
            <polygon class="st0" points="317.2,0.5 317.2,7.4 328,7.4 328,34.6 335.8,34.6 335.8,7.4 346.6,7.4 346.6,0.5 "/>
            <path class="st0" d="M360.4,17.5L360.4,17.5c0-5.9,4.4-10.7,10.6-10.7c6.3,0,10.7,4.9,10.7,10.7v0.1c0,5.8-4.4,10.6-10.6,10.6
                S360.4,23.4,360.4,17.5 M352.3,17.5L352.3,17.5c0,9.8,7.9,17.6,18.8,17.6c10.9,0,18.9-7.9,18.9-17.6v-0.1c0-9.7-7.9-17.5-18.8-17.5
                C360.3-0.1,352.3,7.8,352.3,17.5"/>
            <path class="st0" d="M422.2,0.5V20c0,5.4-2.9,8.2-7.7,8.2s-7.7-2.9-7.7-8.4V0.5H399V20c0,10,5.8,15.2,15.4,15.2S430,30.1,430,19.8
                V0.5H422.2z"/>
            <g>
                <g>
                    <path id="SVGID_1_" class="st0" d="M439.1,17.5L439.1,17.5c0,9.9,7.8,17.6,18.2,17.6c6.8,0,10.9-2.3,14.5-6.1l-5-4.8
                        c-2.8,2.4-5.3,4-9.3,4c-6.1,0-10.3-4.9-10.3-10.7v-0.1c0-5.8,4.3-10.6,10.3-10.6c3.5,0,6.3,1.5,9.1,3.9l5-5.5
                        c-3.3-3.1-7.3-5.3-14-5.3C446.7-0.1,439.1,7.8,439.1,17.5"/>
                </g>
            </g>
            <polygon class="st0" points="503,0.5 503,14 488.6,14 488.6,0.5 480.8,0.5 480.8,34.6 488.6,34.6 488.6,20.9 503,20.9 503,34.6 
                510.8,34.6 510.8,0.5 "/>
            <polygon class="st0" points="0,176 0,60 77.9,60 77.9,79.7 22.5,79.7 22.5,109.6 68.6,109.6 68.6,128 22.5,128 22.5,176 "/>
            <polygon class="st0" points="179.3,176 179.3,156.2 120.2,156.2 120.2,60 97.6,60 97.6,176 "/>
            <path class="st0" d="M256.8,60h-18.3l-45.8,116h23.9l10.6-28.9h40.7l10.6,28.9h23.9L256.8,60z M230.9,131.2l16.7-46.9l16.2,46.9
                H230.9z"/>
            <polygon class="st0" points="369.7,113.1 355.3,150.2 322.3,60 297.9,60 345,176 364,176 384.1,127.3 404.2,176 423.1,176 470.4,60 
                445.8,60 413,150.2 398.3,113.1 418.1,60.3 397.1,60.3 384.1,98.7 371,60.3 350.2,60.3 "/>
            <polygon class="st0" points="570,176 570,156.2 510.8,156.2 510.8,60 488.3,60 488.3,176 "/>
            <polygon class="st0" points="611.4,156.2 611.4,126 660.3,126 660.3,107.7 611.4,107.7 611.4,79.7 668,79.7 668,60 588.9,60 
                588.9,176 669.4,176 669.4,156.2 "/>
            <path class="st0" d="M773.7,72.1c-10.1-6.9-24.4-12.9-40.5-12.9c-23.5,0-42.3,12.7-42.3,36.4c0,17.8,10.8,25.3,32.9,31.4
                c18.1,4.9,30.1,7.8,30.1,18.1c0,7.7-6.4,11.9-18.6,11.9c-17.7,0-35.1-10.3-39.1-14.2l-10,19.4c13.4,9.5,31.4,15,48.7,15
                c22.9,0,43-9.5,43-34.5c0-21.3-14.4-28.4-37.3-34.3c-17.5-4.6-26.5-7-26.5-16.5c0-8.3,6.2-13.1,18.5-13.1c13.9,0,28.3,8.2,31.2,11.4
                L773.7,72.1z"/>
            <path class="st0" d="M880.5,72.1c-10.1-6.9-24.4-12.9-40.5-12.9c-23.5,0-42.3,12.7-42.3,36.4c0,17.8,10.8,25.3,32.9,31.4
                c18.1,4.9,30.1,7.8,30.1,18.1c0,7.7-6.4,11.9-18.6,11.9c-17.7,0-35.1-10.3-39.1-14.2l-10,19.4c13.4,9.5,31.4,15,48.7,15
                c22.9,0,43-9.5,43-34.5c0-21.3-14.4-28.4-37.3-34.3c-17.5-4.6-26.5-7-26.5-16.5c0-8.3,6.2-13.1,18.5-13.1c13.9,0,28.3,8.2,31.2,11.4
                L880.5,72.1z"/>
            <path class="st0" d="M895.5,74.9h-3.8v8.8h-2.9v-8.8H885V72h10.4L895.5,74.9L895.5,74.9z M906.9,72.1h4.2v11.7h-2.9v-7.9l-2.9,6.2
                H903l-2.9-6.2v7.9h-2.9V72.1h4.2l2.7,6.7L906.9,72.1z"/>
            <rect x="-2.2" y="-6.9" class="st1" width="913.3" height="184.2"/>
        </symbol>

        <symbol id="icon-person" x="0px" y="0px" viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;">
            <style>
                #icon-person path{
                    fill: currentColor;
                    stroke: none;
                }
            </style>
            <path d="M3,31.2c2-1.9,4.3-3.4,6.8-4.5c2.5-1.1,5.3-1.7,8.2-1.7s5.7,0.6,8.2,1.7c2.5,1.1,4.8,2.7,6.8,4.5V3H3V31.2z M18.1,21
            c1.9,0,3.6-0.7,4.9-2c1.3-1.3,2-3,2-4.9s-0.7-3.6-2-4.9s-3-2-4.9-2s-3.6,0.7-4.9,2s-2,3-2,4.9s0.7,3.6,2,4.9
            C14.5,20.3,16.2,21,18.1,21z M3,36c-0.8,0-1.5-0.3-2.1-0.9C0.3,34.5,0,33.8,0,33V3c0-0.8,0.3-1.5,0.9-2.1S2.2,0,3,0h30
            c0.8,0,1.5,0.3,2.1,0.9C35.7,1.5,36,2.2,36,3v30c0,0.8-0.3,1.5-0.9,2.1C34.5,35.7,33.8,36,33,36H3z M5.8,33h24.5v-0.5
            c-1.8-1.5-3.7-2.7-5.8-3.5s-4.2-1.2-6.5-1.2s-4.4,0.4-6.5,1.2s-4,1.9-5.8,3.5L5.8,33z M18.1,18c-1.1,0-2-0.4-2.8-1.1
            s-1.1-1.7-1.1-2.8c0-1.1,0.4-2,1.1-2.8s1.7-1.1,2.8-1.1c1.1,0,2,0.4,2.8,1.1S22,13,22,14c0,1.1-0.4,2-1.1,2.8S19.2,17.9,18.1,18z"/>
        </symbol>

        <symbol id="icon-chevron" x="0px" y="0px" viewBox="0 0 5.3 8.2" style="enable-background:new 0 0 5.3 8.2;">
            <path d="M0.8,4.2 M0.8,4.2L4,1 M4,7.4L0.8,4.2"/>
        </symbol>

        <symbol id="icon-plus" x="0px" y="0px" viewBox="0 0 11 11" style="enable-background:new 0 0 11 11;">
            <path d="M10.1,5.5H5.5v4.6 M5.5,5.5H0.9 M5.5,0.9v4.6"/>
        </symbol>

        <symbol id="icon-minus" x="0px" y="0px" viewBox="0 0 11 11" style="enable-background:new 0 0 11 11;">
            <path d="M10.1,5.5H5.4 M5.4,5.5H0.7 M5.4,5.5"/>
        </symbol>

        <symbol id="icon-cart" x="0px" y="0px" viewBox="0 0 24.6 24.6" style="enable-background:new 0 0 24.6 24.6;">
            <style>
                #icon-cart path {
                    fill: currentColor;
                    stroke: none;
                }
            </style>
        <path d="M24.2,5.8h-19c0,0-0.1-3.2-1.3-4.5C3,0.4,1.8-0.1,0.5,0l0,0C0.2,0,0,0.2-0.1,0.5c0,0.3,0.2,0.6,0.5,0.6c0,0,0.1,0,0.1,0
            C2,1,3.3,1.9,3.6,3.4c0.3,1.2,1.9,13.1,2.3,15.7c-1.5,0.7-2.1,2.4-1.4,3.9c0.7,1.5,2.4,2.1,3.9,1.4c1-0.5,1.7-1.5,1.7-2.6
            c0-0.5-0.1-0.9-0.4-1.4h7.1c-0.2,0.4-0.4,0.9-0.4,1.4c0,1.6,1.3,2.9,2.9,2.9c1.6,0,2.9-1.3,2.9-2.9c0-1.6-1.3-2.9-2.9-2.9H7.2
            l-0.6-3.5h12.7c1.6,0.1,3-0.9,3.3-2.5c0.3-1.3,1.5-5,2-6.4c0.1-0.2,0-0.4-0.3-0.5C24.3,5.8,24.2,5.8,24.2,5.8z"/>
        </symbol>

        <symbol id="icon-favicon-circle" x="0px" y="0px" viewBox="0 0 235.8 255.9" style="enable-background:new 0 0 235.8 255.9;">
            <path d="M73.4,223.1c-13.6-5.8-25.8-14-36.3-24.5c-10.5-10.5-18.7-22.7-24.5-36.3c-6-14.1-9-29-9-44.5c0-15.4,3-30.4,9-44.5
            c5.8-13.6,14-25.8,24.5-36.3c10.5-10.5,22.7-18.7,36.3-24.5c14.1-6,29-9,44.5-9c15.4,0,30.4,3,44.5,9c13.6,5.8,25.8,14,36.3,24.5
            c10.5,10.5,18.7,22.7,24.5,36.3c6,14.1,9,29,9,44.5c0,15.4-3,30.4-9,44.5c-5.8,13.6-14,25.8-24.5,36.3
            c-10.5,10.5-22.7,18.7-36.3,24.5c-14.1,6-29,9-44.5,9C102.5,232.1,87.5,229.1,73.4,223.1 M117.9,0C102,0,86.5,3.1,72,9.3
            c-14,5.9-26.6,14.4-37.5,25.3C23.7,45.4,15.2,58,9.3,72C3.1,86.5,0,102,0,117.9c0,15.9,3.1,31.4,9.3,45.9
            c5.9,14,14.4,26.6,25.3,37.5C45.4,212.1,58,220.6,72,226.5c14.5,6.1,30,9.3,45.9,9.3c15.9,0,31.4-3.1,45.9-9.3
            c14-5.9,26.6-14.4,37.5-25.3s19.3-23.4,25.3-37.5c6.1-14.5,9.3-30,9.3-45.9c0-15.9-3.1-31.4-9.3-45.9c-5.9-14-14.4-26.6-25.3-37.5
            s-23.4-19.3-37.5-25.3C149.2,3.1,133.8,0,117.9,0z"/>
            <path d="M117.8,211.6c-0.2,0-0.3,0.2-0.4,0.4c-0.2,0.8-0.5,1.7-0.7,2.7c-0.9,3.5-2.1,7.9-3.5,10.5c-1.4,2.5-3.7,4.7-5.6,6.5
            c-0.5,0.5-1,0.9-1.4,1.3c-0.1,0.1-0.2,0.4-0.2,0.7c0,0.3,0.1,0.6,0.2,0.7c0.4,0.4,0.9,0.9,1.4,1.3c1.9,1.8,4.2,3.9,5.6,6.5
            c1.4,2.5,2.5,7,3.5,10.5c0.3,1,0.5,1.9,0.7,2.7c0.1,0.3,0.2,0.4,0.4,0.4c0.2,0,0.3-0.2,0.4-0.4c0.2-0.8,0.5-1.7,0.7-2.7
            c0.9-3.5,2.1-7.9,3.5-10.5c1.4-2.6,3.7-4.7,5.6-6.5c0.5-0.5,1-0.9,1.4-1.3c0.1-0.1,0.2-0.4,0.2-0.7c0-0.3-0.1-0.6-0.2-0.7
            c-0.4-0.4-0.9-0.9-1.4-1.3c-1.9-1.8-4.2-3.9-5.6-6.5c-1.4-2.6-2.5-7-3.5-10.5c-0.3-1-0.5-1.9-0.7-2.7
            C118.1,211.8,117.9,211.6,117.8,211.6z"/>
        </symbol>

        <symbol id="icon-location" x="0px" y="0px" viewBox="0 0 32 40">
            <style>
                #icon-location path {
                    fill: currentColor;
                    stroke: none;
                }
            </style>
            <path d="M16,19.5c1,0,1.8-0.3,2.5-1c0.7-0.7,1-1.5,1-2.5s-0.3-1.8-1-2.5c-0.7-0.7-1.5-1-2.5-1s-1.8,0.3-2.5,1c-0.7,0.7-1,1.5-1,2.5
            s0.3,1.8,1,2.5C14.2,19.1,15,19.5,16,19.5z M16,36c4.4-4,7.7-7.7,9.8-11s3.2-6.2,3.2-8.7c0-3.9-1.3-7.1-3.8-9.6S19.6,3,16,3
            S9.3,4.2,6.8,6.7S3,12.4,3,16.4c0,2.5,1.1,5.4,3.2,8.7S11.7,32,16,36z M16,40c-5.4-4.6-9.4-8.8-12-12.7s-4-7.5-4-10.9
            c0-5,1.6-9,4.8-11.9S11.8,0,16,0s8,1.5,11.2,4.4S32,11.4,32,16.4c0,3.3-1.3,7-4,10.9S21.4,35.4,16,40z"/>
        </symbol>

        <symbol id="icon-stars" x="0px" y="0px"
	            viewBox="0 0 3000 504.4" style="enable-background:new 0 0 3000 504.4;">
            <style>
                #icon-stars polygon {
                    fill: currentColor;
                }
            </style>
            <g>
	            <polygon points="265.2,401.5 101.3,504.4 148.5,316.8 0,192.7 193.1,179.6 265.2,0 337.3,179.6 530.4,192.7 
		            381.9,316.8 429.1,504.4"/>
	            <polygon points="882.6,401.5 718.7,504.4 765.9,316.8 617.4,192.7 810.5,179.6 882.6,0 954.7,179.6 1147.8,192.7 
		            999.3,316.8 1046.5,504.4"/>
	            <polygon points="1500,401.5 1336.1,504.4 1383.3,316.8 1234.8,192.7 1427.9,179.6 1500,0 1572.1,179.6 1765.2,192.7 
		            1616.7,316.8 1663.9,504.4"/>
	            <polygon points="2117.4,401.5 1953.5,504.4 2000.7,316.8 1852.2,192.7 2045.3,179.6 2117.4,0 2189.5,179.6 
		            2382.6,192.7 2234.1,316.8 2281.3,504.4"/>
	            <polygon points="2734.8,401.5 2570.9,504.4 2618.1,316.8 2469.6,192.7 2662.7,179.6 2734.8,0 2806.9,179.6 3000,192.7 
		            2851.5,316.8 2898.7,504.4"/>
            </g>
        </symbol>

        <symbol id="icon-search" x="0px" y="0px" viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;">
            <style>
                #icon-search path {
                    fill: currentColor;
                    stroke: none;
                }
            </style>
            <path d="M33.8,36L20.6,22.8c-1,0.9-2.2,1.5-3.5,2c-1.3,0.5-2.8,0.7-4.2,0.7c-3.6,0-6.6-1.2-9.1-3.8S0,16.3,0,12.8s1.2-6.6,3.8-9.1
            S9.3,0,12.9,0c3.5,0,6.5,1.2,9,3.8s3.7,5.5,3.7,9.1c0,1.4-0.2,2.8-0.7,4.2c-0.5,1.3-1.2,2.6-2.1,3.8L36,33.8L33.8,36z M12.8,22.6
            c2.7,0,5-1,6.9-2.9c1.9-1.9,2.9-4.2,2.9-6.9s-1-5-2.9-6.9S15.6,3,12.9,3c-2.7,0-5.1,1-7,2.9S3,10.1,3,12.8s1,5,2.9,6.9
            S10.1,22.6,12.8,22.6z"/>
        </symbol>

        <symbol id="icon-instagram" x="0px" y="0px" viewBox="0 0 67.2 67.2">
            <path d="M47.5,15.9c0,2.2,1.8,3.9,3.9,3.9c2.2,0,3.9-1.8,3.9-3.9c0-2.2-1.8-3.9-3.9-3.9C49.2,12,47.5,13.8,47.5,15.9"/>
            <path d="M23.3,33.6C23.3,27.8,28,23,33.9,23c5.8,0,10.6,4.8,10.6,10.6c0,5.8-4.8,10.6-10.6,10.6C28,44.2,23.3,39.5,23.3,33.6
                    M17.3,33.6c0,9.1,7.4,16.6,16.6,16.6s16.6-7.4,16.6-16.6c0-9.1-7.4-16.6-16.6-16.6S17.3,24.5,17.3,33.6"/>
            <path d="M6.3,47V20.2c0-7.6,6.2-13.9,13.9-13.9H47c7.6,0,13.9,6.2,13.9,13.9V47c0,7.6-6.2,13.9-13.9,13.9H20.2
                C12.5,60.9,6.3,54.7,6.3,47 M20.2,0C9.1,0,0,9.1,0,20.2V47c0,11.1,9.1,20.2,20.2,20.2H47c11.1,0,20.2-9.1,20.2-20.2V20.2
                C67.2,9.1,58.2,0,47,0H20.2z"/>
        </symbol>

        <symbol id="icon-facebook" x="0px" y="0px" viewBox="0 0 36 67.2">
            <path d="M10.7,16.4v9.3H0v12.2h10.7v29.4h13.2V37.8h9.8l1.9-12.2H23.8v-7.9c0-3.3,1.6-6.6,6.9-6.6H36V0.8c0,0-4.8-0.8-9.4-0.8
            C17,0,10.7,5.8,10.7,16.4"/>
        </symbol>

        <symbol id="icon-youtube" x="0px" y="0px" viewBox="0 0 68.3 47.8">
            <path d="M25.6,32.9V15.4c0-0.8,2.3-1.3,3-0.9l16.5,9c0.7,0.4,1.4,1.4,0.7,1.8l-17.2,8.5c-0.2,0.1-0.4,0.1-0.7,0.1
            C27,33.9,25.6,33.5,25.6,32.9 M15,0C6.7,0,0,6.7,0,15v17.8c0,8.3,6.7,15,15,15h38.3c8.3,0,15-6.7,15-15V15c0-8.3-6.7-15-15-15H15z"
            />
        </symbol>

        <symbol id="icon-tiktok" x="0px" y="0px" viewBox="0 0 58.6 68.5">
            <path d="M32,0l-0.1,47.8c0,5.9-5.2,10.5-11,10.5c-5.9,0-10.6-4.8-10.6-10.6c0-5.9,4.8-10.6,10.6-10.6c0.4,0,0.9,0.1,1.3,0.1V26.9
            c-0.4,0-0.9-0.1-1.3-0.1C9.3,26.9,0,36.2,0,47.7c0,11.5,9.3,20.8,20.8,20.8c11.5,0,20.8-9.3,20.8-20.8V19.5
            c3.4,5.2,9.1,8.3,15.3,8.3c0.6,0,1.1,0,1.7-0.1h0V16.3C49.8,15.7,42.7,8.8,41.8,0H32z"/>
        </symbol>

        <symbol id="icon-cart" viewBox="0 0 72 62">
            <g>
                <path d="M39,55a7,7,0,1,0,7-7,7,7,0,0,0-7,7m4,0a3,3,0,1,1,3,3,3,3,0,0,1-3-3"></path>
                <path d="M7,55a7,7,0,1,0,7-7,7,7,0,0,0-7,7m4,0a3,3,0,1,1,3,3,3,3,0,0,1-3-3"></path>
                <path d="M14,52H46a2,2,0,0,0,1.9-1.37L63.44,4H70a2,2,0,0,0,0-4H62a2,2,0,0,0-1.9,1.37L44.56,48H14a2,2,0,0,0,0,4"></path>
                <path d="M10,40H50a2,2,0,1,0,0-4H11.44L4.77,16H58a2,2,0,1,0,0-4H2A2,2,0,0,0,.1,14.63l8,24A2,2,0,0,0,10,40"></path><path d="M6,28H54a2,2,0,1,0,0-4H6a2,2,0,0,0,0,4"></path>
                <path d="M37.5,40a2,2,0,0,0,2-1.75l3-24a2,2,0,0,0-4-.5l-3,24A2,2,0,0,0,37.25,40l.25,0"></path>
                <path d="M22.5,40l.25,0a2,2,0,0,0,1.74-2.23l-3-24a2,2,0,0,0-4,.5l3,24a2,2,0,0,0,2,1.75"></path>
            </g>
        </symbol>

        <symbol id="icon-checkmark" viewBox="0 0 101 77">
            <path d="M98.2871,3.4561c-4.96-4.96-13.51-4.53-19,.96L36.6071,47.0961l-14.15-14.15c-5.49-5.49-14.04-5.92-19-.96-4.96,4.96-4.53,13.51,.95,19l21.67,21.67c2.84,2.83,6.49,4.31,10.04,4.4h.98c3.55-.09,7.2-1.57,10.03-4.4L97.3271,22.4561c5.49-5.49,5.92-14.04,.95-19h.01Z"/>
        </symbol>
        <symbol id="shipping-truck" viewBox="0 0 406.783 406.783" style="enable-background:new 0 0 406.783 406.783;"
	 xml:space="preserve">
            <g>
                <g>
                    <path d="M127.12,256.572c-19.742,0-35.741,15.993-35.741,35.737c0,19.745,15.999,35.738,35.741,35.738
                        c19.749,0,35.744-15.993,35.744-35.738C162.864,272.565,146.869,256.572,127.12,256.572z M127.12,307.846
                        c-8.582,0-15.536-6.955-15.536-15.537c0-8.586,6.954-15.537,15.536-15.537c8.583,0,15.542,6.951,15.542,15.537
                        C142.662,300.891,135.703,307.846,127.12,307.846z"/>
                    <path d="M315.588,256.572c-19.742,0-35.74,15.993-35.74,35.737c0,19.745,15.998,35.738,35.74,35.738
                        c19.75,0,35.744-15.993,35.744-35.738C351.332,272.565,335.338,256.572,315.588,256.572z M315.588,307.846
                        c-8.582,0-15.535-6.955-15.535-15.537c0-8.586,6.953-15.537,15.535-15.537c8.584,0,15.543,6.951,15.543,15.537
                        C331.131,300.891,324.172,307.846,315.588,307.846z"/>
                    <path d="M167.329,146.759c0,5.008-4.098,9.105-9.105,9.105H32.579c-5.008,0-9.104-4.097-9.104-9.105v-5.463
                        c0-5.007,4.097-9.104,9.104-9.104h125.645c5.008,0,9.105,4.097,9.105,9.104V146.759z"/>
                    <path d="M385.623,200.066c-13.105-3.407-20.604-5.549-25.75-15.487l-17.207-34.839c-5.148-9.938-18.518-18.07-29.707-18.07
                        h-23.535c0,0-3.166,0.066-3.166-3.12c0-7.305,0-29.219,0-29.219c0-11.327-6.41-20.595-20.045-20.595H74.405
                        c-19.521,0-28.789,9.269-28.789,20.595v18.311c0,0,0,5.446,5.271,5.446c26.834,0,107.337,0,107.337,0
                        c10.041,0,18.21,8.168,18.21,18.209v5.463c0,10.041-8.169,18.209-18.21,18.209H50.887c0,0-5.271-0.438-5.271,5.252
                        c0,2.826,0,4.723,0,6.297c0,5.008,6.864,5.005,6.864,5.005h72.254c10.041,0,18.21,8.169,18.21,18.209v5.463
                        c0,10.041-8.169,18.209-18.21,18.209H53.62c0,0-8.004-0.148-8.004,6.225c0,11.062,0,44.246,0,44.246
                        c0,11.326,9.268,20.595,20.595,20.595c0,0,8.532,0,11.376,0c2.58,0,2.96-1.437,2.96-2.159c0-25.679,20.894-46.568,46.574-46.568
                        c25.682,0,46.575,20.891,46.575,46.568c0,0.725-0.206,2.159,1.767,2.159c22.55,0,91.806,0,91.806,0
                        c1.82,0,1.746-1.534,1.746-2.159c0-25.679,20.893-46.568,46.574-46.568s46.574,20.891,46.574,46.568
                        c0,0.725-0.018,2.159,1.121,2.159c10.34,0,23.146,0,23.146,0c11.195,0,20.352-9.157,20.352-20.351v-38.664
                        C406.783,202.894,396.502,202.894,385.623,200.066z M346.896,198.255c0,0-43.219,0-57.928,0c-2.393,0-2.711-2.33-2.711-2.33
                        V147.67c0,0-0.135-1.853,2.938-1.853c4.133,0,16.529,0,16.529,0c9.959,0,21.855,7.236,26.434,16.079l15.312,31
                        c0.645,1.248,1.334,2.356,2.072,3.349C350.086,196.973,349.174,198.255,346.896,198.255z"/>
                    <path d="M133.838,205.195c0,5.008-4.097,9.105-9.104,9.105H9.104C4.096,214.3,0,210.203,0,205.195v-5.463
                        c0-5.007,4.097-9.104,9.104-9.104h115.63c5.008,0,9.104,4.097,9.104,9.104V205.195z"/>
                </g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
        </symbol>
        <symbol id="makeup-bag" viewBox="0 0 153.4483 88.7931">
            <path d="M16.0877,79.091s-9.5532-14.6383-9.5532-25.0213S14.726,29.7293,26.6409,21.3888s23.3191-9.5319,36.5957-9.5319,29.7872-.1702,33.7021,0,14.2979,1.0213,25.0213,9.7021,14.4681,14.4681,17.7021,26.0426c0,0,2.5532,.1702,3.234,1.7021s3.7447,4.9362,1.3617,5.9574l4.2766,14.8085-1.8936,.5106-4.0851-13.4468s-4.9362,18.5532-12.2553,23.6596H17.2792l-1.1915-1.7021Z"/>
        </symbol>
        <symbol id="mail" viewBox="0 0 512 512">
            <g>
                <path d="M512,184.3v227.1c0,13-4.7,23.3-13,32.6c-9.3,9.3-19.5,13-32.6,13H45.6c-13,0-23.3-4.7-32.6-13
                    S0,424.5,0,411.5V184.3c8.4,9.3,17.7,17.7,28.9,25.1c68.9,46.5,116.4,80.1,142.4,98.7c11.2,8.4,19.5,14,26.1,18.6
                    c6.5,4.7,15.8,9.3,27,14c11.2,4.7,21.4,7.4,31.7,7.4h0c9.3,0,20.5-2.8,31.7-7.4c11.2-4.7,20.5-9.3,27-14
                    c6.5-4.7,15.8-11.2,26.1-18.6c32.6-23.3,80.1-55.9,142.4-98.7C494.3,202,503.6,193.6,512,184.3z M512,100.5
                    c0,14.9-4.7,29.8-14,42.8c-9.3,14-21.4,25.1-34.4,35.4c-71.7,49.3-116.4,81-134.1,93.1c-1.9,0.9-5.6,4.7-12.1,8.4
                    c-6.5,4.7-11.2,8.4-15.8,11.2s-9.3,5.6-14.9,9.3s-11.2,5.6-16.8,7.4c-5.6,1.9-10.2,2.8-14,2.8h0c-4.7,0-9.3-0.9-14-2.8
                    c-5.6-1.9-10.2-4.7-16.8-7.4c-5.6-3.7-11.2-6.5-14.9-9.3c-3.7-2.8-9.3-6.5-15.8-11.2s-10.2-7.4-12.1-8.4
                    c-17.7-12.1-41.9-29.8-74.5-52.1c-32.6-22.3-52.1-36.3-58.6-41c-12.1-8.4-23.3-18.6-33.5-32.6S0,119.2,0,107.1
                    c0-14.9,3.7-27,12.1-37.2c7.4-10.2,19.5-14.9,33.5-14.9h420.8c12.1,0,23.3,4.7,32.6,13C507.3,77.3,512,88.4,512,100.5z"/>
            </g>
        </symbol>
        <symbol id="phone" viewBox="0 0 122.88 122.27"><g><path d="M33.84,50.25c4.13,7.45,8.89,14.6,15.07,21.12c6.2,6.56,13.91,12.53,23.89,17.63c0.74,0.36,1.44,0.36,2.07,0.11 c0.95-0.36,1.92-1.15,2.87-2.1c0.74-0.74,1.66-1.92,2.62-3.21c3.84-5.05,8.59-11.32,15.3-8.18c0.15,0.07,0.26,0.15,0.41,0.21 l22.38,12.87c0.07,0.04,0.15,0.11,0.21,0.15c2.95,2.03,4.17,5.16,4.2,8.71c0,3.61-1.33,7.67-3.28,11.1 c-2.58,4.53-6.38,7.53-10.76,9.51c-4.17,1.92-8.81,2.95-13.27,3.61c-7,1.03-13.56,0.37-20.27-1.69 c-6.56-2.03-13.17-5.38-20.39-9.84l-0.53-0.34c-3.31-2.07-6.89-4.28-10.4-6.89C31.12,93.32,18.03,79.31,9.5,63.89 C2.35,50.95-1.55,36.98,0.58,23.67c1.18-7.3,4.31-13.94,9.77-18.32c4.76-3.84,11.17-5.94,19.47-5.2c0.95,0.07,1.8,0.62,2.25,1.44 l14.35,24.26c2.1,2.72,2.36,5.42,1.21,8.12c-0.95,2.21-2.87,4.25-5.49,6.15c-0.77,0.66-1.69,1.33-2.66,2.03 c-3.21,2.33-6.86,5.02-5.61,8.18L33.84,50.25L33.84,50.25L33.84,50.25z"/></g></symbol>
        <symbol id="heart" viewBox="0 0 122.88 107.41"><g><path d="M60.83,17.19C68.84,8.84,74.45,1.62,86.79,0.21c23.17-2.66,44.48,21.06,32.78,44.41 c-3.33,6.65-10.11,14.56-17.61,22.32c-8.23,8.52-17.34,16.87-23.72,23.2l-17.4,17.26L46.46,93.56C29.16,76.9,0.95,55.93,0.02,29.95 C-0.63,11.75,13.73,0.09,30.25,0.3C45.01,0.5,51.22,7.84,60.83,17.19L60.83,17.19L60.83,17.19z"/></g></symbol>
    </svg>
</span>

		
<script src="https://idvftfbs.dtmstage.com/shared/js/jquery.min.js"></script>



<script async src="https://apps.bazaarvoice.com/deployments/flawlesscleanse/main_site/staging/en_US/bv.js"></script>


<script type="text/javascript" src="https://idvftfbs.dtmstage.com/shared/js/common.js"></script>

<script async src="https://www.tiktok.com/embed.js"></script>

<script type="text/templates" id="CustomerCartStatusTemplate">
            <section id="customer-cart-status" data-modal-dialog-container data-modal-dialog-title="Customer Cart Status" aria-labelledby="customer-cart-status-title" class="view customer-cart-status section">
                <div class="view__in customer-cart-status__in section__in">
                    <div class="customer-cart-status__group">
                        <div id="customer-cart-status-title" class="customer-cart-status__response">{{Status}}</div>
                        <div data-template-test class="customer-cart-status__action">
                            <button type="button" data-modal-dialog-actor="close" data-modal-dialog-id="customer-cart-status" class="button customer-cart-status__button">
                                <span>Continue Shopping</span>
                            </button>
                        </div>
                        <div class="customer-cart-status__action">
                            <a href="index.dtm.html" class="button customer-cart-status__button">
                                <span>Checkout</span>
                            </a>
                        </div>
                    </div>
                </div>
            </section>
</script>



<script src="https://idvftfbs.dtmstage.com/shared/js/jquery.eflex.fw.js"></script>



<script id="DTMFWJS" >

    if (!Model) {
        // check if responsive mode is enabled and convert string to boolean
        switch ('False') {
            case 'True': case true: var inResponsiveMode = true; break;
            case 'False': case false: var inResponsiveMode = false; break;
        }

        // if responsive mode, model is mobile
        var Model = {

            IsMobile: inResponsiveMode ? true : "False"

        };
    }

    if (!DtmContext) {
        var DtmContext = {

            Page: {

                IsStartPageType: "True",

                PageType: "orderPage"

            },

            OfferCode: "UPGRADE",

            Version: "1.0000",

            PageCode: "Index",

            Campaign: {

                CampaignName: "Finishing Touch Flawless Branding Site"

            }

        };
    }
	/* @Config
	* --------------------------------------------------------------------- */
    // add support for custom jQuery select 
    // ex: $("element").is(":inviewport");
    $.extend($.expr[":"], {
        inviewport: function (element) {
            let result = false;
            const coords = element.getBoundingClientRect();

            if (coords.x <= window.innerWidth
                && coords.y <= window.innerHeight
                && coords.x >= 0 && coords.y >= 0) {
                result = true;
            };

            return result;
        }
    });

    // get eFlex object
    var eflex = $.eflex();
    // get mastermind object
    var master = $.eflex('mastermind');
    // turn on live mode
    $.eflex('live');
    // set DTM object
    var _dtm = {};
    // set eFlex object
    var _eflex = {};

    // set this property to detect the use of framework JS
    _dtm.useFramework = true;

    // set shopping cart object
    _dtm.ShoppingCart = { items: {} };


	/* @Data Type Conversions
	* --------------------------------------------------------------------- */
    // convert string to boolean data type
    Model.IsMobile = master.calc('parseBoolean', { string: Model.IsMobile }).func;


	/* @Path Observer
	* --------------------------------------------------------------------- */
    // checks if a url exists
    _dtm.ifExists = function (url, args) {
        args = args || {};
        args.researchByExtension = args.researchByExtension || undefined;
        args.success = args.success || undefined;

        // set new HTTP request
        var http = new XMLHttpRequest();
        // pass url into the head
        try {
            http.open('HEAD', url, false);
            http.send();
        } catch (e) {
            console.log(e.message);
        }

        // if we want to research when the initial search fails
        if (http.status === 404 && typeof (args.researchByExtension) === 'object') {
            // get length of extensions
            var len = args.researchByExtension.length;
            // filter through all extension types
            $.each(args.researchByExtension, function (index, ext) {
                // replace url former extension with new extension
                url = url.substr(0, url.lastIndexOf('.')) + ext;
                // halt on researching once we reach the last iteration
                args.researchByExtension = index === len - 1 ? args.researchByExtension : false;
                // check if file name with new extension exists
                _dtm.ifExists(url, args);
            });

            // if we want to pass back the returned url when search is successful
        } else if (http.status === 200 && typeof (args.success) === 'function') {
            args.success(url);

            // return status
        } else {
            return http.status != 404;
        }
    };


	/* @Native Modifiers
	* --------------------------------------------------------------------- */
    // store og alert method
    window.nativeAlert = window.alert;

    // set vse alert method
    _dtm.alert = function (data, target, cb) {
        // set callback function
        var cb = cb || function () { };
        // set fragment
        var frag = document.createDocumentFragment();
        // set validation summary error container
        var vse = document.createElement('div');
        // add classes to vse
        vse.className = 'validation-summary-errors o-box--msg-error';

        // set unordered list
        var ul = document.createElement('ul');
        // convert string into array based on line breaks
        var a = data.split('\n');

        // iterate each item
        for (var i = 0; i < a.length; i++) {
            // check if item is blank
            if (a[i] === '') {
                // remove it from array
                a.splice(i, 1);
            } else {
                // create html tags
                var node = i === 0 ? document.createElement('span') : document.createElement('li');
                // replace tabs
                node.innerHTML = a[i].replace(/\t/g, '');
                // check if item is required field
                if (i !== 0) {
                    // add node to the ul
                    ul.appendChild(node);
                    // otherwise,
                } else {
                    // add node to the fragment
                    vse.appendChild(node);
                }
            }
        }
        // add unordered list to the fragment
        vse.appendChild(ul);
        frag.appendChild(vse);

        // set array for potential error targets
        var e_target = target || [
            $('#vse'),
            $('form').find('span[style="color: #FF0000; font-weight: bold"]'),
            $('form').find('span[style="color: rgb(255, 0, 0); font-weight: bold;"]'),
            $('.vse')
        ];

        // check if error target is an array
        if ($.isArray(e_target)) {
            // set error counter
            var e_count = 0;

            // cycle each target
            $.each(e_target, function (index, value) {
                // check if element exists
                if (value.length > 0) {
                    // insert frag into element
                    value.html(vse);
                    e_target = value;
                } else {
                    // otherwise, add this to error counter
                    e_count++;
                }
            });

            // check if array length matches number of errors - means basically none of the above options exist
            if (e_target.length === e_count) {
                // prepend the frag to the form
                $('form').prepend(frag);
            }
        } else {
            // insert the frag into custom target
            e_target.html(frag);
        }

        // check if scroll override exists
        if (e_target.data('vse-scroll') === undefined) {
            // scroll to vse
            $.scrollTo('.validation-summary-errors');
        }

        $('[data-vse-button]').removeClass('hide');

        //Saving error message to pixelService
        var errors = {};

        for (var i = 0; i < a.length; i++) {

            var message = a[i].replace('\t', '');

            errors["Error " + i] = message;

        }

        $.post('/shared/services/pixelservice.ashx?at=error', errors);

        if (typeof errorsObj !== "undefined")
        {
            triggerEvent('handleErrorValidationMapping', errorsObj);           
        }


        return cb(data, e_target);

    };

    // redefine new alert method
    window.alert = function (data) {
        
        // check if returned data contains validation from common.js
        var validationHeaders = "Please correct the following issues|Corrija los siguientes problemas|Veuillez corriger les problèmes suivants";
        var result = (data && typeof (data) == "string" && data.match(validationHeaders)) || '';

        switch (result.length > 0) {
            case true:
                _dtm.alert(data, null, function (data, target) {
                    try {
                        _dtm.callbackAlert(data, target);
                    } catch (e) {
                        console.log(e.message);
                    }
                });
                break;
            case false:
                window.nativeAlert(data);
                break;
        }
    };

    // streamline custom validation with common.js
    _dtm.includeValidation = function (data, target) {
        var vse = $('.validation-summary-errors ul');
        if (vse.length !== 1) {
            vse.prepend($('<li class="error_msg">' + data + '</li>'));
        } else {
            target.fadeSlideDown();
        }
    };

	



    // Disables / hides order links
    _dtm.disableOrderLinks = function () {

        // get subpage text nav list
        $('.subpage-text-nav').contents().filter(function () {
            // filter by keyword
            var filter = $(this).text().match(/order/i) || '';
            // iterate each node and check if it contains the keyword
            if (filter.length > 0) {
                // hide element
                $(this).hide();
                // check if next sibling is a text node
                if (this.nextSibling.nodeType === 3) {
                    // remove the unnecessary text node
                    this.nextSibling.data = this.nextSibling.data.slice(0, -1);
                }
            }
        });

    };

    // Move Method
    _dtm.move = function (attr) {
        // get jQuery method from data attribute
        var data = attr.selector;
        // check if selector contains brackets
        var dataAttr = (data.match(/\[([^\]]+)]/g)) || '';

        // check if selector is blank
        if (dataAttr.length === 0) {
            $.each(attr.get(0).attributes, function (k, v) {
                if (v.nodeName.match(/prepend/g) || v.nodeName.match(/append/g)) {
                    data = v.nodeName;
                }
            });
        }

        // strip out brackets and data prefix
        data = data.replace(/[\[\]']+/g, '');
        data = data.substr(data.indexOf('-') + 1);

        // get target selector
        var target = attr.data(data);

        // check if using append or prepend
        if (data.match(/append/g)) {
            attr.appendTo($(target));
        } else if (data.match(/prepend/g)) {
            attr.prependTo($(target));
        }

    };

    // sets a scroll listener to watch for when the window approaches an element
    _dtm.scrollAlert = function (args) {
        args = args || {};
        // set target element
        var $target = args.$target || $('[data-scroll-alert]');
        // set data attribute
        var data = args.data || 'scroll-alert';
        // set classes
        var classes = args.classes || 'in-range';

        // check if alert mode is enabled
        if ($target.data(data) === true) {
            $(window).scroll(function () {
                // check if scroll position is within range of the toggle button
                if (($(window).scrollTop() + ($(window).height() / 1.3)) > $target.offset().top) {
                    $target.addClass(classes);
                } else {
                    $target.removeClass(classes);
                }
            });
        }
    };

	/* @Automated Steps Generator
	* --------------------------------------------------------------------- */
    // dynamically assigns step numbering on the order form
    _dtm.automateSteps = function (options) {
        var options = options || {};
        // get setting for step header from International CM
        var text = options.text || '<strong>STEP 2:</strong> Review your order';
        // check if string contains only white spaces or tabs
        var isWhiteSpace = function (str) {
            return str.replace(/\s/g, "").length === 0;
        };

        // check if text contains a string and contains characters
        if (typeof text === "string" && text.length > 0 && !isWhiteSpace(text)) {
            // get visiblity state for the OFRT step
            
            var showReviewTable = true;
            

            // get regex pattern
            var regex = options.regex || /([a-zA-Z]*)(?=\s|:)/i;
            // get element to search by
            var $form = options.$form || $("#form");
            // get step text by regex match
            var matches = text.match(regex);

            // check if any matches are found
            if (matches !== null) {
                // get the first match found
                var step = matches[0];

                // make sure first match is not a white space
                if (!isWhiteSpace(step)) {
                    var stepRegex = new RegExp(step, "i");
                    // store matches from the document 
                    var nodes = [];
                    // filter element and collect all matches
                    $form.find("strong, b").filter(function (index, node) {
                        var hasMatch = node.innerText.match(stepRegex);

                        if (hasMatch !== null) {
                            nodes.push(node);
                        }
                    });
                    // set y increment to add each step number 
                    var y = 1;
                    // iterate all matches and replace the current number with ascending order
                    nodes.forEach(function (node) {
                        // assign the matching step element from the DOM into a variable 
                        var $step = $(node);
                        // check if step is within reviewOrder
                        var isReviewTable = $step.closest("#reviewOrder").length;
                        // check if reviewOrder is visible or if the step is not within reviewOrder
                        if (isReviewTable && showReviewTable || !isReviewTable) {
                            $step.text($step.text().replace(/\d+/, y));
                            y++;
                        }
                    });
                }
            } else {
                console.warn("_dtm.automateSteps: There were no matches found for the given text.");
            }
        } else {
            console.warn("_dtm.automateSteps: Cannot process text either because it is not a string or it is an empty string.");
        }
    }

    // creates a stylized toggle button
    _dtm.getLanguageToggle = function (data) {

        // set entity decoder
        var decodeHtmlEntity = function (str) {
            return str.replace(/&#(\d+);/g, function (match, dec) {
                return String.fromCharCode(dec);
            });
        };

        data = data || {};
        // check if data object is not empty
        if (!$.isEmptyObject(data)) {
            // set up button template
            data.class = 'icon-' + data.flag || data.id;

            // set up button template
            var html = '<div class="row-to-center center-margin">';
            html += '<div class="col language__flag right-padding"><span class="' + data.class + '"></span></div>';
            html += '<div class="col left-padding"><span class="language__txt">' + data.text + '</span></div>';
            html += '</div>';
            // get button
            var $btn = $(html);
            // get text
            var text = $btn.find('.language__txt').text();

            // set data array to test for the cta pattern
            $.each([
                { cta: 'cliquez ici!' },
                { cta: 'cliquez ici' },
                { cta: 'haga click aqu&#237;!' },
                { cta: 'haga click aqu&#237;' },
                { cta: 'click here!' },
                { cta: 'click here' },
            ], function (key, val) {
                // test for pattern match
                var cta = (text.match(new RegExp(decodeHtmlEntity(val.cta), 'i'))) || '';
                // check if match was found
                if (cta.length > 0) {
                    // wrap the cta in and style
                    $btn.html($btn.html().replace(cta[0], '<span class="language__cta">' + cta[0] + '</span>'));
                    return false;
                }
            });

            // apply each of the SVG paths to the button
            for (var i = 1; i <= data.SVGPathCount; i++) {
                $('<span class="path' + i + '"></span>').appendTo($btn.find('.' + data.class));
            }

            // search for the data lan toggle
            $('[data-lan-toggle="' + data.id + '"]').html($btn).attr('href', data.link)
                .addClass('animate language-button language-button--' + data.id);
        }

    };

    // retrieves label snippets and initailizes the language toggles
    _dtm.setLanguageToggles = function () {

        var setResponsive = function ($this) {
            // check if vertical mode is enabled
            if ($this.data('lan-theme') === 'vertical' && $this.data('lan-responsive') !== undefined) {
                // get switch width
                var _w = $this.data('lan-switch-at');
                if (typeof (_w) === 'undefined') {
                    // get container
                    var $container = $('#content_top').length > 0 ? $('#content_top') : $('#formWrap');
                    _w = $container.outerWidth(true);
                }

                // check if responsive header mode is enabled
                if ($this.data('lan-responsive') === 'header') {
                    var $anchor, method,
                        uid = Math.random(),
                        updateToggle = function () {
                            // check if window width is less than wrapper
                            if ($(window).width() < _w) {
                                $this.attr('data-lan-theme', 'default')
                                    .addClass('is-device').prependTo($('body'));
                            } else {
                                $this.attr('data-lan-theme', 'vertical')
                                    .removeClass('is-device')[method]($anchor);
                            }
                        };

                    // search for either previous or next sibling
                    switch (true) {
                        case $this.next().length > 0:
                            $anchor = $this.next();
                            method = 'insertBefore';
                            break;
                        case $this.prev().length > 0:
                            $anchor = $this.prev();
                            method = 'insertAfter';
                            break;
                    }

                    // set anchor position
                    $anchor.attr('data-lan-anchor', uid);

                    // otherwise, check if responsive form mode is enabled
                } else if ($this.data('lan-responsive') === 'form') {
                    var updateToggle = function () {
                        // check if window width is less than wrapper
                        if ($(window).width() < $container.outerWidth(true)) {
                            $this.addClass('is-device');
                        } else {
                            $this.removeClass('is-device');
                        }
                    };
                }

                updateToggle();
                $(window).resize(function () { updateToggle(); });
            }
        };

        $.each([
            {
                id: 'us',
                text: 'Placing an Order from the USA? Click Here!',
                link: '#',
                SVGPathCount: 5
            },
            {
                id: 'ca',
                text: 'Placing an order from Canada? Click Here!',
                link: '#',
                SVGPathCount: 2
            },
            {
                id: 'fr',
                flag: 'ca',
                text: 'Commandez En Francais Cliquez Ici',
                link: '#',
                SVGPathCount: 2
            },
            {
                id: 'es',
                text: 'Para Ordenar en Español? Haga Click Aquí',
                link: '#',
                SVGPathCount: 15
            },
            {
                id: 'au',
                text: 'For Orders in Australia Click Here',
                link: '#',
                SVGPathCount: 5
            },
            {
                id: 'uk',
                text: 'Placing an Order from the U.K.? Click Here!',
                link: '#',
                SVGPathCount: 4
            }
        ], function (key, val) {
            // check if the language text & language link fields aren't empty
            if (val.text.length > 0 && val.link.length > 0) {
                _dtm.getLanguageToggle({
                    id: val.id,
                    flag: val.flag || val.id,
                    text: val.text,
                    link: val.link,
                    SVGPathCount: val.SVGPathCount
                });
            }
        });

        // get all toggle buttons
        $('[data-lan-toggle]').each(function () {
            var $this = $(this);

            // enable append / prepend mode
            _dtm.move($this);

            // set responsive mode
            setResponsive($this);

            // set alert mode
            _dtm.scrollAlert({ $target: $this, data: 'lan-alert', classes: 'in-range' });
        });
    };

    _dtm.setLanguageToggles();

    // restyle for express checkout feature
    _dtm.expressCheckout = function (args) {
        // set args
        args = args || {};

        /* Public Variables */
        // set option default
        args.option = args.option || $('.checkout-option');
        // set target default
        args.target = args.target || args.option.find('label');
        // set input default
        args.input = args.input || args.option.find('input');

        // set submit default
        args.submit = args.submit || $('#AcceptOfferButton');
        // set disclaimer default
        args.disclaimer = args.disclaimer || $('.c-brand--form__submission');
        // set payment type attribute
        args.getPaymentTypeBy = args.getPaymentTypeBy || 'id';
        // use jQuery Eflex Draw
        args.jQueryEflexDraw = args.jQueryEflexDraw || {};
        args.jQueryEflexDraw.enable = args.jQueryEflexDraw.enable !== undefined ? args.jQueryEflexDraw.enable : args.jQueryEflexDraw.enable || true;
        args.jQueryEflexDraw.icon = args.jQueryEflexDraw.icon || 'radio-checkbox';
        // set classes default
        args.classes = args.classes || {
            card: 'checkout-theme-base',
            paypal: 'checkout-theme-base',
            amazon: 'checkout-theme-base'
        };

        // set up dynamic PayPal button
        args.addPayPalButton = args.addPayPalButton !== undefined ? args.addPayPalButton : true;
        // set up dynamic Venmo button
        args.addVenmoButton = args.addVenmoButton !== undefined ? args.addVenmoButton : false;

		

        /* Private Variables */
        // set was submit default
        var wasSubmit = false;
        var olabel = (function () {
            if (args.submit.is('button')) {
                return args.submit.text();
            } else {
                return args.submit.val();
            }
        })();
        // get original classes
        var oclasses = args.submit.attr('class');
        // create a new payment button
        var makeButton = function (PaymentType, ImageUrl) {
            try {
                return $('<input/>', {
                    type: 'image',
                    style: 'display: block',
                    class: 'block is-' + PaymentType + ' is-express-checkout-image AcceptOfferButton u-mar--center',
                    src: ImageUrl,
                    id: 'id_' + PaymentType
                });
            } catch (e) {
                return e.message;
            }
        };

        // check if we're creating a PayPal button
        if (args.addPayPalButton) {
            var $img__paypal = makeButton('PayPal', function () {
                return $.grep(_expressCheckoutEngine.Items, function (n, i) {
                    return n.type.match(/PayPal/i);
                })[0].downImageUrl;
            });
        }

        // check if we're creating a Venmo button
        if (args.addVenmoButton) {
            var $img__venmo = makeButton('Venmo', function () {
                return $.grep(_expressCheckoutEngine.Items, function (n, i) {
                    return n.type.match(/Venmo/i);
                })[0].downImageUrl;
            });
        }

        /* Hide disclaimer text by default */
        args.disclaimer.hide();

        if (typeof (args.classes) === 'object') {
            // classes were passed as an object
            args.option.each(function (k, v) {
                // get current payment type
                var paymentType = $(v).attr(args.getPaymentTypeBy);
                // iterate each of the classes
                $.each(args.classes, function (x, y) {
                    // check if class key matches payment type
                    if (paymentType.match(new RegExp(x, 'i'))) {
                        // add correct class
                        $(v).addClass(y);
                    }
                });
            });
        } else {
            // classes were passed as a string
            args.classes = args.classes || 'checkout-theme-base';
            // wrap in label tag and apply styling
            args.option.addClass(args.classes);
        }

        // move each input tag into it's label tag
        args.input.each(function (index, value) {
            // trigger eflex draw
            $(value).prependTo($(value).siblings('label'));
            // check if using jQuery Eflex Draw
            if (args.jQueryEflexDraw.enable) {
                $(value).eflex({
                    type: 'draw', icon: args.jQueryEflexDraw.icon, classes: 'u-mar--right'
                });
            }
        });

        $('.c-brand--form__cc--label').hide();

        // make amazon button center
        $('.AmazonPayments').addClass('fn--center');

        args.input.on('click', function () {
            // get current payment type
            var paymentType = $(this).attr('id');

            // if we are not using an image to display the button
            if (args.submit.attr('type') === 'submit' || wasSubmit === true) {
                // check if paypal option was chosen
                if (paymentType.match(/PayPal/i)) {
                    $btn = args.submit.siblings('.is-paypal');
                    // check if express checkout image doesn't exist in the DOM
                    if ($btn.length === 0 && args.addPayPalButton) {
                        // insert express checkout image after submit button
                        $img__paypal.insertAfter(args.submit);
                    }
                    // hide submit button
                    args.submit.hide();
                    // show express checkout image
                    $btn.removeClass('hide');
                    args.submit.siblings('.is-express-checkout-image:not(.is-PayPal)').addClass('is--hidden');
                    args.submit.siblings('.is-PayPal').removeClass('is--hidden');

                    // detach from any styling
                    args.submit.removeClass().addClass('ec--img');

                    wasSubmit = true;
                    // if amazon was chosen
                } else if (paymentType.match(/Amazon/i)) {
                    // hide submit button
                    args.submit.hide();
                    // detach from any styling
                    args.submit.removeClass().addClass('ec--img');
                    // if venmo was chosen
                } else if (paymentType.match(/Venmo/i)) {
                    // check if express checkout image doesn't exist in the DOM
                    if (args.addVenmoButton) {
                        $img__venmo.insertAfter(args.submit);
                    }

                    // hide submit button
                    args.submit.hide();
                    args.submit.siblings('.is-express-checkout-image:not(.is-Venmo)').addClass('is--hidden');
                    args.submit.siblings('.is-Venmo').removeClass('is--hidden');

                    // detach from any styling
                    args.submit.removeClass().addClass('ec--img');
                }
            }

            // check if credit card option was chosen, show credit card disclaimer
            if (paymentType.match(/Card/gi)) {
                args.disclaimer.show();

                // change submit type back to normal
                args.submit.removeClass()
                    .addClass(oclasses).show();

                args.submit.siblings('.is-express-checkout-image').addClass('is--hidden');
                // otherwise, assume other payment methods, hide credit card disclaimer
            } else {
                args.disclaimer.hide();
            }

            triggerEvent('_dtmExpressCheckoutPaymentClick', {
                detail: {
                    args: args, paymentType: paymentType, wasSubmit: wasSubmit, original: {
                        classes: oclasses, label: olabel
                    }
                }
            });

        });

        // if express checkout image is clicked, trigger submission
        $('body').on('click', '.is-paypal, .is-Venmo', function (evt) {
            evt.preventDefault();
            args.submit.trigger('click');
        });

    };


	/* --------------------------------------------------------------------- *

	/* jQuery eFlex | Models

	* --------------------------------------------------------------------- */
    (function ($, document, window, undefined) {

        // jQuery Eflex Draw
        eflex.effects.draw = function (self, master, build, error) {
            /**
             * Determines if the label's htmlFor string value matches the input's id string value which if both match, then they represent the same identity.
             * @param label HTMLLabelElement
             * @param input HTMLInputElement
             */
            const forLabelMatchesInputId = function (label, input) {
                return label.htmlFor === input.id;
            }

            /**
             * Determines if the label's control element matches the input control element which if both match, then they are the same element.
             * @param label HTMLLabelElement
             * @param input HTMLInputElement
             */
            const labelMatchesInput = function (label, input) {
                return input && label && label.control ? label.control === input : false;
            }

            /**
             * Takes an element representing a form control and predicts if it is an orphan element that isn't contained in a label. If the prediction is true, communicate with the appropriate input control.
             * @param label HTMLLabelElement
             * @param input HTMLInputElement
             */
            const updateControlByOrphanElement = function (label, input) {
                if (!labelMatchesInput(label, input) || !forLabelMatchesInputId(label, input)) {
                    if (!input.disabled) {
                        input.checked ^= 1;
                    }
                }
            }

            var draw = construct(Object, function (draw, options, deferred) {

                this.draw = draw;
                this.icon = draw.data('eflex-icon') || options.icon || 'radio-checkbox';
                this.classes = draw.data('eflex-classes') || options.classes || '';
                this.svg = '<svg class="eflex-checkmark__svg ' + this.classes + '" viewBox="0 0 52 52"><circle class="eflex-checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="eflex-checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg>';

                this[this.icon]();

            }, {
                toggleStatus: function (_this) {
                    //_this.prop('checked', true);
                    //_this.next().attr('aria-checked', true);
                },

                "radio-checkbox": function (_this) {
                    var self = _this || this;

                    // check if the parent container doesn't already have the eflex styling hook
                    if (!self.draw.parent().hasClass('eflex-checkmark')) {
                        self.draw.attr('data-eflex', 'draw');
                        self.parent = self.draw.parent().addClass('eflex-checkmark');
                        // hide original input type
                        self.draw.css({
                            "display": "inline",
                            "position": "absolute",
                            "opacity": "0",
                            "top": "0",
                            "left": "0"
                        });

                        var $svg = $(this.svg);

                        // insert new svg checkbox
                        $svg.insertAfter(self.draw);

                        const input = self.draw.get(0);
                        const label = $svg.closest("label").get(0);

                        $svg.on("click", updateControlByOrphanElement.bind(this, label, input));
                    }
                },

                checkmark: function (_this) {
                    var self = _this || this;

                    // check if the parent container doesn't already have the eflex styling hook
                    if (!self.draw.parent().hasClass('eflex-checkmark')) {
                        self.draw.attr('data-eflex', 'draw');
                        self.parent = self.draw.parent().addClass('eflex-checkmark');
                        // hide original input type
                        self.draw.hide();

                        var $svg = $(this.svg);

                        // set aria role based on input type
                        $svg.attr('role', self.draw.attr('type'));

                        // check for aria attribution
                        if (typeof self.draw.data('eflex-aria-labelledby') !== 'undefined') {
                            $svg.attr('aria-labelledby', self.draw.data('eflex-aria-labelledby'));
                        }

                        // insert new svg checkbox
                        $svg.insertAfter(self.draw);

                        self.draw.on('click', function () {
                            self.toggleStatus($(this));
                        });
                    }

                    // add tabulation support
                    self.parent.on('keypress', function (event) {
                        var keycode = (event.keyCode ? event.keyCode : event.which);
                        if (keycode === 13) {
                            $(this).find('[data-eflex="draw"]').trigger('click');
                        }
                    });
                }

            });

            draw(self.$elem, self.options, new $.Deferred());
        };


        // jQuery Eflex Link
        eflex.effects.link = function (self, master, build, error) {

            var link = construct(Object, function (link, options, deferred) {

                this.link = link;
                this.status = false;
                this.eventType = options.eventType || 'click';
                this.disableAfter = link.data('eflex-disable-after') || options.disableAfter || 0;
                this.counter = 0;

                // text
                this.text = link.data('eflex-text') || options.text || 'Changed';

                // text label
                this.textLabel = link.data('eflex-text-label') || options.textLabel || $('[data-code-label]');

                // css classes
                this.classes = link.data('eflex-classes') || options.classes || 'confirm-button';

                // preserve content
                this.preserveContent = master.calc('setDefault', {
                    setting: link.data('eflex-preserve-content'), default: master.calc('setDefault', {
                        setting: options.preserveContent, default: false
                    }).func
                }).func;

                // swap classes
                this.swapClasses = master.calc('setDefault', {
                    setting: link.data('eflex-swap-classes'), default: master.calc('setDefault', {
                        setting: options.swapClasses, default: true
                    }).func
                }).func;

                // toggle state
                this.toggle = master.calc('setDefault', {
                    setting: link.data('eflex-toggle'), default: master.calc('setDefault', {
                        setting: options.toggle, default: true
                    }).func
                }).func;

                this.originalText = link.text();
                this.originalClasses = link.attr('class');

                this.onInit = options.onInit || function () { };
                this.onBefore = options.onBefore || function () { };
                this.onAfter = options.onAfter || function () { };

                this.deferred = deferred;
                this.init();

            }, {

                add: function (_this) {
                    // get link object
                    var self = _this || this;
                    var links = [];
                    links.push(self.link);

                    if (self.additionalLinks != null) {
                        links = links.concat(self.additionalLinks);
                    }
                    links.forEach(function (l) {
                        if (self.swapClasses) {
                            l.removeClass();
                        }

                        l.addClass(self.classes);

                        if (!self.preserveContent) {
                            l.html(self.text);
                        } else {
                            l.find(self.textLabel).html(self.text);
                        }

                        if (self.disableAfter > 0) {
                            if (self.counter === self.disableAfter) {
                                l.css({ 'pointer-events': 'none', 'cursor': 'default' });
                            } else {
                                l.css({ 'pointer-events': 'all', 'cursor': 'pointer' });
                            }
                        }
                    });
                    self.status = true;
                },

                update: function (_this, selector) {
                    // get link object
                    var self = _this || this;
                    var links = [];
                    links.push(self.link);

                    if (self.additionalLinks != null) {
                        links = links.concat(self.additionalLinks);
                    }
                    links.forEach(function (l) {
                        if (!self.status) {
                            if (!self.preserveContent) {
                                l.html('Updating...');
                            } else {
                                l.find(self.textLabel).html('Updating...');
                            }
                            setTimeout(function () {
                                if (!self.status) {
                                    _eflex.link.methods.add(self);
                                }
                            }, 500);
                        }
                        else {
                            if (!self.preserveContent) {
                                l.html('Updating...');
                            } else {
                                l.find(self.textLabel).html('Updating...');
                            }
                            setTimeout(function () {
                                if (self.status) {
                                    if (!self.preserveContent) {
                                        l.html(self.text);
                                    } else {
                                        l.find(self.textLabel).html(self.text);
                                    }
                                }
                            }, 500);

                        }
                    });
                },

                remove: function (_this) {
                    // get link object
                    var self = _this || this;
                    var links = [];
                    links.push(self.link);

                    if (self.additionalLinks != null) {
                        links = links.concat(self.additionalLinks);
                    }

                    links.forEach(function (l, idx) {
                        l.removeClass(self.classes);

                        if (self.swapClasses) {
                            l.addClass(self.originalClasses);
                        }

                        if (!self.preserveContent) {
                            l.html(self.originalText);
                        } else {
                            l.find(self.textLabel).html(self.originalText);
                        }

                        if (self.disableAfter > 0) {
                            if (self.counter !== self.disableAfter) {
                                l.css({ 'pointer-events': 'all', 'cursor': 'pointer' });
                                if (idx == links.length) {
                                    self.counter = 0;
                                }
                            } else {
                                l.css({ 'pointer-events': 'all', 'cursor': 'pointer' });
                                if (idx == links.length) {
                                    self.counter = 0;
                                }
                            }
                        }
                    });
                    self.status = false;
                },

                setBefore: function (_this) {
                    // get link object
                    var self = _this || this;

                    master.trigger('callback', {
                        onState: self.onBefore,
                        obj: self
                    });

                    self.link.trigger({
                        type: 'eflex/link/onBefore', self: self
                    });

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                init: function (_this) {
                    // get link object
                    var self = _this || this;

                    master.trigger('callback', {
                        onState: self.onInit,
                        obj: self
                    });

                    self.link.trigger({
                        type: 'eflex/link/onInit', self: self
                    });

                    self.link.on('click', function () {
                        self.setBefore().done(function () {

							
                                master.trigger('callback', {
                                    onState: self.onAfter,
                                    obj: self
                                });

                                self.link.trigger({
                                    type: 'eflex/link/onAfter', self: self
                                });

                            });

                        });
                }

            });

            link(self.$elem, self.options, new $.Deferred());

        };


		
		

		/* @Slider
		* --------------------------------------------------------------------- *

			@desc : creates the slider effect
			@params : accepts the effect, config and action objects
			@demo :

				@Shorthand
				$('.js-eflex--slider').eflex( 'slider' );

				@Longhand
				$('.js-eflex--slider').eflex({
					type: 'slider',
					sliderType: 'carousel',
					nav: $('.js-eflex--slider__nav'),
					navType: 'button',
					navLabel: 'next',
					paginate: $('.js-eflex--slider__paginav'),
					paginateType: 'li',
					htmlWrapper: 'div',
					cssWrapper: 'slider-wrapper',
					animationType: 'revert',
					duration: 500,
					easing: 'swing',
					eventType: 'click',
					auto: false,
					onBefore: function ( self, currentIndex ) {
						console.log( self );
					},
					onAfter : function ( self, oldIndex ) {
						console.log( self );
					}
				});

		* --------------------------------------------------------------------- */
        eflex.effects.slider = function (self, master, build, error) {

            var slider = construct(Object, function (slider, options, deferred) {

                // set element
                this.slider = slider;
                this.slides = this.slider.children();
                this.allSlides = this.slides.length;

                // set indexes
                this.currentIndex = 0;
                this.preIndex = this.allSlides;
                this.postIndex = 1;
                this.startArrayAt = 0;

                // set slider type
                this.sliderType = slider.data('eflex-slider-type') || options.sliderType || 'revert';
                // set settings object for slider type
                this.settings = {};
                this.settings[this.sliderType] = {};

                // set active slide
                this.activeSlideItem = 'data-js-eflex-active-item';
                this.activeClass = options.activeClass || 'is-selected';

                // set timer
                this.timer = undefined;
                this.play = true;

                // set axis and direction
                this.axis = slider.data('eflex-axis') || options.axis || 'horizontal';
                this.direction = slider.data('eflex-direction') || options.direction;
                // validate direction belongs to correct axis
                if (this.axis === 'vertical') {
                    if (this.direction === 'left' || this.direction === 'right') {
                        this.direction = 'top';
                    }
                } else {
                    if (this.direction === 'top' || this.direction === 'bottom' || this.direction === undefined) {
                        this.direction = 'left';
                    }
                }

                // check if browser supports 3d transforms
                var support3d = master.search('style', {
                    prop: 'transform',
                    value: 'translate3d(0px, 0px, 0px)',
                    prefix: true
                }).func;

                if (support3d.value !== false) {
                    // set animation style (jQuery or CSS3)
                    this.animationType = slider.data('eflex-animation-type') || options.animationType || 'jQuery';
                } else {
                    this.animationType = 'jQuery';
                }

                // effect config
                this.duration = slider.data('eflex-duration') || options.duration || 600;
                this.delay = slider.data('eflex-delay') || options.delay || 3000;
                this.easing = master.calc('easing', {
                    easing: slider.data('eflex-easing') || options.easing, animationType: this.animationType
                }).func || 'linear';

                // event handler
                this.eventType = slider.data('eflex-event-type') || options.eventType || 'click';

                // auto play
                this.auto = master.calc('setDefault', {
                    setting: slider.data('eflex-auto'), default: master.calc('setDefault', {
                        setting: options.auto, default: true
                    }).func
                }).func;

                // pause on hover
                this.pauseOnHover = master.calc('setDefault', {
                    setting: slider.data('eflex-pause-on-hover'), default: master.calc('setDefault', {
                        setting: options.pauseOnHover, default: false
                    }).func
                }).func;

                // pause on scroll
                this.pauseOnScroll = master.calc('setDefault', {
                    setting: slider.data('eflex-pause-on-scroll'), default: master.calc('setDefault', {
                        setting: options.pauseOnScroll, default: false
                    }).func
                }).func;

                // pause on inactive window
                this.pauseOnInActiveWindow = master.calc('setDefault', {
                    setting: slider.data('eflex-pause-on-inactive-window'), default: master.calc('setDefault', {
                        setting: options.pauseOnInActiveWindow, default: false
                    }).func
                }).func;

                // responsive mode
                this.responsive = master.calc('setDefault', {
                    setting: slider.data('eflex-responsive'), default: master.calc('setDefault', {
                        setting: options.responsive, default: true
                    }).func
                }).func;

                // scale by element
                if (this.responsive) {
                    this.scaleByElement = $(slider.data('eflex-scale-by')) || options.scaleByElement || this.slider.parent();
                    if (this.scaleByElement.length === 0 || this.scaleByElement.selector === 'parent') {
                        this.scaleByElement = this.slider.parent();
                    }

                    // check if slider is in a link tag
                    if (this.slider.closest('a').length > 0) {
                        if (this.slider.closest('a').css('display') !== 'block') {
                            this.slider.closest('a').addClass('js-eflex-fade-protector block');
                        }

                        // otherwise, check if slider's parent is a block level element
                    } else if (this.slider.parent().css('display') !== 'block') {
                        this.slider.wrap($('<div />', {
                            class: 'js-eflex-fade-protector block'
                        }));
                    }
                } else {
                    this.scaleByElement = this.slider;
                }

                // await mode
                this.await = slider.data('eflex-await') || options.await || false;

                // swipe gesture mode
                this.swipe = master.calc('setDefault', {
                    setting: slider.data('eflex-swipe'), default: master.calc('setDefault', {
                        setting: options.swipe, default: false
                    }).func
                }).func;

                // css media queries
                this.cssMediaQueries = master.calc('setDefault', {
                    setting: slider.data('eflex-css-media-queries'), default: master.calc('setDefault', {
                        setting: options.cssMediaQueries, default: false
                    }).func
                }).func;

                // nav
                this.nav = master.calc('setDefault', {
                    setting: slider.data('eflex-nav'), default: master.calc('setDefault', {
                        setting: options.nav, default: true
                    }).func
                }).func;

                this.navType = slider.data('eflex-nav-type') || options.navType || 'button';
                this.navLabel = slider.data('eflex-nav-label') || options.navLabel || 'next';
                this.navCurrentElement = undefined;

                // paginate
                this.paginate = master.calc('setDefault', {
                    setting: slider.data('eflex-paginate'), default: master.calc('setDefault', {
                        setting: options.paginate, default: true
                    }).func
                }).func;

                this.paginateType = slider.data('eflex-paginate-type') || options.paginateType || 'li';
                this.paginateCurrentElement = undefined;

                // video support
                this.mediaMode = master.calc('setDefault', {
                    setting: slider.data('eflex-media-mode'), default: master.calc('setDefault', {
                        setting: options.mediaMode, default: true
                    }).func
                }).func;

                // wrappers
                this.htmlWrapper = slider.data('eflex-html-wrapper') || options.htmlWrapper || 'div';
                // NOTE: cssWrapper currently serves no purpose since the wrapper is within the slider
                this.cssWrapper = slider.data('eflex-css-wrapper') || options.cssWrapper || 'slider-inner';
                this.slider.wrapInner($(
                    document.createElement(this.htmlWrapper)
                ));
                this.sliderInner = this.slider.children();
                this.sliderOuter = this.slider.parent();

                // namespaces
                this.classname = options.classname || undefined;
                this.navSuffix = options.navSuffix || '--nav';

                // utility accessors
                this.options = options;
                this.deferred = deferred;

                // callbacks
                this.onInit = options.onInit || function () { };
                this.onBefore = options.onBefore || function () { };
                this.onAfter = options.onAfter || function () { };

                this.get = {

                    reversePos: function (_this, dir) {
                        var self = _this || this;
                        var val = 0;

                        switch (dir) {
                            case 'width':
                            default:
                                // update slide positions based on current width of slider
                                for (var j = 0, i = self.allSlides - 1; i >= 0; i--, j++) {
                                    if (i === self.currentIndex) {
                                        val = -(self.itemsWidth[self.currentIndex]) * j;
                                    }
                                }
                                break;
                            case 'height':
                                // update slide positions based on current width of slider
                                for (var j = 0, i = self.allSlides - 1; i >= 0; i--, j++) {
                                    if (i === self.currentIndex) {
                                        for (var x = 1; x <= j; x++) {
                                            val += -(self.itemsHeight[x]);
                                        }
                                    }
                                }
                                break;
                        }

                        return val;
                    },

                    // set position value
                    pos: function (_this, init) {
                        var self = _this || this;
                        // set sum value
                        var sum = init || 0;
                        // add current position based on the height array
                        for (var i = 0; i < self.currentIndex; i++) {
                            sum += self.itemsHeight[i + self.startArrayAt];
                        }

                        return sum;
                    }

                };

                // initializer
                // if await mode is enabled
                if (this.await) {
                    var self = this;
                    (function () {
                        // set check to fire initializer
                        var i = 0;

                        try {
                            // when await action occurs
                            $(window).on(self.await, function () {
                                // check if a fire hasn't occurred
                                if (i === 0) {
                                    // initialize the slider
                                    self.init();
                                    // set check to prevent refire
                                    i = 1;
                                }
                            });
                        } catch (e) {
                            console.log(e.message);
                        }
                    })();
                    // otherwise
                } else {
                    // initialize the slider
                    this.init();
                }

            }, {

                // create new object
                style: construct(master.style, function (_this, options) {

                    // invoke css method
                    this.css(_this, options);

                }, {

                    css: function (_this, options) {
                        // cache slider object
                        var self = _this;

                        // apply class name to slider for access
                        this.classname({
                            el: _this.slider,
                            options: options,
                            callback: function (slider, classname) {
                                self.classname = classname;
                            }
                        });
                    }

                }),

                // This method collects slide width and height values in an array, then builds the slides
                cycle: function (_this, init) {
                    // cache slider object
                    var self = _this || this;
                    // set up array to collect item widths
                    self.itemsWidth = self.itemsWidth || [];
                    // set up array to collect item heights
                    self.itemsHeight = self.itemsHeight || [];
                    // set up condition to see if widths are equal
                    self.isSameWidth = null;
                    // set up condition to see if heights are equal
                    self.isSameHeight = null;
                    // set up to add total width sum
                    self.sumWidth = 0;
                    // set up to add total height sum
                    self.sumHeight = 0;

                    // set slider type attribute
                    self.slider.attr({
                        'data-js-eflex': self.options.type
                    }).addClass('animate');

                    // set slider inner type attributes
                    self.sliderInner.attr({
                        'data-js-eflex-container': self.options.type,
                        'data-js-eflex-type': self.sliderType,
                        'data-js-eflex-axis': self.axis
                    });

                    // cycle through all slides
                    self.slides.each(function (index, value) {
                        // cache current slide
                        var $slide = $(value);

                        // assign a numeric id to the slide
                        $slide.attr({ 'data-js-eflex-item': index });
                    });

                    // cycle through all slides
                    self.slides.each(function (index, value) {
                        // cache current slide
                        var $slide = $(value);

                        if (init) {
                            // check if slide is absolute positioned
                            if ($slide.css('position') === 'absolute') {
                                // set to relative in order to get accurate measurements
                                $slide.css({ 'position': 'relative' });
                            }
                        }

                        // check if slide width returns 0
                        if ($slide.width() === 0) {
                            // get width from outer container
                            $slide.width(self.sliderOuter.width());
                        }

                        // check if slide height returns 0
                        if ($slide.height() === 0) {
                            // check if slider height returns 0
                            if (self.slider.height() === 0) {
                                // get height from outer container
                                $slide.height(self.sliderOuter.height());
                                // check if slider has min-height property
                            } else if (self.slider.css('min-height') !== 'none') {
                                // get height from slider's min-height
                                $slide.height(self.slider.css('min-height'));
                            } else {
                                // get height from slider
                                $slide.height(self.slider.height());
                            }
                        }

                        if (init) {
                            // add width to array
                            self.itemsWidth.push(self.slider.width());
                            // add height to array
                            self.itemsHeight.push($slide.height());
                        }
                    });

                    // check if widths are equal
                    self.isSameWidth = master.search('isSame', self.itemsWidth).func;

                    // if they are not the same
                    if (!self.isSameWidth) {
                        // set first index equal to the max width
                        self.itemsWidth[0] = master.search('maxLength', {
                            items: self.slides,
                            length: 'outerWidth'
                        }).func;
                    }

                    self.maxHeight = master.search('maxLength', {
                        items: self.slides,
                        length: 'outerHeight'
                    }).func;

                    // cycle through all slides
                    self.slides.each(function (index, value) {
                        // cache current slide
                        var $slide = $(value);

                        if (init) {
                            // apply width to slide and order by layer
                            $slide.css({
                                'width': self.itemsWidth[index], 'height': self.itemsHeight[index], 'z-index': self.allSlides - index
                            });
                        }

                        // add width to the sum
                        self.sumWidth += self.itemsWidth[index];
                        // add height to the sum
                        self.sumHeight += self.itemsHeight[index];
                    });

                    // check if using carousel or revert slider
                    if (self.sliderType === 'carousel' || self.sliderType === 'revert') {
                        if (self.axis === 'vertical') {
                            // apply sum to the slider and wrap it in a container
                            self.sliderInner.css({ 'width': self.itemsWidth[0], 'height': self.sumHeight });
                        } else {
                            // apply sum to the slider and wrap it in a container
                            self.sliderInner.css({ 'width': self.sumWidth, 'height': self.itemsHeight[0] });
                        }
                    } else {
                        // apply sum to the slider and wrap it in a container
                        self.sliderInner.css({ 'width': self.sumWidth, 'height': self.itemsHeight[self.currentIndex] });
                    }

                },

                destroy: function (_this) {
                    // get slider object
                    var self = _this || this;

                    try {
                        // remove all attributes and classes from the slider
                        self.slider.removeAttr('data-js-eflex').removeAttr('style');
                        // remove all attriubtes and classes from all slides
                        self.slides.each(function (index, value) {
                            $(value).removeAttr('data-js-eflex-item').removeAttr('style').removeAttr('data-js-eflex-active-item');
                            $(value).appendTo(self.slider);
                        });
                        // remove the inner wrapper
                        self.slider.find('[data-js-eflex-container]').remove();
                        // remove navigation
                        self.slider.siblings('[data-js-eflex-nav]').remove();
                        self.slider.siblings('[data-js-eflex-paginate]').remove();
                    } catch (e) {
                        console.log(e.message);
                    }

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method sets up the slides based on the slider type
                setSlides: function (args) {
                    // get slider object
                    var self = args.self || this;
                    // set init
                    var init = typeof args.init !== 'undefined' ? args.init ? true : false : false;

                    // get or set width coordinates
                    args.width = args.width || self.slides.outerWidth(true);
                    // get or set height coordinates
                    args.height = args.height || self.slides.outerHeight(true);
                    // set reversable width and height object
                    args.reverse = args.reverse || {};
                    // set reversable width
                    args.reverse.width = args.reverse.width || self.get.reversePos(self);
                    // set reverable height
                    args.reverse.height = args.reverse.height || self.get.pos(self, -(self.sumHeight - self.itemsHeight[0]));

                    // reverse the order of each slide (ex: CBA instead of ABC)
                    args.reverse.slides = function () {
                        self.slides.each(function (i, slide) {
                            self.sliderInner.prepend(slide);
                        });
                    };

                    // recycle slider sizes
                    self.cycle(self, false);

                    // check slider type
                    switch (self.sliderType) {
                        case 'carousel':
                            if (init) {
                                // set slides to absolute so they stack on top of each other
                                self.slides.css({ 'position': 'absolute', 'opacity': 1 });
                                // set the first slide as active slide
                                self.slides.eq(self.currentIndex).attr(self.activeSlideItem, 'true');
                            }

                            // check animation type
                            switch (self.animationType) {
                                case 'jQuery':
                                    if (init) {
                                        if (self.axis === 'vertical') {
                                            //args.height = self.direction === 'top' ? -args.height : args.height;
                                            args.height = self.itemsHeight[self.currentIndex + 1];
                                            // update top value to match new slide height
                                            self.slides.css({ 'top': args.height }).eq(self.currentIndex).css({ 'top': 0 });
                                        } else {
                                            args.width = self.direction === 'right' ? args.width : -args.width;
                                            // update left value to match new slide width
                                            self.slides.css({ 'left': args.width }).eq(self.currentIndex).css({ 'left': 0 });
                                        }
                                    }
                                    break;
                                case 'CSS3':
                                    // update translate X value to match new slide width
                                    self.slides.css({
                                        'transform': 'translate3d(' + -args.width + 'px, 0, 0)',
                                        'transition': 'none'
                                    }).eq(self.currentIndex).css({ 'transform': 'translate3d(0, 0, 0)' });
                                    break;
                            }
                            break;

                        // set init values for the revert slider
                        case 'revert':
                            // check axis
                            if (init) {
                                // set slides to absolute so they stack on top of each other
                                self.slides.css({ 'opacity': 1 });

                                switch (self.axis) {
                                    case 'vertical':
                                        if (self.direction === 'bottom') {
                                            // reverse slide order
                                            args.reverse.slides();
                                            // set array indexer at 1
                                            self.startArrayAt = 1;
                                            // CSS3
                                            if (self.animationType === 'CSS3') {
                                                // update translate Y value to match new slide width
                                                self.sliderInner.css({ 'transform': 'translate3d(0, ' + args.reverse.height + 'px, 0)', 'transition': 'none' });
                                                // jQuery
                                            } else {
                                                // update top value to match new slide width
                                                self.sliderInner.css({ 'top': args.reverse.height });
                                            }
                                        }
                                        break;
                                    case 'horizontal':
                                        // if using right direction
                                        if (self.direction === 'right') {
                                            // reverse slide order
                                            args.reverse.slides();
                                            // CSS3
                                            if (self.animationType === 'CSS3') {
                                                // update translate X value to match new slide width
                                                self.sliderInner.css({ 'transform': 'translate3d(' + args.reverse.width + 'px, 0, 0)', 'transition': 'none' });
                                                // jQuery
                                            } else {
                                                // set left position back so 1st slide is in view
                                                self.sliderInner.css({ 'left': args.reverse.width });
                                            }
                                            // if using left direction
                                        } else {
                                            // CSS3
                                            if (self.animationType === 'CSS3') {
                                                // update translate X value to match new slide width
                                                self.sliderInner.css({ 'transform': 'translate3d(' + -(self.currentIndex * args.width) + 'px, 0, 0)', 'transition': 'none' });
                                                // jQuery
                                            } else {
                                                // update left value to match new slide width
                                                self.sliderInner.css({ 'left': -(self.currentIndex * args.width) });
                                            }
                                        }
                                        break;
                                }
                            }
                            break;

                        // set init values for the fader
                        case 'fade':
                            if (init) {
                                // set slides to absolute so they stack on top, equalize z-index and set opacity to 0%
                                self.slides.css({ 'position': 'relative', 'z-index': 1, 'opacity': 0 });
                                // set first slide as active slide, raise z-index to top and set opacity to 100%
                                self.slides.eq(self.currentIndex).attr(self.activeSlideItem, 'true').css({ 'z-index': 2, 'opacity': 1 });
                            }

                            // check animation type
                            switch (self.animationType) {
                                case 'jQuery':
                                    // update left value to match new slide width multiplied by current index
                                    self.slides.each(function (index, value) {
                                        $(value).css({ 'left': -(index * args.width) });
                                    });
                                    break;
                                case 'CSS3':
                                    // update translate X value to match new slide width multiplied by current index
                                    self.slides.each(function (index, value) {
                                        $(value).css({ 'transform': 'translate3d(' + -(index * args.width) + 'px, 0, 0)' });
                                    });
                                    break;
                            }
                            break;
                    }

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method prepares the callback function to run
                setCallback: function (_this, status) {
                    // cache slider object
                    var self = _this || this;

                    // check if media is supported
                    if (self.mediaMode) {
                        // detect video on current slider
                        self.media.HTML5.onCurrentVideo(self);
                    }

                    // update post index value
                    self.postIndex = master.search('pos', {
                        obj: { currentIndex: self.currentIndex },
                        sum: self.allSlides,
                        dir: function () {
                            return typeof (self.nav) !== 'boolean'
                                ? self.nav.find(self.navCurrentElement).data('dir')
                                : 'next';
                        },
                        label: self.navLabel
                    }).func;

                    // trigger on before callback function
                    master.trigger('callback', {
                        onState: self[status] || self.onInit,
                        obj: self
                    });

                    // trigger eflex slider event
                    master.trigger('event', {
                        name: status + 'EflexSlider',
                        data: {
                            detail: { eflex: self, master: master }
                        }
                    });

                    // trigger jQuery version of eflex slider event
                    self.slider.trigger({
                        type: 'eflex/slider/' + status,
                        self: self
                    });

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method controls the playback of the slider
                playback: function (control, _this) {
                    // cache slider object
                    var self = _this || this;
                    // get current slide id
                    var cacheIndex = self.currentIndex;

                    // set timer
                    master.calc('timer', {
                        self: self,
                        status: control,
                        delay: self.delay,
                        onTrue: function () {

                            // set on before state
                            self.setCallback(self, 'onBefore').done(function () {
                                // check if slider is active
                                if (self.play === true && self.slider.is(':visible')) {
                                    // set transition and on complete, set on after state
                                    self.ready(self, self.currentIndex, self.navLabel).done(function () {
                                        self.setCallback(self, 'onAfter');
                                    });
                                }
                            });
                        },
                        onFalse: function () { }
                    });

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;

                },

                // This method refreshes the slider
                refresh: function (_this, dir) {
                    // cache slider object
                    var self = _this || this;

                    // pause slider
                    self.playback(false).done(function () {
                        if (self.play === true) {
                            // ready
                            self.ready(self, self.currentIndex, dir).done(function () {
                                // resume slider
                                self.playback(self.auto);
                            });
                        }
                    });

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method updates the size of the slider before transit
                updateSliderSize: function (_this) {
                    // cache slider object
                    var self = _this || this,
                        // get current slide
                        current = self.slides.eq(self.currentIndex);

                    // check if slider is visible in the DOM
                    if (self.slider.is(':visible')) {
                        // update each width based on new width
                        self.itemsWidth[self.currentIndex] = self.slider.width();

                        //console.log('update', self.slider.width());

                        // check if slide contains multiple html tags
                        if (current.children().length > 1) {
                            // update each height based on new height
                            self.itemsHeight[self.currentIndex] = current.outerHeight(true);
                        } else {
                            // update each height based on new height
                            self.itemsHeight[self.currentIndex] = current.children().outerHeight(true);
                        }

                    }

                    // update slider to new height
                    master.search('cycle', {
                        obj: { a: self.slider, b: self.sliderInner, c: current },
                        callback: function (index, value) {
                            value.height(self.itemsHeight[self.currentIndex]);
                        }
                    });

                    // update each slide width to match slider width
                    self.slides.width(self.slider.width());

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method updates the pagination menu with the current styling class
                updatePaginate: function (_this) {
                    // set cached object or inherit object
                    var self = _this || this;

                    if (self.paginate !== false) {
                        // remove active class from all element
                        self.paginate.find(self.paginateType).removeClass(self.activeClass);
                        // update active class to current element
                        self.paginate.find(self.paginateType).eq(self.currentIndex).addClass(self.activeClass);
                    }

                    if (self.nav !== false) {
                        // remove active class from all element
                        self.nav.find(self.navType).removeClass(self.activeClass);
                        // update active class to current element
                        self.nav.find(self.navCurrentElement).addClass(self.activeClass);
                    }
                },

                // This method handles any images that are set to lazy load
                lazyLoad: function (_this, args) {
                    // get slider object
                    var self = _this || this;
                    // get args
                    args = args || {};
                    // get current slide
                    var $slide = args.slide || self.slides.eq(self.currentIndex);
                    // search for lazy attribute
                    var $lazy = $slide.find('[data-src]');
                    // set image finder
                    var imgsFound = 0;

                    // iterate each image
                    $lazy.each(function (item, img) {
                        var $img = $(img);

                        // check if element is an image tag
                        if (img.nodeName === 'IMG') {
                            // check if src attribute doesn't match lazy attribute
                            if ($img.attr('src') !== $img.data('src')) {
                                // replace src attribute with lazy attribute
                                $img.attr('src', $img.data('src'));
                                imgsFound++;
                            }
                            // otherwise element is not image so must be placeholder container
                        } else {
                            // generate dynamic image node
                            var $getImg = $('<img />');

                            // cycle the placeholder container
                            $img.each(function () {
                                // get all attributes from the placeholder container
                                $.each(this.attributes, function () {
                                    $getImg.attr(this.name, this.value);
                                });
                            });
                            // set source & alt attributes from data attributes
                            $getImg.attr({
                                src: $img.data('src'), alt: $img.data('alt')
                            });

                            // replace the placeholder container with dynamic image tag
                            $img.replaceWith($getImg);
                            imgsFound++;
                        }
                    });

                    // check if images were set to lazy load
                    if (imgsFound > 0) {
                        $slide.find('[data-src]').on('load', function () {
                            // when image loads, return callback
                            return args.complete(true);
                        });
                    } else {
                        return args.complete(false);
                    }
                },

                // This method retrieves the current index and prepares the slider for transit
                ready: function (_this, index, dir) {
                    // set cached object or inherit object
                    var self = _this || this;

                    // set current index
                    self.currentIndex = index || self.currentIndex;
                    // update pre-index value
                    self.preIndex = self.currentIndex;

                    // get current slide
                    master.search('pos', {
                        obj: self,
                        sum: self.allSlides,
                        dir: dir,
                        label: self.navLabel
                    });

                    // update post-index value
                    self.postIndex = self.currentIndex;

                    // run lazy load
                    self.lazyLoad(self, {
                        complete: function () {
                            self.triggerResize(self, false).done(function () {
                                // run transition based on slider type
                                master.browser('animate', {
                                    self: self,
                                    method: self.sliderType,
                                    args: {
                                        dir: dir,
                                        index: index
                                    }
                                });
                                self.updatePaginate();
                            });
                        }
                    });

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method re-enables the navigation & pagination links
                enableLinks: function (_this) {
                    var self = _this || this;

                    // enable nav link
                    build.dynamic('enableLink', { links: self.nav, linkType: self.navType });
                    // enable paginate link
                    build.dynamic('enableLink', { links: self.paginate, linkType: self.paginateType });
                },

                // This method makes the transit mechanics public based on slider type
                extend: function (exportable) {
                    // cache slider object
                    var self = this,
                        set = self.settings[self.sliderType];

                    // set export status
                    exportable = master.calc('setDefault', { boolean: exportable, default: true }).func;
                    // set extendable to true
                    self.extendable = true;

                    // set init method
                    set.init = function (args) {
                        // set args object
                        args = args || {};
                        // set args dir
                        args.dir = args.dir || self.navLabel;

                        // get active slide id
                        this.activeSlideId = self.slider.find('[' + self.activeSlideItem + ']').data('js-eflex-item');
                        // get target slide id
                        this.targetSlideId = self.slides.eq(self.currentIndex).data('js-eflex-item');
                        // get length of slide
                        this.length = self.axis === 'vertical' ? self.maxHeight : self.itemsWidth[self.currentIndex];
                        // set reference point based on axis
                        this.axis = self.axis === 'vertical' ? 'top' : 'left';
                        // set route based on direction
                        this.route = args.dir === 'next' ? -this.length : this.length;
                        // set route objects
                        this.coords = this.coords || { a: {}, b: {}, c: {}, d: {} };
                        // set position
                        this.pos = {};
                        // set position axis
                        this.pos[this.axis] = 0;
                    };

                    // check slider type
                    switch (self.sliderType) {
                        case 'revert':
                            set.animate = function (options) {
                                switch (self.animationType) {
                                    case 'CSS3':
                                        self.sliderInner.css({
                                            'transition': 'all ' + self.duration + 'ms ' + self.easing,
                                            'transform': 'translate3d(' + (options.x || 0) + 'px, ' + (options.y || 0) + 'px, ' + (options.z || 0) + 'px)'
                                        });
                                        break;
                                    case 'jQuery':
                                    default:
                                        self.sliderInner.animate(options, self.duration, self.easing, function () {
                                            // enable slider controls
                                            self.enableLinks();
                                        });
                                        break;
                                }
                            };

                            set.transitionEnd = function () {
                                // set bind transition event listener
                                self.sliderInner.on('transitionend webkitTransitionEnd oTransitionEnd', function () {
                                    // unbind transition event listener
                                    self.sliderInner.off('transitionend webkitTransitionEnd oTransitionEnd');
                                    // enable slider controls
                                    self.enableLinks();
                                });
                            };
                            break;
                        case 'carousel':
                            // set route method
                            set.setRoutes = function (boolean, args) {
                                args = args || {};
                                coords = args.coords || set.coords;
                                route = args.route || set.route;
                                axis = args.axis || set.axis;
                                master.search('cycle',
                                    {
                                        obj: coords, args: boolean, callback: function (index, value, args, i) {
                                            coords[index][axis] = boolean[i] ? route : -route;
                                        }
                                    });
                                if (args.use) {
                                    set.routeCalled = true;
                                }
                            };

                            // set animate method
                            set.animate = function (options) {
                                // check animation type
                                switch (self.animationType) {
                                    case 'CSS3':
                                        // get active slide item and animate it
                                        self.slider.find('[' + self.activeSlideItem + ']').css({
                                            'transition': 'all ' + self.duration + 'ms ' + self.easing,
                                            'transform': 'translate3d(' + (options.x || 0) + 'px, ' + (options.y || 0) + 'px, ' + (options.z || 0) + 'px)'
                                        });
                                        break;
                                    case 'jQuery':
                                    default:
                                        if (self.axis === 'vertical') {
                                            set.coords.a.left = 0;
                                            set.coords.c.left = 0;
                                        } else {
                                            set.coords.a.top = 0;
                                            set.coords.c.top = 0;
                                        }

                                        // get active slide item and animate it
                                        self.slider.find('[' + self.activeSlideItem + ']').animate(set.coords.a, self.duration, self.easing, function () {
                                            // reset top css property for active slide item
                                            self.slider.find('[' + self.activeSlideItem + ']').css(set.coords.b).removeAttr(self.activeSlideItem);
                                        });

                                        self.slides.eq(self.currentIndex)
                                            .css(set.coords.c)
                                            .animate(set.pos, self.duration, self.easing, function () {
                                                self.slides.eq(self.currentIndex).attr(self.activeSlideItem, 'true');
                                                self.slides.not(':eq(' + self.currentIndex + ')').css(set.coords.d);
                                                // enable slider controls
                                                self.enableLinks();
                                            });
                                        break;
                                }
                            };

                            // set move current slide method (CSS method only)
                            set.moveCurrentSlide = function (options) {
                                self.slides.eq(self.currentIndex).css({
                                    'transition': 'none',
                                    'transform': 'translate3d(' + (options.x || 0) + 'px, ' + (options.y || 0) + 'px, ' + (options.z || 0) + 'px)'
                                });

                                // resolve deferred state and return complete status
                                return master.deferred('promise', self.deferred).func;
                            };

                            // reset slide method
                            set.resetSlide = function () {
                                // weird hack that allows the slide to animate right
                                self.slides.css('transform');
                                // set transition and animate x-axis property ( length of slider *2 - length of slider )
                                self.slides.eq(self.currentIndex).css({
                                    'transition': 'all ' + self.duration + 'ms ' + self.easing,
                                    'transform': 'translate3d(0px, 0px, 0px)'
                                });
                            };

                            // transition method
                            set.transitionEnd = function () {
                                // set bind transition event listener
                                self.slides.on('transitionend oTransitionEnd webkitTransitionEnd', function () {
                                    // unbind transition event listener
                                    self.slides.off('transitionend oTransitionEnd webkitTransitionEnd');
                                    // remove active attribute
                                    self.slider.find('[' + self.activeSlideItem + ']').removeAttr(self.activeSlideItem);
                                    // set active attribute to current slide
                                    self.slides.eq(self.currentIndex).attr(self.activeSlideItem, 'true');
                                    // enable slider controls
                                    self.enableLinks();
                                });
                            };
                            break;
                        case 'fade':
                            set.animate = function (args) {
                                // set opacity of current index to 100%
                                self.slides.eq(self.currentIndex).css({ 'opacity': 1, 'transition': 'none' });

                                switch (self.animationType) {
                                    case 'CSS3':
                                        // find active slide and animate opacity to 0%
                                        self.slider.find('[' + self.activeSlideItem + ']').css({
                                            'transition': 'opacity ' + self.duration + 'ms ' + self.easing,
                                            'opacity': 0
                                        });

                                        // set bind transition event listener
                                        self.slides.on('transitionend oTransitionEnd webkitTransitionEnd', function () {
                                            console.log('transition has ended');
                                            // unbind transition event listener
                                            self.slides.off('transitionend oTransitionEnd webkitTransitionEnd');
                                            // remove active attribute and set z-index back to base level
                                            self.slider.find('[' + self.activeSlideItem + ']').removeAttr(self.activeSlideItem).css({ 'z-index': 1 });
                                            // get current slide, set as active slide and raise z-index to top
                                            self.slides.eq(self.currentIndex).attr(self.activeSlideItem, 'true').css({ 'z-index': 2 });
                                            // enable slider controls
                                            self.enableLinks();
                                        });
                                        break;
                                    case 'jQuery':
                                    default:
                                        // find active slide and animate opacity to 0%
                                        self.slider.find('[' + self.activeSlideItem + ']').animate({
                                            'opacity': 0
                                        }, self.duration, self.easing, function () {
                                            // remove active attribute and set z-index back to base level
                                            self.slider.find('[' + self.activeSlideItem + ']').removeAttr(self.activeSlideItem).css({ 'z-index': 1 });
                                            // get current slide, set as active slide and raise z-index to top
                                            self.slides.eq(self.currentIndex).attr(self.activeSlideItem, 'true').css({ 'z-index': 2 });
                                            // enable slider controls
                                            self.enableLinks();
                                        });
                                        break;
                                }
                            };
                            break;
                    }

                    // check if extend is set to export
                    if (exportable) {
                        set.init();
                        set.override = true;
                    }
                },

                // This method controls the mechanics for revert slider type
                revert: function (_this, args) {
                    // cache slider object
                    var self = _this || this,
                        set = self.settings[self.sliderType];

                    // run init method
                    set.init(args);

                    // if using jQuery animation
                    if (self.animationType === 'jQuery') {
                        if (self.axis === 'vertical') {
                            if (self.direction === 'top') {
                                self.animateValue = -(self.get.pos(self, 0));
                            } else {
                                self.animateValue = self.get.pos(self, -(self.sumHeight - self.itemsHeight[0]));
                            }
                            set.animate({ 'top': self.animateValue });
                        } else {
                            if (self.direction === 'right') {
                                self.animateValue = self.get.reversePos(self);
                            } else {
                                self.animateValue = -(self.currentIndex * self.slides.outerWidth(true));
                            }
                            set.animate({ 'left': self.animateValue });
                        }

                        // if using CSS3 animation
                    } else {
                        if (self.axis === 'vertical') {
                            if (self.direction === 'top') {
                                self.animateValue = -(self.get.pos(self, 0));
                            } else {
                                self.animateValue = self.get.pos(self, -(self.sumHeight - self.itemsHeight[0]));
                            }
                            set.animate({ y: self.animateValue });
                        } else {
                            if (self.direction === 'right') {
                                self.animateValue = self.get.reversePos(self);
                            } else {
                                self.animateValue = -(self.currentIndex * self.slides.outerWidth(true));
                            }
                            set.animate({ x: self.animateValue });
                        }

                        set.transitionEnd();

                    }

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method controls the mechanics for carousel slider type
                carousel: function (_this, args) {
                    // cache slider object
                    var self = _this || this,
                        set = self.settings[self.sliderType];

                    // set direction to next if undefined
                    if (args.dir === undefined) { args.dir = 'next'; }
                    // run init
                    set.init(args);

                    // check if slide id and nav slide id doesn't match
                    if (set.activeSlideId !== set.targetSlideId) {

                        // if using jQuery animation
                        if (self.animationType === 'jQuery') {
                            // check if routes haven't been overridden

                            if (!set.override || set.routeCalled === undefined) {
                                // set routes based on axis
                                self.direction === 'top' || self.direction === 'right'
                                    ? set.setRoutes([false, true, true, false])
                                    : set.setRoutes([true, false, false, false]);
                            }
                            // animate slide
                            set.animate();

                            // if using CSS3 animation
                        } else {
                            // check if routes haven't been overridden
                            if (!set.override || set.routeCalled === undefined) {
                                // set routes based on axis
                                self.direction === 'top' || self.direction === 'right'
                                    ? set.setRoutes([false, true])
                                    : set.setRoutes([true, false]);
                            }

                            if (self.axis === 'vertical') {

                                set.animate({ y: set.coords.a[set.axis] });
                                set.moveCurrentSlide({ y: set.coords.b[set.axis] }).then(set.resetSlide);

                            } else {

                                set.animate({ x: set.coords.a[set.axis] });
                                set.moveCurrentSlide({ x: set.coords.b[set.axis] }).then(set.resetSlide);

                            }

                            set.transitionEnd();

                        }

                    }

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method controls the mechanics for fade slider type
                fade: function (_this, args) {
                    // get slider object
                    var self = _this || this,
                        set = self.settings[self.sliderType];

                    // run init method
                    set.init(args);

                    // check if slide id and nav slide id doesn't match
                    if (set.activeSlideId !== set.targetSlideId) {

                        set.animate(args);

                    }

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method controls the first and last slides position for carousel
                dir: function (dir) {
                    // cache slider object
                    var self = this;

                    // rotate slides based on direction
                    switch (dir) {
                        case 'next':
                            self.slider.children(':first-child').insertAfter(self.slider.children(':last-child'));
                            break;
                        case 'prev':
                            self.slider.children(':last-child').insertBefore(self.slider.children(':first-child'));
                            break;
                    }

                },

                // This method determines if the slider will auto-rotate
                checkIfAutoPlay: function (_this) {
                    // get slider object
                    var self = _this || this;

                    // resume slider
                    self.playback(self.auto);

                    // resolve deferred state and return complete status
                    master.deferred('promise', self.deferred).func;
                },

                triggerResize: function (_this, init) {
                    // get slider object
                    var self = _this || this;
                    // set init
                    init = typeof init !== 'undefined' ? init ? true : false : true;

                    // check if using css media queries
                    if (!self.cssMediaQueries) {
                        // set max-width equal to original width of slider
                        self.slider.css({ 'width': '100%', 'max-width': Math.ceil(self.scaleByElement.width()) });
                    }

                    self.updateSliderSize().done(function () {
                        self.setSlides({
                            init: init,
                            width: self.slider.width(),
                            height: self.slider.height()
                        });
                    });

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                // This method handles making the slider adaptable in an responsive design
                isResponsive: function (_this) {
                    // get slider object
                    var self = _this || this;

                    // check if slider is responsive
                    if (self.responsive) {
                        // set timer
                        var timer;

                        var triggerTimer = function () {
                            // stop timer
                            clearTimeout(timer);

                            // set timer to resume after duration completes
                            timer = setTimeout(function () {
                                self.playback(self.auto);
                            }, self.delay);

                            // pause slider and resize it
                            self.playback(false).done(function () {
                                if (self.slider.is(':visible')) {
                                    refireResizeMethod(3, true);
                                }
                            });
                        };

                        var refireResizeMethod = function (x, status) {
                            var x = x || 1, i = 0;
                            var execute = function (i) {
                                setTimeout(function () {
                                    self.triggerResize(self, status);
                                    if (i < x) {
                                        i = i + 1;
                                        execute(i);
                                    }
                                }, 100);
                            };
                            execute(i);
                        };

                        // if window is resized, pause the animation
                        $(window).resize(triggerTimer);
                        $(window).on('orientationchange', function () {
                            refireResizeMethod(3, false);
                        });
                    }

                    // check if using css media queries
                    if (!self.cssMediaQueries) {
                        // set max-width equal to original width of slider
                        self.slider.css({ 'width': '100%', 'max-width': self.itemsWidth[0] });
                    }

                },

                // This method handles pause/play based whether the window is inactive
                isInActiveWindow: function (_this) {
                    // get slider object
                    var self = _this || this;
                    // set timer
                    self.activeWindowTimer = null;

                    self.API.pauseRotation = function (self) {
                        // stop timer
                        clearTimeout(self.activeWindowTimer);
                        // pause slider
                        self.playback(false).done(function () {
                            try {
                                // get inactive feedback
                                throw error.fetch('log', 'isInactive').func;
                            }
                            catch (e) {
                                // push feedback out to user
                                error.send('message', e);
                            }
                        });
                    };

                    self.API.playRotation = function (self) {
                        // set timer to resume after first delay
                        self.activeWindowTimer = setTimeout(function () {
                            try {
                                // get active feedback
                                throw error.fetch('log', 'isActive').func;
                            }
                            catch (e) {
                                // push feedback out to user
                                error.send('message', e);
                            }
                            finally {
                                // resume the slider
                                self.playback(self.auto);
                            }
                        }, self.delay);
                    };

                    // if tab is inactive
                    $(window).blur(function () {
                        self.API.pauseRotation(self);
                    });

                    // if tab is active
                    $(window).focus(function () {
                        self.API.playRotation(self);
                    });

                },

                // This method handles pause/play based whether the window is scrolling
                isScrolling: function (_this) {
                    // get slider object
                    var self = _this || this;
                    // set timer
                    var timer;

                    // if window is scrolled, pause the animation
                    $(window).scroll(function () {
                        // stop timer
                        clearTimeout(timer);

                        // set timer to resume after duration completes
                        timer = setTimeout(function () {
                            self.playback(self.auto);
                        }, self.delay);

                        // pause slider
                        self.playback(false);
                    });
                },

                // This method handles video support
                supportMedia: function (_this) {
                    // get slider object
                    var self = _this || this;

                    self.media = {

                        // Methods for YouTube video support
                        YT: {

                            video: function (_this) {
                                // get YouTube object
                                var _yt = _dtm.getYouTube();

                                // get slider object
                                var self = _this || this;
                                // get all YT iframes from slider
                                var videos = self.slider.find('iframe[src*="' + _yt.config.verify + '"]');

                                // check if videos exist
                                if (videos.length > 0) {
                                    // set array to store each new YT player
                                    self.media.YT.player = [];
                                }

                                // run limit to control instant refresh
                                var run = 0;

                                // private method that pauses all videos in a slider
                                var updateVideo = function () {
                                    // get all player objects
                                    $.each(self.media.YT.player, function (index, value) {
                                        // pause
                                        value.pauseVideo();
                                    });

                                    // resume slider
                                    self.play = true;

                                    // check if the element is either prev or next
                                    if ($(this).find('[data-dir]').length > 0 && run === 1) {
                                        // instant refresh the slider
                                        self.refresh(self, self.navCurrentElement.data('dir'));
                                        // reset run limit
                                        // otherwise, element is paginated
                                    } else if ($(this).find('[data-dir]').length === 0 && run === 1) {
                                        self.refresh(self, undefined);
                                    }
                                    run = 0;

                                };

                                $('html').on('dtm/youtube', function (yt) {
                                    // iterate each YT video
                                    videos.each(function (index, video) {
                                        yt.api[$(video).attr('id')].b.b.events.onReady = function (event) {
                                            self.slider.trigger('eflex/onYouTubeReady');
                                        };

                                        yt.api[$(video).attr('id')].b.b.events.onReady({
                                            target: yt.api[$(video).attr('id')],
                                            data: null
                                        });

                                        // re-assign the YT API back to the media player object
                                        self.media.YT.player[index] = yt.api[$(video).attr('id')];
                                    });
                                });

                                $('html').on('dtm/youtube/play', function (yt) {
                                    videos.each(function (index, video) {
                                        // get youtube video from slider and check if it is playing
                                        if (yt.api.data === 1 && $(yt.api.target.a).attr('id') === $(video).attr('id')) {
                                            // trigger custom eflex youtube event
                                            self.slider.trigger('eflex/onYouTubePlay');
                                            // pause slider state
                                            self.play = false;
                                            run = 1;
                                        }
                                    });
                                });

                                $('html').on('dtm/youtube/pause', function (yt) {
                                    videos.each(function (index, video) {
                                        // get youtube video from slider and check if it is paused
                                        if (yt.api.data === 2 && $(yt.api.target.a).attr('id') === $(video).attr('id')) {
                                            // trigger custom eflex youtube event
                                            self.slider.trigger('eflex/onYouTubePause');
                                            // resume slider state
                                            self.play = true;
                                        }
                                    });
                                });

                                $('html').on('dtm/youtube/end', function (yt) {
                                    videos.each(function (index, video) {
                                        // get youtube video from slider and check if it has ended
                                        if (yt.api.data === 0 && $(yt.api.target.a).attr('id') === $(video).attr('id')) {
                                            // trigger custom eflex youtube event
                                            self.slider.trigger('eflex/onYouTubeEnd');
                                            // resume slider state
                                            self.play = true;
                                            // update to the next slide
                                            self.refresh(self, 'next');
                                        }
                                    });
                                });
                            }

                        },

                        // Methods for standard HTML5 video support
                        HTML5: {

                            setRemote: function (_this) {
                                // get slider object
                                var self = _this || this;
                                // run limit to control instant refresh
                                var run = 0;

                                // private method that pauses all videos in a slider
                                var updateVideo = function () {

                                    // check if video is playing
                                    if (self.slider.find('video').length > 0) {
                                        // get all videos
                                        self.slider.find('video').each(function (index, value) {
                                            // pause
                                            value.pause();
                                        });
                                        // resume slider
                                        self.play = true;

                                        // check if the element is either prev or next
                                        if ($(this).find('[data-dir]').length > 0 && run === 1) {
                                            // instant refresh the slider
                                            self.refresh(self, self.navCurrentElement.data('dir'));
                                            // reset run limit
                                        }
                                        run = 0;
                                    }
                                };

                                // get each video in slider
                                self.slider.find('video').each(function () {
                                    // set run limit when video plays
                                    this.addEventListener('playing', function () { run = 1; });
                                });
                                self.slider.find('video').on('pause', updateVideo);

                                if (self.paginate !== false) {
                                    self.paginate.on('click', updateVideo);
                                }

                                if (self.nav !== false) {
                                    self.nav.on('click', updateVideo);
                                }

                            },

                            onCurrentVideo: function (_this) {
                                // get slider object
                                var self = _this || this;

                                // get current slide and check for video
                                var video = self.slides.eq(self.currentIndex).find('video');

                                // check if video is playing
                                if (video.length > 0 && !(video.get(0).paused)) {
                                    // pause slider
                                    self.play = false;
                                    // check when video finishes
                                    video.off().on('ended', function () {
                                        // resume slider
                                        self.play = true;
                                        self.refresh(self, 'next');
                                    });
                                }

                            },

                            video: function (_this) {
                                // get slider object
                                var self = _this || this;

                                // detect current video
                                self.media.HTML5.onCurrentVideo(self);
                                // set up remote
                                self.media.HTML5.setRemote(self);
                            }

                        }

                    };

                },

                setTouch: function () {
                    // get slider object
                    var self = this;
                    // set touch object
                    self.touch = {};
                    window.slider = {};
                    // set no equation property
                    self.touch.noEquation = false;

                    self.sliderInner.on('touchstart', function (event) {
                        // Test for flick
                        self.touch.longTouch = false;
                        // pause slider
                        self.playback(false);

                        setTimeout(function () {
                            window.slider.longTouch = true;
                        }, 250);

                        // Get the original touch position.
                        self.touch.touchstartx = event.originalEvent.touches[0].pageX;
                    });

                    self.sliderInner.on('touchmove', function (event) {
                        if (self.play) {
                            // Update touch position
                            self.touch.touchmovex = event.originalEvent.touches[0].pageX;
                            // Zero out multiplier
                            self.touch.multiplier = self.sliderType === 'revert' ? self.currentIndex : 0;
                            // Calcuate distance to translate slider inner
                            self.touch.movex = self.touch.multiplier * self.itemsWidth[self.currentIndex] + (self.touch.touchstartx - self.touch.touchmovex);

                            // get current slide
                            var $current = self.slides.eq(self.currentIndex);
                            // fetch next or first slide
                            var $next = $current.next().length > 0 ? $current.next() : self.slides.eq(0);
                            // fetch previous or last slide
                            var $prev = $current.prev().length > 0 ? $current.prev() : self.slides.eq(self.allSlides - 1);

                            switch (self.sliderType) {
                                case 'fade':
                                    // Set result
                                    self.touch.result = 0.5;

                                    // if swipe gesture moves past the initial touch
                                    if (self.touch.touchmovex > self.touch.touchstartx) {
                                        // set equation
                                        self.touch.equation = 1 + (self.touch.movex * 0.01);
                                        // display previous slide for current slide to fade into
                                        self.lazyLoad(self, {
                                            slide: $prev,
                                            complete: function () {
                                                $prev.css({ 'opacity': 1 });
                                            }
                                        });
                                    } else {
                                        // Set equation
                                        self.touch.equation = 1 - (self.touch.movex * 0.01);
                                        // display next slide for current slide to fade into
                                        self.lazyLoad(self, {
                                            slide: $next,
                                            complete: function () {
                                                $next.css({ 'opacity': 1 });
                                            }
                                        });
                                    }

                                    // Update opacity based on equation
                                    $current.css({ 'opacity': self.touch.equation });
                                    break;
                                case 'revert':
                                    // Set result
                                    self.touch.result = 0.5;
                                    // if swipe gesture moves past the initial touch
                                    if (self.touch.touchmovex > self.touch.touchstartx) {
                                        // set equation
                                        self.touch.equation = 1 - (self.touch.movex * 0.01);
                                    } else {
                                        // Set equation
                                        self.touch.equation = 1 - (self.touch.movex * 0.01);
                                    }
                                    switch (self.animationType) {
                                        case 'CSS3':
                                            self.sliderInner.css({
                                                'transition': 'none', 'transform': 'translate3d(' + -self.touch.movex + 'px, 0, 0)'
                                            });
                                            break;
                                        case 'jQuery':
                                        default:
                                            self.sliderInner.css({ 'left': -self.touch.movex });
                                            break;
                                    }
                                    break;
                                case 'carousel':
                                    switch (self.animationType) {
                                        case 'CSS3':
                                            $current.css({
                                                'transition': 'none', 'transform': 'translate3d(' + -self.touch.movex + 'px, 0, 0)'
                                            });
                                            break;
                                        case 'jQuery':
                                        default:
                                            $current.css({ 'left': -self.touch.movex });
                                            break;
                                    }
                                    break;
                            }
                        }
                    });

                    self.sliderInner.on('touchend', function (event) {
                        // Get the original touch position.
                        self.touch.touchendx = event.originalEvent.pageX;
                        // set status
                        self.touch.status = false;
                        // resume slider
                        self.playback(self.auto);

                        // get positive touch position
                        self.touch.absMove = Math.abs(self.currentIndex * self.itemsWidth[self.currentIndex] - self.touch.movex);

                        if (self.touch.absMove > self.itemsWidth[self.currentIndex] / 2 || self.touch.longTouch === false) {
                            // set direction
                            self.touch.dir = self.touch.movex > self.touch.multiplier * self.itemsWidth[self.currentIndex] ? 'next' : 'prev';

                            if (self.touch.touchstartx !== self.touch.touchendx) {
                                // set on before state
                                self.setCallback(self, 'onBefore').done(function () {
                                    // check if slider is active
                                    if (self.play) {
                                        // set transition and on complete, set on after state
                                        self.ready(self, self.currentIndex, self.touch.dir).done(function () {
                                            self.setCallback(self, 'onAfter');
                                        });
                                    }
                                });
                            } else {
                                switch (self.sliderType) {
                                    case 'fade':
                                        self.slides.eq(self.currentIndex).css({ 'opacity': 1 });
                                        break;
                                }
                            }
                        }
                    });

                },

                // This method handles all of the mechanics of the slider
                init: function () {
                    // get slider object
                    var self = this;

                    // 1. add class names
                    self.style(self, self.options);

                    // 2. set slide widths
                    self.cycle(self, true);

                    // 3. set slide coordinates
                    self.setSlides({ init: true, width: self.slides.outerWidth(true) });

                    // 4. check if slider will use a nav
                    build.nav('init', {
                        self: self,
                        nav: self.nav,
                        navType: self.navType,
                        target: self.slider
                    });

                    // 5. check if slider will use a paginate
                    build.paginate('init', {
                        self: self,
                        paginate: self.paginate,
                        paginateType: self.paginateType,
                        target: self.slider,
                        items: self.slides
                    });

                    // 6. add video support
                    self.supportMedia();

                    // 7. add swipe gesture support
                    if (self.swipe) {
                        self.setTouch();
                    }

                    self.API = Object.getPrototypeOf(self);
                    self.setCallback(self, 'onInit').done(function () {

                        // check if extend method has not been executed already
                        if (self.extendable === undefined) {
                            // run extend method and pause export
                            self.extend(false);
                        }

                        // check if slider supports video
                        if (self.mediaMode) {
                            // add html5 video support
                            self.media.HTML5.video(self);
                            // add YT video support
                            self.media.YT.video(self);
                        }

                        // 7. check if auto play is set
                        self.checkIfAutoPlay();

                        // 8. pause slider if user hovers it
                        if (self.pauseOnHover) {
                            master.browser('autoHover', {
                                obj: self,
                                el: self.slider,
                                auto: self.auto,
                                callback: self.playback
                            });
                        }

                        // 9. check if slider is responsive
                        self.isResponsive(self);

                        // 10. check if window is active
                        if (self.pauseOnInActiveWindow) {
                            self.isInActiveWindow(self);
                        }

                        // 11. check if window is scrolling
                        if (self.pauseOnScroll) {
                            self.isScrolling(self);
                        }

                    });
                }

            });

            slider(self.$elem, self.options, new $.Deferred());

        };

		

        /* @Scale
        * --------------------------------------------------------------------- *

            @desc : scales an element based on it's aspect ratio
            @params : accepts the element
            @demo :

                @Shorthand
                $('.video-js').eflex( 'scale' );

        * --------------------------------------------------------------------- */
        eflex.effects.scale = function (self, master, error) {

            var scale = construct(Object, function (scale, options, deferred) {

                /* element */
                this.scale = scale;

                /* scale element */
                this.scaleByElement = scale.data('eflex-scale-by') || options.scaleByElement || this.scale.parent();
                // when scale anchor can't be found or set to default, set anchor to direct parent
                if (this.scaleByElement.length === 0 || this.scaleByElement === 'default') {
                    this.scaleByElement = this.scale.parent();
                } else {
                    // get matching selector method from DOM traversal
                    this.getElementBy = scale.data('eflex-get-element-by') || options.getElementBy || false;
                    // get matching selector name from scale
                    this.matchSelector = scale.data('eflex-match-selector') || options.matchSelector;

                    // when a method is provided
                    if (this.getElementBy) {
                        try {
                            // set scale anchor based on method and match selector
                            this.scaleByElement = this.scale[this.getElementBy](this.matchSelector);

                            // when match can't be found, look for available scale anchor
                            if (this.scaleByElement.length === 0) {
                                this.scaleByElement = options.scaleByElement;
                            }
                        } catch (e) {
                            console.log(e.message);
                        }
                    }
                }

                /* coordinates */
                this.coords = {};

                /* callbacks */
                this.onInit = scale.data('eflex-on-init') || options.onInit || function () { };
                this.onBefore = scale.data('eflex-on-before') || options.onBefore || function () { };
                this.onAfter = scale.data('eflex-on-after') || options.onAfter || function () { };

                this.deferred = deferred;

                this.init();

            }, {

                resize: function () {
                    /*
                    var self = this,
                        par = self.container;
                    */
                    var self = this;

                    self.setCallback(self, 'onBefore').done(function () {
                        //par.css({ 'display' : 'block', 'width' : self.scaleByElement.width() });

                        master.calc('aspectRatio', {
                            el: self.scale,
                            newWidth: self.scaleByElement.width(),
                            oriWidth: self.coords.oriWidth,
                            oriHeight: self.coords.oriHeight
                        });

                        //par.css({ 'height' : self.scale.height() });

                        self.setCallback(self, 'onAfter');
                    });

                },

                // This method prepares the callback function to run
                setCallback: function (_this, status) {
                    // cache scroll object
                    var self = _this || this;

                    // trigger callback function
                    master.trigger('callback', {
                        onState: self[status] || self.onInit,
                        obj: self
                    });

                    // trigger eflex event
                    master.trigger('event', {
                        name: status + 'EflexScale',
                        data: {
                            detail: { eflex: self, master: master }
                        }
                    });

                    // trigger jQuery version of eflex event
                    self.scale.trigger({
                        type: 'eflex/scale/' + status,
                        self: self
                    });

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                init: function () {
                    var self = this;

                    self.setCallback(self, 'onInit').done(function () {
                        self.coords.oriWidth = self.scale.width();
                        self.coords.oriHeight = self.scale.height();

                        // get new dimensions
                        self.resize();

                        $(window).resize(function () {
                            self.resize();
                        });
                    });
                }
            });

            scale(self.$elem, self.options, new $.Deferred());

        }

		

        /* @Scroll Effect
        * --------------------------------------------------------------------- *

            @desc : creates the Scroll effect
            @params : accepts the element, effect and action objects
            @demo :

                @Shorthand
                $('a[href^="#"]').eflex( 'scroll' );

                @Longhand
                $('[href^="#"]').eflex({
                    type: 'scroll',
                    duration: 1500,
                    easing: 'easeInOutExpo',
                    eventType: 'click',
                    target: $('html, body'),
                    onBefore: function ( self ) {
                        console.log( self );
                    },
                    onAfter: function ( self ) {
                        console.log( self );
                    }
                });

        * --------------------------------------------------------------------- */
        eflex.effects.scroll = function (self, master) {

            var scroll = construct(Object, function (scroll, options, deferred) {

                this.scroll = scroll;

                /* actions */
                this.eventType = scroll.data('eflex-event-type') || options.eventType || 'click';
                if (this.scroll.is('label') || this.scroll.is('input')) {
                    this.eventType = 'change';
                }

                // target
                this.target = master.calc('setDefault', {
                    setting: scroll.data('eflex-target'), default: master.calc('setDefault', {
                        setting: options.target, default: this.scroll.attr('href') || this.scroll
                    }).func
                }).func;

                if (typeof (this.target) === 'string') {
                    this.target = $(this.target);
                }

                // is triggerable
                this.trigger = master.calc('setDefault', {
                    setting: scroll.data('eflex-trigger'), default: master.calc('setDefault', {
                        setting: options.trigger, default: false
                    }).func
                }).func;

                // can freeze
                this.freeze = master.calc('setDefault', {
                    setting: scroll.data('eflex-freeze'), default: master.calc('setDefault', {
                        setting: options.freeze, default: false
                    }).func
                }).func;

                // set anchor
                this.anchor = master.calc('setDefault', {
                    setting: scroll.data('eflex-anchor'), default: master.calc('setDefault', {
                        setting: options.anchor, default: $('html, body')
                    }).func
                }).func;

                /* callbacks */
                this.onInit = scroll.data('eflex-on-init') || options.onInit || function () { };
                this.onBefore = scroll.data('eflex-on-before') || options.onBefore || function () { };
                this.onAfter = scroll.data('eflex-on-after') || options.onAfter || function () { };

                /* effects */
                this.duration = scroll.data('eflex-duration') || options.duration || 1500;
                this.easing = scroll.data('eflex-easing') || options.easing || 'easeInOutExpo';
                this.offset = scroll.data('eflex-offset') || options.offset;

                /* utility accessors */
                this.options = options;
                this.deferred = deferred;

                this.init();

            }, {

                transition: function (_this) {
                    var self = _this || this,
                        retargetOffsetTimer;

                    // check if anchor point is set
                    if (self.target.length > 0) {
                        // check if offset position is not set
                        // attempt to check if offset position doesn't exist in the anchor point
                        if (typeof (self.target.offset() == 'undefined')) {
                            var retargetOffset = function () {
                                clearTimeout(retargetOffsetTimer);
                                try {
                                    self.offset = $(self.target).offset().top;
                                } catch (e) {
                                    retargetOffsetTimer = setTimeout(retargetOffset, 100);
                                }
                            };
                            retargetOffset();
                            // assign offset based on anchor point's offset position
                        } else {
                            self.offset = $(self.target).offset().top;
                        }
                        //}

                        self.setCallback(self, 'onBefore').done(function () {
                            if (!self.freeze) {
                                self.anchor.stop().animate({
                                    scrollTop: self.offset
                                },
                                    self.duration, self.easing, function () {
                                        self.setCallback(self, 'onAfter');
                                    });
                            }
                        });
                    }

                    self.deferred.resolve();
                    return self.deferred.promise();
                },

                // This method prepares the callback function to run
                setCallback: function (_this, status) {
                    // cache scroll object
                    var self = _this || this;

                    // trigger on before callback function
                    master.trigger('callback', {
                        onState: self[status] || self.onInit,
                        obj: self
                    });

                    // trigger eflex slider event
                    master.trigger('event', {
                        name: status + 'EflexScroll',
                        data: {
                            detail: { eflex: self, master: master }
                        }
                    });

                    // trigger jQuery version of eflex slider event
                    self.scroll.trigger({
                        type: 'eflex/scroll/' + status,
                        self: self
                    });

                    // resolve deferred state and return complete status
                    return master.deferred('promise', self.deferred).func;
                },

                init: function () {
                    var self = this;

                    self.setCallback(self, 'onInit').done(function () {
                        switch (self.trigger) {
                            case true:
                                self.transition(self);
                                break;
                            case false:
                                master.trigger('action', {
                                    el: self.scroll,
                                    actor: self.eventType,
                                    func: function (e) {
                                        e.preventDefault();
                                        self.transition(self);
                                    }
                                });
                                break;
                        }
                    });
                }

            });

            scroll(self.$elem, self.options, new $.Deferred());

        }

		

        /* @Stretch
        * --------------------------------------------------------------------- *

            @desc : extends a container to fill up white space
            @params : accepts the effect, config and action objects
            @demo :

                @Shorthand
                $('.l-footer').eflex( 'stretch' );

        * --------------------------------------------------------------------- */
        eflex.effects.stretch = function (self, master) {

            var stretch = construct(Object, function (stretch, options, deferred) {

                /* element */
                this.stretch = stretch;
                this.max = 0;

                this.animationType = options.animationType || 'resize';

                this[this.animationType]();

            }, {

                max: 0,

                global: {
                    w: $(window).width(),
                    h: $(window).height()
                },

                elems: {
                    nodes: {
                        html: null,
                        h: 0
                    },
                    target: {
                        html: null,
                        h: 0
                    }
                },

                match: function () {
                    var res = (this.max < this.global.h) ? true : false;
                    return res;
                },

                cycle: function (target, nodes) {
                    var self = this;

                    nodes.each(function (index, value) {
                        switch ($(value).get(0).tagName) {
                            case 'LINK': case 'SCRIPT': case 'IFRAME': case 'STYLE':
                                break;
                            default:
                                // check if element is not part of the HUD snippet editor
                                if (typeof $(value).data('sn-id') === 'undefined') {
                                    self.max += $(value).outerHeight(true);
                                }
                                break;
                        }
                    });

                    return this.match();
                },

                init: function () {
                    var target = this.stretch,
                        nodes = target.siblings();

                    this.elems.nodes.html = nodes;
                    this.elems.nodes.h = nodes.outerHeight(true);

                    this.elems.target.html = target;
                    this.elems.target.h = target.outerHeight(true);

                    return this.cycle(target, nodes);
                },

                resize: function () {

                    if (this.init() != false) {
                        var vh = this.global.h - this.max;
                        this.elems.target.html.outerHeight(vh);
                    } else {
                        var th = this.elems.target.html.h;
                        this.elems.target.html.height(th);
                    }

                },

                bottom: function (elem) {
                    $('html, body').addClass('js-eflex--viewport');

                    if (this.init(elem) != false) {
                        this.elems.target.html.addClass('js-eflex--stretch');
                    } else {
                        this.elems.target.html.removeClass('js-eflex--stretch');
                    }
                }

            });

            stretch(self.$elem, self.options, new $.Deferred());

        }

		

        // Swap Method
        _dtm.swap = function ($elem, $target, css, scrollByElement, logic) {

            $elem = $elem || $('[data-swap-nav]');
            $target = $target || $('[data-swap-target]');
            css = css || 'slide-from-bottom';
            scrollByElement = scrollByElement || $(window);

            var logic = logic || function () {
                if (window.scrollY > $target.position().top) {
                    return true;
                } else {
                    return false;
                }
            };

            var swap = function () {
                if (logic(scrollByElement)) {
                    if (!($elem.hasClass(css))) {
                        $elem.addClass(css);
                    }
                } else {
                    if ($elem.hasClass(css)) {
                        $elem.removeClass(css);
                    }
                }
            };

            swap();
            scrollByElement.on('scroll', swap);
        }

        _dtm.AddFancyboxClass = function () {

            var $this = $(this);
            var attr = $($this).attr("data-fancybox-url");

            if (typeof attr == typeof undefined || attr == false) {
                $this = $('[data-fancybox-url]');
            }

            // check if the node is an anchor node
            if ($this.is('a')) {
                // check if the href is pointing to the snippet file
                if ($this.attr('href').match(/shared\/snippet.html/, 'i')) {
                    // add snippet method for support
                    $this.attr('data-fancybox-method', 'snippet');
                }
                // replace href with fancybox url and add the class along with ajax request
                $this.attr('href', $this.attr('data-fancybox-url')).addClass('has-fancybox fancybox.ajax');
            }
        };

        _dtm.eflexLink = function (selector, args) {
            var setEflexState = function (event) {
                var data = event.detail;
                if (data != null && data.key != null && data.state != null) {
                    var item = _dtm.ShoppingCart.items[data.key];
                    if (item != null) {
                        switch (data.state.toLowerCase()) {
                            case "add":
                                _eflex.link.methods.add(item);
                                break;
                            case "update":
                                _eflex.link.methods.update(item);
                                break;
                            case "remove":
                                _eflex.link.methods.remove(item);
                                break;
                        }
                    }
                }
            };

            var setEflexLink = function (selector) {
                $(selector).eflex({
                    type: 'link',
                    disableAfter: args.disableAfter,
                    eventType: args.eventType,
                    preserveContent: args.preserveContent,
                    swapClasses: args.swapClasses,
                    toggle: args.toggle,
                    text: args.text,
                    classes: args.classes,
                    onInit: function () {
                        // set args object
                        args = args || {};
                        // get jQuery object
                        args.$elem = $(selector) || $('[data-code]');

                        // get data-attribute name
                        var data = selector,
                            data = data.replace(/[\[\]']+/g, ''),
                            data = data.substr(data.indexOf('-') + 1);

                        // add flag to ensure execution happens once
                        var readyMethodState = false;

                        if (_dtm.ShoppingCart.items[this.obj.link.data(data)] == null) {
                            _dtm.ShoppingCart.items[this.obj.link.data(data)] = this.obj;
                        }
                        else {
                            if (_dtm.ShoppingCart.items[this.obj.link.data(data)].additionalLinks == null) {
                                _dtm.ShoppingCart.items[this.obj.link.data(data)].additionalLinks = [];
                            }
                            _dtm.ShoppingCart.items[this.obj.link.data(data)].additionalLinks.push(this.obj.link);
                        }

                        registerEvent('ChangeToggleButtonState', setEflexState);

                        if (!readyMethodState) {
                            // set access point to eflex link
                            _eflex.link = { methods: Object.getPrototypeOf(this.obj) };
                            // set ready state to true
                            readyMethodState = true;
                        }

                        triggerEvent('ToggleButtonInitialized');
                        args.onInit(this.obj);
                    },
                    onBefore: args.onBefore,
                    onAfter: args.onAfter
                });
            };

            // strip white-spaces and set new array based on comma separation
            var getSelectors = selector.replace(' ', '').split(',');
            // check if we're passing multiple data attribute names
            if (getSelectors.length > 1) {
                // iterate each data attribute name
                $.each(getSelectors, function (k, v) {
                    setEflexLink(v);
                });
                // otherwise, assume we're working with a single data attribute name
            } else {
                setEflexLink(selector);
            }

        };

        // Shopping Cart support with jQuery Eflex Link
        _dtm.ShoppingCart.eflexLink = function (args) {
            // set args object
            args = args || {};
            // get jQuery object
            args.$elem = args.$elem || $('[data-code]');

            // get data-attribute name
            var data = args.$elem.selector,
                data = data.replace(/[\[\]']+/g, ''),
                data = data.substr(data.indexOf('-') + 1);

            // add flag to ensure execution happens once
            var readyMethodState = false;
            var readyCartChange = false;

            var filterItems = function () {
                // get items from cart
                var items = _dtmShoppingCart.SearchItems();
                // set new deferred
                var $d = new $.Deferred();

                // get each item
                for (var i = 0; i < items.length; i++) {
                    // check if product code doesn't exist
                    if (typeof _dtm.ShoppingCart.items[items[i].id] === 'undefined') {
                        // get all product codes from the cart
                        for (var item in _dtm.ShoppingCart.items) {
                            // check if product codes match
                            if (items[i].id.match(new RegExp(item, 'i'))) {
                                // assign product code to id
                                items[i].id = item;
                                // add new product match
                                items[item] = items[i];
                            }
                        }
                    }
                }

                // get each item from cart
                for (var item in _dtm.ShoppingCart.items) {
                    // check if product code is not undefined
                    if (typeof items[item] !== 'undefined') {
                        // update counter with quantity
                        _dtm.ShoppingCart.items[items[item].id].counter = items[item].qty;
                        // invoke add method on element
                        _eflex.link.methods.add(_dtm.ShoppingCart.items[item]);
                        // otherwise, assume quantity is zeroed out
                    } else {
                        // invoke remove method on element
                        _eflex.link.methods.remove(_dtm.ShoppingCart.items[item]);
                    }
                }

                $d.resolve();
                return $d.promise();
            };

            var updateCart = function () {
                // check if ready state is false
                if (!readyCartChange) {

                    filterItems().done(function () {
                        args.$elem.trigger({ type: 'dtm/eflex/cartReady', self: args });
                    });
                    // change state to false
                    readyCartChange = true;

                    // otherwise, update on user interaction with eflex link
                } else if (typeof (args.getItem) !== 'undefined') {
                    // get current item
                    var item = _dtmShoppingCart.SearchItems(args.getItem);

                    // check if toggle mode is enable and if counter is not zeroed out
                    if (args.toggle && _dtm.ShoppingCart.items[args.getItem].counter > 0) {

                        if (typeof (args.getItem) !== 'undefined') {
                            // get action code
                            var ac = $('input[name*=ActionCode][value*=' + args.getItem + ']');
                            // check if action code exists
                            if (ac.length > 0) {
                                // get value of action code
                                var index = ac.attr('name').replace('ActionCode', '');
                                // get action quantity based on action code value
                                var aq = $('#ActionQuantity' + index);

                                // check if action quantity exists
                                if (aq.length > 0) {
                                    // zero out action quantity
                                    aq.val('0');
                                    // push update to framework
                                    aq.trigger('change');
                                    // update counter with quantity
                                    _dtm.ShoppingCart.items[args.getItem].counter = 0;
                                    // invoke remove method on element
                                    _eflex.link.methods.remove(_dtm.ShoppingCart.items[args.getItem]);
                                }
                            }
                        }

                        // otherwise, check if items have been added to cart
                    } else if (item.TotalQuantity > 0) {
                        // update counter with quantity
                        _dtm.ShoppingCart.items[args.getItem].counter = item.qty;
                        // invoke add method on element
                        //_eflex.link.methods.add(_dtm.ShoppingCart.items[args.getItem]);
                        filterItems();
                        // otherwise, assume quantity is zeroed out
                    } else {
                        // invoke remove method on element
                        _eflex.link.methods.remove(_dtm.ShoppingCart.items[args.getItem]);
                    }
                    // delete the current item reference
                    delete args.getItem;

                    // otherwise, update based on user action with shopping cart
                } else {
                    filterItems().done(function () {
                        args.$elem.trigger({ type: 'dtm/eflex/cartReady', self: args });
                    });
                }
            };

            // run eflex link
            args.$elem.eflex({
                type: 'link',
                disableAfter: args.disableAfter,
                eventType: args.eventType,
                preserveContent: args.preserveContent,
                swapClasses: args.swapClasses,
                toggle: args.toggle,
                text: args.text,
                classes: args.classes,
                onInit: function () {
                    // get toggle status
                    args.status = this.obj.status;

                    // check if there are multiple instances of the same data attribute
                    if (this.obj.link.data(data) in _dtm.ShoppingCart.items) {
                        // re-target element based on attribute selector
                        _dtm.ShoppingCart.items[this.obj.link.data(data)].link = $(master.search('selectAttr', {
                            attr: 'data-' + data,
                            value: this.obj.link.data(data)
                        }).func);
                        // otherwise, assign eflex link to the items object
                    } else {
                        _dtm.ShoppingCart.items[this.obj.link.data(data)] = this.obj;
                    }

                    if (!readyMethodState) {
                        // set access point to eflex link
                        _eflex.link = { methods: Object.getPrototypeOf(this.obj) };
                        // set ready state to true
                        readyMethodState = true;
                    }

                    args.onInit(this.obj);
                },
                onBefore: args.onBefore,
                onAfter: args.onAfter
            });

            // intercept after event
            args.$elem.on('eflex/link/onAfter', function (eflex) {
                // get current item
                args.getItem = eflex.self.link.attr('data-' + data);
                // get current status
                args.getStatus = eflex.self.status;
            });

            // listen for cart change
            registerEvent('CartChange', updateCart);
        };

        // Redirect Method
        _dtm.redirect = function (url) {
            var s = window.location.href.split('?');
            var query = '';
            var regex = '(o)';

            try {
                regex = RegExp(regex, 'i');
            } catch (e) {

            }

            if (s[1] != undefined) {
                var qs = s[1].split('&');
                $(qs).each(function (index, value) {
                    if (!regex.test(value)) {
                        query += value + '&';
                    }
                });
            }

            query = query.substring(0, query.length - 1);
            var q = query != null && query != '' ? (url.indexOf('?') < 0 ? '?' : '&') + query : '';

            window.location = url + q;
        }

        // Fancybox method
        _dtm.getFancybox = function (o) {
            const root = document.querySelector("#DTMFWJS");

            // get fancybox script
            const $script = $('script[src*="fancybox"]');
            // get fancybox stylesheet
            const $link = $('link[href*="fancybox"]');

            o = o || {};
            // set desired fancybox script
            o.js = o.js || '/shared/js/fancybox/2.1.5/jquery.fancybox.pack.js';
            // set desired fancybox stylesheet
            o.css = o.css || '/shared/js/fancybox/2.1.5/jquery.fancybox.min.css';

            // check if fancybox js file doesn't exist
            if ($script.length === 0) {
                // set up js for fancybox and load it before fw js
                const script = document.createElement("script");
                script.src = o.js;
                root.insertAdjacentElement("beforebegin", script);
            }

            // check if fancybox css file doesn't exist
            if ($link.length === 0) {
                // set up css for fancybox and load it before fw js
                const link = document.createElement("link");
                link.rel = "stylesheet";
                link.href = o.css;
                root.insertAdjacentElement("beforebegin", link);
            }
        };

        _dtm.requestScript = {

            // public property : sets a cache filter to prevent dupe events from firing
            cache: [],

            // public property : sets a configuration space for dependencies
            dictionary: [],

            // public method : checks if a dependency already exists in the DOM
            exists: function (file) {
                return $('script[src*="' + file + '"]').length > 0 ? true : false;
            },

            // public method : filters dictionary and handles dependency support
            get: function () {
                var self = this;

                $.each(this.dictionary, function () {
                    var file = $('script[src*="' + this.file + '"]');
                    var namespace = this.name;

                    if ($.inArray(namespace.toLowerCase(), self.cache) === -1) {
                        if (!self.exists(this.file)) {
                            $.getScript(this.dir + this.file).done(function (data, textStatus, jqxhr) {
                                self.callback(namespace, { data: data, textStatus: textStatus, jqxhr: jqxhr });
                            });
                        } else {
                            self.callback(namespace, namespace + ' is already installed');
                        }
                        self.cache.push(namespace.toLowerCase());
                    }
                });
            },

            // public method : returns an event to the user when dependency is available
            callback: function (namespace, response) {
                try {
                    window['get' + namespace](response);
                } catch (e) {
                }

                $('html').trigger({ type: namespace + ':ready', response: response });
            }

        };

        // Sets up a grid and separates it by the label
        _dtm.setUpsellGridByLabel = function () {
            // get comment node that contains upsell video
            var div = $('<div>').html($('.c-brand--upsell .c-brand__txt').html()),
                comment = div.contents().filter(function () {
                    return this.nodeType === 8;
                });
            // get comment node and test if first index is undefined
            comment = comment.get(0) || comment.get(1);

            try {
                // get node
                var node = $('<div>').html(comment.nodeValue);
                // get upsell code
                var code = node.find('[data-upsell-label-code]');

                // if the code attribute exists
                if (code.length > 0) {
                    // cycle each label
                    node.find('[data-upsell-label]').each(function (index, value) {
                        // insert the label before the target code
                        $(value).insertBefore($('#' + $(value).data('upsell-label-code')));
                    });
                }
            } catch (e) {
                console.log(e.message);
            }
        };

        // Sets video to play on upsell page
        _dtm.enableUpsellVideo = function () {
            // get comment node that contains upsell video
            var div = $('<div>').html($('.c-brand--upsell .c-brand__txt').html()),
                comment = div.contents().filter(function () {
                    return this.nodeType === 8;
                }).get(1);
            // get video container
            var $video = $('[data-upsell-video]');

            try {
                // check if upsell video attribute exists
                if ($video.length > 0) {
                    // add node value to attribute
                    $video.html(comment.nodeValue).addClass('u-mar--top');

                    // if video contains video-js
                    if ($video.find('.video-js').length > 0) {
                        var id = $video.find('.video-js').attr('id');
                        try {
                            // try to load in Video JS API
                            _V_(document.getElementById(id), {}, function () {

                            });
                        } catch (e) {
                            console.log('error in executing video js: ' + e.message);
                        }
                        // else if video depends on Vimeo and we're viewing mobile
                    } else if ($video.find('iframe[src*="vimeo"]').length > 0 && Model.IsMobile) {
                        try {
                            // get Vimeo video
                            var $vimeo = $video.find('iframe[src*="vimeo"]');
                            // sync video to Vimeo API when iframe loads
                            $vimeo.on('load', function () {
                                _dtm.getVimeo($vimeo);
                            });
                            // when Vimeo video is synced with Vimeo API
                            $('html').on('dtm/vimeo', function () {
                                // make Vimeo video responsive
                                _dtm.makeVimeoResponsive();
                            });
                        } catch (e) {
                            console.log('error in making Vimeo video responsive: ' + e.message);
                        }
                        // else if video depends on YouTube and we're viewing mobile
                    } else if ($video.find('iframe[src*="youtube"]').length > 0 && Model.IsMobile) {
                        try {
                            // get YouTube video
                            var $youtube = $video.find('iframe[src*="youtube"]');
                            // sync video to YouTube API when iframe loads
                            $youtube.on('load', function () {
                                _dtm.getYouTube($youtube);
                            });
                            // when YouTube video is synced with YouTube API
                            $('html').on('dtm/youtube', function () {
                                // make YouTube video responsive
                                _dtm.makeYouTubeResponsive();
                            });
                        } catch (e) {
                            console.log('error in making YouTube video responsive: ' + e.message);
                        }
                    }
                }
            } catch (e) {
                console.log(e.message);
            }

        };

        // method used to add a new API
        _dtm.addAPI = function () {
            // set api object
            var _api = {},
                objectCompleteTimer,
                methodCompleteTimer;

            // checks if the given content contains specific data
            _api.verifyBySrc = function (args) {
                try {
                    if (args.content.indexOf(args.verify) === -1) {
                        return false;
                    } else {
                        return true;
                    }
                } catch (e) {
                    console.log(e.message);
                }
            };

            // sets an id to a given element
            _api.setId = function (args) {
                // set index
                args.index = args.index || 0;
                // set the callback function
                args.callback = args.callback || function () { };

                // check if id exists in the DOM
                if (!args.$id.attr('id')) {
                    // assign unique id
                    args.$id.attr('id', args.uniqueid + args.index);
                }
                return args.callback(args);
            };

            // cycles through the API methods and returns a complete object
            _api.whenAPIReady = function (args) {
                // set the callback function
                args.callback = args.callback || function () { };
                // set the speed of each check
                args.speedIndex = args.speedIndex || 100;

                var whenMethodsAreComplete = function (value) {
                    clearTimeout(methodCompleteTimer);
                    // if object is not empty and the length of that object surpasses a certain limit
                    if (!$.isEmptyObject(value) && Object.keys(value).length > args.APIMethodLimit) {
                        return args.callback(args);
                    } else {
                        methodCompleteTimer = setTimeout(function () {
                            whenMethodsAreComplete(value);
                        }, args.speedIndex);
                    }
                };

                // determines if an object is empty and refires until it is complete
                var whenObjectIsComplete = function () {
                    clearTimeout(objectCompleteTimer);
                    // check if the api object is not empty
                    if (!$.isEmptyObject(args.APIObject)) {
                        // cycle the object
                        master.search('cycle', {
                            obj: args.APIObject,
                            callback: function (index, value, args, i) {
                                // on the first run, check when the object completely loads
                                if (i === 0) {
                                    whenMethodsAreComplete(value);
                                }
                            }
                        });
                        // otherwise, refire the function in the next interval
                    } else {
                        objectCompleteTimer = setTimeout(function () {
                            whenObjectIsComplete();
                        }, args.speedIndex);
                    }
                };
                whenObjectIsComplete();
                return args.APIObject;
            };

            _api.setAPIByElement = function (args) {
                // set callback function
                args.callback = args.callback || function () { };

                // check whether the JavaScript API exists
                _dtm.searchFileByJS({
                    file: args.configSrc,
                    create: true,
                    onSuccess: function (status) {
                        // if status returns successful
                        if (status) {
                            // apply success status to the API load status property
                            args.APILoadStatus = status;

                            // check whether string element or object element was passed
                            switch (true) {
                                // element was passed as a string
                                case typeof (args.el) === 'string':
                                    var $el = $('#' + args.el);
                                    if (_api.verifyBySrc({ content: $el.attr('src'), verify: args.verify })) {
                                        // check if id exists in the DOM
                                        _api.setId({
                                            $id: $el, uniqueid: args.uniqueid, callback: function () {
                                                return args.callback({ $id: $el, options: args.options, status: status });
                                            }
                                        });
                                    }
                                    break;
                                // element was passed as an object
                                case typeof (args.el) === 'object':
                                    // iterate each element
                                    args.el.each(function (index, value) {
                                        var $value = $(value);
                                        if (_api.verifyBySrc({ content: $value.attr('src'), verify: args.verify })) {
                                            _api.setId({
                                                $id: $value, index: index, uniqueid: args.uniqueid,
                                                callback: function () {
                                                    return args.callback({ $id: $value, options: args.options, status: status });
                                                }
                                            });
                                        }
                                    });
                                    break;
                            }
                        }
                    }
                });
            };

            return _api;
        };

        // searches DOM for a JavaScript file and returns a boolean based on whether it exists
        _dtm.searchFileByJS = function (args) {
            args.afterCreate = args.afterCreate || function () { };
            args.onSuccess = args.onSuccess || function () { };
            args.onFail = args.onFail || function () { };

            // check if script doesn't already exist in the DOM
            if ($('html').find('script[src="' + args.file + '"]').length === 0) {
                // check if we want to add the script dynamically
                if (args.create) {
                    var tag = document.createElement('script');
                    tag.src = args.file;
                    var firstScriptTag = document.getElementsByTagName('script')[0];
                    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                    tag.onload = function () {
                        args.afterCreate(true);
                        args.onSuccess(true);
                    };
                }
                return args.onFail(false);
            } else {
                return args.onSuccess(true);
            }
        };

        // gets the Vimeo API
        _dtm.getVimeo = function (el, options) {
            // set object
            var _v = {};
            // get the DTM API method
            var _api = _dtm.addAPI();

            // set config object
            _v.config = {
                uniqueid: 'dtm',
                src: 'https://player.vimeo.com/api/player.js',
                verify: 'player.vimeo.com'
            };

            // checks if the video contains the source to Vimeo
            _v.verifyVimeoBySrc = function (args) {
                return _api.verifyBySrc({ content: args.$id.attr('src'), verify: _v.config.verify });
            };

            // set Vimeo API
            _v.setVimeoAPI = function (args) {
                args.options = args.options || {};
                if (!args.$id.hasClass('has-dtm-vimeo')) {
                    try {
                        // create new Vimeo Player
                        _v.api[args.$id.attr('id')] = new Vimeo.Player(args.$id.attr('id'), args.options);
                        args.$id.addClass('has-dtm-vimeo');
                    } catch (e) {
                        console.log(e.message);
                    }
                }
            };

            // sets the element to bind with YouTube API
            _v.setVimeo = function (el, options) {
                _v.isVimeoLoaded = window.isVimeoLoaded || false;

                // check if an argument was passed
                if (typeof (el) !== 'undefined') {
                    // check if the element exists in the DOM
                    if (el.length > 0) {
                        // set new api object
                        _v.api = {};

                        // set up the Vimeo API by the element
                        _api.setAPIByElement({
                            el: el,
                            options: options,
                            verify: _v.config.verify,
                            configSrc: _v.config.src,
                            uniqueid: _v.config.uniqueid,
                            APILoadStatus: _v.isVimeoLoaded,
                            callback: function (args) {
                                _v.isVimeoLoaded = args.status;
                                if (typeof (window.isVimeoLoaded) === 'undefined') {
                                    window.isVimeoLoaded = _v.isVimeoLoaded;
                                }
                                _v.setVimeoAPI({ $id: args.$id, options: args.options });
                            }
                        });

                        // ready the Vimeo API to launch when complete
                        return _api.whenAPIReady({
                            APIObject: _v.api,
                            speedIndex: 100,
                            APIMethodLimit: 1,
                            callback: function (args) {
                                // trigger ready state
                                $('html').trigger({
                                    type: 'dtm/vimeo', api: _v.api
                                });
                                try {
                                    triggerEvent('dtm/vimeo', _v.api);
                                } catch (e) {
                                    console.log(e.message);
                                }
                            }
                        });
                    } else {
                        return _v;
                    }
                } else {
                    return _v;
                }

            };

            return _v.setVimeo(el, options);
        };

        // gets the YouTube API
        _dtm.getYouTube = function (el, options) {
            // set object
            var _yt = {};
            // get the DTM API method
            var _api = _dtm.addAPI();

            // set config object
            _yt.config = {
                jsapi: 'enablejsapi=1',
                uniqueid: 'dtm',
                src: 'https://www.youtube.com/iframe_api',
                verify: 'www.youtube.com/embed/'
            };

            // checks if the video contains the source to YouTube
            _yt.verifyYouTubeBySrc = function (args) {
                return _api.verifyBySrc({ content: args.$id.attr('src'), verify: _yt.config.verify });
            };

            // set YouTube API
            _yt.setYouTubeAPI = function (args) {
                args.options = args.options || {};
                // get source
                var src = args.$id.attr('src');
                // check if iframe doesn't already have the query
                if (!src.match(new RegExp(_yt.config.jsapi, 'g'))) {
                    // set query operator based on whether the question mark is set
                    var query = src.indexOf('?') === -1 ? '?' : '&';
                    args.$id.attr('src', src + query + _yt.config.jsapi);
                }

                var getAPI = function () {
                    try {
                        _yt.api[args.$id.attr('id')] = new YT.Player(args.$id.attr('id'), args.options);
                    } catch (e) {
                        setTimeout(getAPI, 100);
                    }
                };

                if (!args.$id.hasClass('has-dtm-youtube')) {
                    getAPI();
                    args.$id.addClass('has-dtm-youtube');
                }
            };

            // sets the element to bind with YouTube API
            _yt.setYouTube = function (el, options) {
                _yt.isYouTubeLoaded = window.isYouTubeLoaded || false;

                // check if an argument was passed
                if (typeof (el) !== 'undefined') {
                    // check if the element exists in the DOM
                    if (el.length > 0) {
                        // defined api object
                        _yt.api = {};

                        // set up the Vimeo API by the element
                        _api.setAPIByElement({
                            el: el,
                            options: options,
                            verify: _yt.config.verify,
                            configSrc: _yt.config.src,
                            uniqueid: _yt.config.uniqueid,
                            APILoadStatus: _yt.isYouTubeLoaded,
                            callback: function (args) {
                                _yt.isYouTubeLoaded = args.status;
                                if (typeof (window.isYouTubeLoaded) === 'undefined') {
                                    window.isYouTubeLoaded = _yt.isYouTubeLoaded;
                                }
                                _yt.setYouTubeAPI({ $id: args.$id, options: args.options });
                            }
                        });

                        // ready the Vimeo API to launch when complete
                        return _api.whenAPIReady({
                            APIObject: _yt.api,
                            speedIndex: 100,
                            APIMethodLimit: 50,
                            callback: function (args) {
                                // trigger ready state
                                $('html').trigger({
                                    type: 'dtm/youtube', api: _yt.api
                                });
                                try {
                                    triggerEvent('dtm/youtube', _yt.api);
                                } catch (e) {
                                    console.log(e.message);
                                }
                            }
                        });
                    } else {
                        return _yt;
                    }
                } else {
                    return _yt;
                }

            };

            return _yt.setYouTube(el, options);
        };

        // controls HTML5 video
        _dtm.controlHTML5Video = function (args) {
            var pauseHTML5Video = function (video) {
                // check if video isn't set to bypass pause mode
                if ($(video).data('pause') !== false) {
                    // check if video uses video-js api
                    if ($(video).hasClass('vjs-tech')) {
                        // pause video
                        _V_($(video).closest('.video-js').attr('id')).pause();
                    } else {
                        video.pause();
                    }
                }
            };

            // get each HTML5 video
            $('video').each(function () {
                // get id of each video
                var id = $(this).attr('id');
                if (typeof (args.video) !== 'undefined') {
                    // check for each video that isn't currently playing
                    if (this != args.video.get(0)) {
                        pauseHTML5Video(this);
                    }
                } else if (args.pauseAll) {
                    pauseHTML5Video(this);
                }
            });
        };

        // controls video types: HTML5, YouTube, Vimeo
        _dtm.controlVideo = function () {
            $('html').on('dtm/youtube/play', function (event) {
                try {
                    // get current video by id
                    var id = $(event.api.target.a).attr('id');
                    // get all YouTube videos
                    $.each(_dtm.api.youtube, function (index, value) {
                        // check if id doesn't match current video id
                        if (id !== index && !$('#' + id).data('pause')) {
                            // pause video
                            _dtm.api.youtube[index].pauseVideo();
                        }
                    });
                } catch (e) { }
                try {
                    // pause all Vimeo videos
                    $.each(_dtm.api.vimeo, function (index, value) {
                        value.pause();
                    });
                } catch (e) { }
                try {
                    _dtm.controlHTML5Video({ pauseAll: true });
                } catch (e) { }
            });

            $('html').on('dtm/vimeo', function (vimeo) {
                $.each(_dtm.api.vimeo, function (index, value) {
                    value.on('play', function () {
                        try {
                            // pause all YouTube videos
                            $.each(_dtm.api.youtube, function (index, value) {
                                _dtm.api.youtube[index].pauseVideo();
                            });
                        } catch (e) { }
                        try {
                            // pause all HTML5 videos
                            _dtm.controlHTML5Video({ pauseAll: true });
                        } catch (e) { }
                    });
                });
            });

            // allow all videos to pause when a current video is playing
            $('video').on('playing', function () {
                try {
                    _dtm.controlHTML5Video({ video: $(this) });
                } catch (e) { }
                try {
                    // pause all YouTube videos
                    $.each(_dtm.api.youtube, function (index, value) {
                        _dtm.api.youtube[index].pauseVideo();
                    });
                } catch (e) { }
                try {
                    // pause all Vimeo videos
                    $.each(_dtm.api.vimeo, function (index, value) {
                        value.pause();
                    });
                } catch (e) { }
            });
        };

        _dtm.mobile = {

            get: {
                vfs: {
                    link: function () {
                        return $('[href*="?dm=d"]');
                    },
                    container: function () {
                        return $('.l-header');
                    },
                    placeholder: function () {
                        return this.container().length ? this.container() : this.link();
                    }
                }
            },

            setResponsiveList: function () {
                // Responsive lists
                $('.c-list--nav').eflex({
                    type: 'list',
                    onAfter: function (self, result) {
                        var css = {
                            col: 'o-grid__col',
                            row: 'o-grid--block u-pad--vert'
                        };

                        if (!result) {
                            self.list.children()
                                .removeClass(css.col)
                                .addClass(css.row);
                        } else {
                            self.list.children()
                                .removeClass(css.row)
                                .addClass(css.col);
                        }
                    }
                });
            },

            setResponsiveFooter: function (args) {
                args = args || {};
                args.$this = args.$this || $('.l-footer__in .c-list--nav');

                var css = {
                    box: 'has-responsive-footer o-box u-vw--100 u-pad--reset fn--left @mv-bg--white',
                    row: 'o-grid--block u-pad--reset',
                    btn: 'o-grid--block u-pad o-pos',
                    icon: {
                        arrow: 'icon-chevron-thin-right o-pos__abs--center--vert o-pos__abs--right u-pad'
                    }
                };

                args.$this.children().each(function (index, value) {
                    if (!($(value).find('span').length > 0)) {
                        $(value).find('a')
                            .wrapInner('<span/>')
                            .append($('<span/>')
                                .addClass(css.icon.arrow));
                    }
                })

                // add styles
                args.$this.addClass(css.box)
                    .children().addClass(css.row)
                    .children().addClass(css.btn);
            },

            upsellImageToggle: function () {
                // Upsell toggle setup
                $('a[href^="#upsellImage"]').eflex({
                    type: 'toggle',
                    hide: $('#upsellImage'),
                    startEffect: 'fadeSlideDown',
                    endEffect: 'fadeSlideUp',
                    onAfter: function (self, link) {

                        if ($(link).attr('data-eflex--toggle-state') === 'false') {
                            $(link).text("+ View Image");
                        } else {
                            $(link).text("- Hide Image");
                        }

                    }
                });
            },

            // role: creates graphic to call out desktop version and adds it to mobile header
            addViewFullSite: function () {
                var $link = this.get.vfs.link();
                var $placeholder = this.get.vfs.placeholder();

                // set up button container
                var $vfs = $('<div/>', {
                    class: 'vfs vfs--button animate-and-fade-in'
                });

                // set up directory
                var vfs__dir = '/shared/mobile/images/';
                // set up file name
                var vfs__name = 'english-view-site.svg';
                // set up file path with fallback support
                var vfs__img = vfs__dir + (_dtm.ifExists(vfs__dir + vfs__name) ? vfs__name : 'mobile-view-site.svg');

                // set up button graphic
                var $vfs__img = $('<img/>', {
                    class: 'vfs__img',
                    src: vfs__img + '?v=6.0.1722.1545'
                });

                // insert button into the mobile header
                $vfs__img.appendTo($vfs);
                $vfs.prependTo($link);

                // remove overflow to ensure button is align with the mobile header
                $placeholder.addClass('l-header--vfs');
            },

            // role: hides view full site on mobile upsell page type and expands header image to fill space
            hideViewFullSite: function () {
                var $placeholder = this.get.vfs.placeholder();
                $placeholder.addClass('l-header__vfs--hide');
            }

        };

        _dtm.makeVimeoResponsive = function (args) {
            args = args || {};
            args.onAfter = args.onAfter || function () { };

            var scaleByElement =
                args.scaleByElement ||
                (function () {
                    if ($('#content_top').length > 0) {
                        return $('#content_top');
                    } else {
                        return $('#contentContainer');
                    }
                })();
            var $vimeo = $('.has-dtm-vimeo');

            // filter all vimeo videos to get the aspect ratio
            $vimeo.each(function (index, vimeo) {
                // check if custom aspect ratio is not provided
                if (typeof ($(vimeo).data('eflex-aspect-ratio')) === 'undefined') {
                    // reset fixed dimensions to preserve 16:9 aspect ratio
                    $(vimeo).attr({ 'width': '300', 'height': '169' });
                }
            });

            $vimeo.eflex({
                type: 'scale',
                scaleByElement: scaleByElement,
                getElementBy: args.getElementBy,
                matchSelector: scaleByElement.selector,
                onAfter: args.onAfter
            });
        };

        _dtm.makeYouTubeResponsive = function (args) {
            args = args || {};
            args.onAfter = args.onAfter || function () { };

            var scaleByElement =
                args.scaleByElement ||
                (function () {
                    if ($('#content_top').length > 0) {
                        return $('#content_top');
                    } else {
                        return $('#contentContainer');
                    }
                })();
            var $youtube = $('.has-dtm-youtube');

            // filter all youtube videos to get the aspect ratio
            $youtube.each(function (index, youtube) {
                // check if custom aspect ratio is not provided
                if (typeof ($(youtube).data('eflex-aspect-ratio')) === 'undefined') {
                    // reset fixed dimensions to preserve 16:9 aspect ratio
                    $(youtube).attr({ 'width': '300', 'height': '169' });
                }
            });

            $youtube.eflex({
                type: 'scale',
                scaleByElement: scaleByElement,
                getElementBy: args.getElementBy,
                matchSelector: scaleByElement.selector,
                onAfter: args.onAfter
            });
        };

        _dtm.getPopup = function (href, args) {
            args = args || {};
            args.width = args.width || '475';
            args.height = args.height || '420';
            args.toolbars = args.toolbars || 'no';
            args.menubar = args.menubar || 'no';
            args.location = args.location || 'no';
            args.scrollbars = args.scrollbars || 'yes';
            args.resizable = args.resizable || 'no';
            args.status = args.status || 'no';

            try {
                window.open(href, 'popup', 'width=' + args.width + ',height=' + args.height + ',toolbars=' + args.toolbars + ',menubar=' + args.menubar + ',location=' + args.location + ',scrollbars=' + args.scrollbars + ',resizable=' + args.resizable + ',status=' + args.status);
            } catch (e) {
                console.log(e.message);
            }
        };

        _dtm.scrollToVse = function () {
            let $vse = $('.validation-summary-errors');

            // check if vse is visible and in not in the viewport
            if ($vse.is(':visible') && !$vse.is(':inviewport')) {
                $.scrollTo($vse);
                // else check if vse exists on the DOM but is not visible
            } else if ($vse.length > 0 && !($vse.is(':visible'))) {
                $(window).trigger({ type: 'dtm/vse/invisible' });
            }
        };

        $(window).on('load',function () {
            _dtm.api = {

                fancybox: {

                    page: function (fb, $defer, o) {
                        // get page href
                        var href = $(fb).attr('href');
                        // get page code
                        var page = href.split('.')[0];

                        // get upsell data from target page
                        $.getJSON('/UPGRADE/1.0000/' + href, { RemoteType: page, covid: 'b6a095f0-0809-ed11-8b97-a0369f1303c7' }, function (data) {

                            // check if response data has properties
                            if (typeof data === 'object') {
                                // check if the current property exists
                                if (typeof data.current !== 'undefined') {
                                    // get snippet template
                                    $.get('/shared/snippet.html', function (html) {
                                        // insert snippet template into container
                                        var $container = $('<div/>', { html: html });

                                        // access title and insert upsell title
                                        $container.find('#snippet__title').text(data.current.title);
                                        // access body and insert upsell text
                                        $container.find('#snippet__content').html(data.current.desc);

                                        // assign new content to the fancybox api
                                        o.content = $container.html();
                                        // apply subpage class
                                        o.wrapCSS = 'c-brand snippet snippet--' + page.toLowerCase();
                                        // resolve status as complete : defer back to fancybox to open with new content
                                        $defer.resolve();

                                    });
                                } else {
                                    // set status as failure : current property is not added to the REMOTERESPONSE snippet
                                    $defer.reject();
                                }
                            } else {
                                // set status as failure : no data was returned from the request
                                $defer.reject();
                            }

                        });

                        // confirm task complete and delegate back to framework js
                        return $defer.promise();
                    },

                    snippet: function (fb, $defer, o) {
                        var href = $(fb).attr('href');

                        $.get(href, function (response, status, xhr) {
                            var $container = $('<div/>', { html: response });

                            try {
                                var __action, __pairs, __title;
                                var querystring = href.split('?')[1] || false;
                                var isSelfContained = false;

                                if (!querystring || querystring.indexOf('fn=') === -1) {
                                    return false;
                                }

                                querystring = querystring.replace(/&/g, "&");
                                __pairs = querystring.split("&");

                                for (var i = 0; i < __pairs.length; i++) {
                                    switch (true) {
                                        case __pairs[i].indexOf('fn=') >= 0:
                                            __action = __pairs[i].replace('fn=', '');
                                            break;
                                        case __pairs[i].indexOf('t=') >= 0:
                                            __title = decodeURIComponent(__pairs[i].replace('t=', ''));
                                            break;
                                        case __pairs[i].indexOf('isSelfContained=') >= 0:
                                            isSelfContained = true;
                                            break;
                                    }
                                }

                                if (isSelfContained) {
                                    $container.find('.ext--snippet').addClass('is-self-contained');
                                }

                                if (typeof __title !== 'undefined') {
                                    $container.find('#snippet__title').html(__title);
                                } else {
                                    $container.find('#snippet__title').remove();
                                }

                                $container.find('#snippet__content').load('/StaticContent.txt', { filename: __action, covid: 'b6a095f0-0809-ed11-8b97-a0369f1303c7' },
                                    function (response, status, xhr) {
                                        o.content = $container.html();
                                        xhr.status === 200 ? $defer.resolve() : $defer.reject();
                                    });
                            } catch (e) {
                                console.log(e);
                            }
                        });

                        return $defer.promise();
                    }

                },

                vimeo: _dtm.getVimeo($('iframe[src^="https://player.vimeo.com/video/"]')),


                youtube: _dtm.getYouTube($('iframe[src^="https://www.youtube.com/embed/"]'), {
                    events: {
                        onReady: function (event) {
                            $('html').trigger('dtm/youtube/ready');
                        },
                        onStateChange: function (event) {
                            switch (event.data) {
                                case 1:
                                    $('html').trigger({ type: 'dtm/youtube/play', api: event });
                                    break;
                                case 2:
                                    $('html').trigger({ type: 'dtm/youtube/pause', api: event });
                                    break;
                                case 0:
                                    $('html').trigger({ type: 'dtm/youtube/end', api: event });
                                    break;
                            }
                        }
                    }
                })


            };

            // cache all jQuery objects
            _dtm.jQuery = {

                $nav: $('.new-btns'),

                $contentTop: $('#content_top'),

                $main: $('main'),

                $footer: $('.l-footer')

            };

            _dtm.getMobileNav = {

                height: _dtm.jQuery.$nav.height()

            };

            // add fancybox plugin
            _dtm.getFancybox({
                js: '/shared/js/fancybox/3.5.7/jquery.fancybox.min.js',
                css: '/shared/js/fancybox/3.5.7/jquery.fancybox.min.css'
            });

            // get numeric keyboard value
            var supportNumericKeyboard = master.calc('parseBoolean', { string: 'True' }).func;
            // get email keyboard value
            var supportEmailKeyboard = master.calc('parseBoolean', { string: 'True' }).func;

            // check if billing country is set to Canada
            var isCAN = $('#BillingCountry').val() === 'CAN' ? true : false;
            // check if OFRT reversion formatting is set
            var revertOFRT = master.calc('parseBoolean', { string: 'False' }).func;

            _dtm.settings = {
                revertOFRT: revertOFRT,
                supportNumericKeyboard: supportNumericKeyboard,
                supportEmailKeyboard: supportEmailKeyboard
            };

            /* @Import DTM Style Polyfill */
            _dtm.attr = {

                config: {

                    ZC: {
                        el: $('#zc'),
                        type: !isCAN && supportNumericKeyboard ? 'tel' : 'text'
                    },

                    CardNumber: {
                        el: $('#CardNumber'),
                        type: supportNumericKeyboard ? 'tel' : 'text'
                    },

                    CardCvv2: {
                        el: $('#CardCvv2'),
                        type: supportNumericKeyboard ? 'tel' : 'text'
                    },

                    BillingZip: {
                        el: $('#BillingZip'),
                        type: !isCAN && supportNumericKeyboard ? 'tel' : 'text'
                    },

                    Phone: {
                        el: $('#Phone:not(input[type="hidden"])'),
                        type: supportNumericKeyboard ? 'tel' : 'text'
                    },

                    Email: {
                        el: $('#Email:not(input[type="hidden"])'),
                        type: supportEmailKeyboard ? 'email' : 'text'
                    },

                    ShippingZip: {
                        el: $('#ShippingZip'),
                        type: !isCAN && supportNumericKeyboard ? 'tel' : 'text'
                    }
                }

            };

            _dtm.css = {

                config: {

                    form: {
                        el: $('#form'),
                        css: 'c-brand--form'
                    },

                    img: {
                        el: $('.dtm__in--mv img:not(.dtm__restyle)').not($('#cc img')),
                        css: 'u-mar--center'
                    },

                    input: {
                        el: $('input[type="text"]:not(.dtm__restyle), input[type="email"]:not(.dtm__restyle), input[type="tel"]:not(.dtm__restyle), input[type="search"]:not(.dtm__restyle)'),
                        css: 'c-brand--form__input o-box o-shadow fx--animate'
                    },

                    paymentForm: {
                        el: $('#paymentForm input[type="text"], #paymentForm input[type="email"], #paymentForm input[type="tel"]'),
                        css: 'o-grid__col @xs-u-vw--100'
                    },

                    billingInformation: {
                        el: $('#billingInformation input[type="text"], #billingInformation input[type="email"], #billingInformation input[type="tel"]'),
                        css: 'o-grid__col @xs-u-vw--100'
                    },

                    shippingInformation: {
                        el: $('#shippingInformation input[type="text"], #shippingInformation input[type="email"], #shippingInformation input[type="tel"]'),
                        css: 'o-grid__col @xs-u-vw--100'
                    },

                    select: {
                        el: $('select:not(.dtm__restyle)'),
                        css: 'c-brand--form__select o-box o-shadow u-vw fx--animate'
                    },

                    streetAutoFill: {
                        el: $('#StreetAutoFill'),
                        css: 'o-box @xs-u-vw--100 fx--animate c-brand--form__input'
                    },

                    ShippingStreetAutoFill: {
                        el: $('#ShippingStreetAutoFill'),
                        css: 'o-box @xs-u-vw--100 fx--animate c-brand--form__input'
                    },

                    reviewOrder: {
                        el: $('#reviewOrder'),
                        css: 'c-brand--form__fieldset'
                    },

                    FormHeadlineL: {
                        el: $('.FormHeadlineL'),
                        css: 'c-brand--form__headline c-brand--form__legend'
                    },

                    orderReview: {
                        el: $('#orderReview'),
                        css: revertOFRT ? 'c-brand--table--ofrt-revert' : '@mv-u-pad--vert c-brand--table--ofrt'
                    },

                    orderItemsTable: {
                        el: $('.orderItemsTable'),
                        css: !revertOFRT ? 'c-brand--table' : 'c-brand--table--ofrt-revert',
                    },

                    OSWE: {
                        el: $('.dtm--custom .orderItemsTable'),
                        css: revertOFRT ? 'c-brand--table--cart c-brand--table--ofrt-revert c-brand--form u-vw--100' : 'c-brand--table c-brand--table--cart c-brand--form u-vw--100'
                    },

                    ZC: {
                        el: $('.zc'),
                        css: 'zc o-box o-grid--iblock c-brand--form__input fx--animate u-vw--50',
                    },

                    StateTaxLink: {
                        el: $('[title="Sales Tax"]'),
                        css: 'c-brand__tax'
                    },

                    validationSummaryErrors: {
                        el: $('.validation-summary-errors'),
                        css: 'o-box--msg-error'
                    }

                }

            };

            _dtm.remove = {

                config: {

                    html: {
                        el: $('html'),
                        css: revertOFRT ? 'dtm--custom' : null
                    },

                    ZC: {
                        el: $('.zc'),
                        css: 'o-grid__col @xs-u-vw--100',
                    },

                    orderReview: {
                        el: $('#orderReview'),
                        css: revertOFRT ? 'c-brand--table' : 'c-brand--table--ofrt'
                    }

                }

            };

            _dtm.editable = {

                config: {

                    text: { el: $('h1, h2, h3, h4, h5, h6, em, p, strong, i, span, blockquote, cite, li') }

                }

            };

            _dtm.style = function (option, callback) {
                $.each(this[option]['config'], function (index, value) {
                    callback(index, value);
                });
            };

            _dtm.update = {
                // add css classes
                setClasses: function () {
                    _dtm.style('css', function (index, value) {
                        value.el.addClass(value.css);
                    });
                },

                // remove css classes
                removeClasses: function () {
                    _dtm.style('remove', function (index, value) {
                        value.el.removeClass(value.css);
                    });
                },

                // add numeric & email keyboard support
                setAttributes: function () {
                    _dtm.style('attr', function (index, value) {
                        value.el.attr('type', value.type);
                    });
                },

                // make content editable
                makeEditable: function () {
                    _dtm.style('editable', function (index, value) {
                        value.el.attr('contenteditable', 'true');
                    });
                },

                // add responsive table
                setResponsiveTable: function (data, args) {
                    // set element variable
                    var $elem = data || $('.c-brand--table');

                    args = args || {};
                    args.classes = args.classes || {};
                    // set revert mode
                    args.isReverted = master.calc('setDefault', {
                        setting: args.isReverted, default: master.calc('parseBoolean', {
                            string: 'False'
                        }).func
                    }).func;

                    args.numberOfColumns = args.numberOfColumns || $elem.find('tfoot').children().length;
                    _dtm.ShoppingCart.isRevertable = args.isReverted;
                    _dtm.ShoppingCart.numberOfColumns = args.numberOfColumns;

                    if (!args.isReverted) {
                        // Responsive table
                        $elem.eflex({
                            type: 'table',
                            callback: function (self, master) {

                                var td = self.trow.find('td:first'),
                                    css__table = args.classes.table || 'table-is-responsive',
                                    css__td = args.classes.td || 'c-brand--table__th';

                                if (typeof args.classes.theme !== 'undefined') {
                                    css__table = css__table + ' ' + args.classes.theme;
                                }

                                self.ifMobile = function () {
                                    master.viewport('query', {
                                        length: 'width',
                                        value: { max: args.maxWidth || 760 },
                                        callback: function (query, args, value) {
                                            if (query) {
                                                if (!self.table.hasClass(css__table)) {
                                                    self.table.addClass(css__table);
                                                }

                                                if (!td.hasClass(css__td)) {
                                                    td.addClass(css__td);
                                                }
                                            } else {
                                                self.table.removeClass(css__table);
                                                td.removeClass(css__td);
                                            }
                                        }
                                    });
                                }

                                self.ifMobile();

                                master.viewport('resize', {
                                    callback: function () {
                                        self.ifMobile();
                                    }
                                });

                                self.trow.each(function (index, value) {
                                    if ($(value).hasClass("c-brand--table__checkboxes")) {
                                        var children = $(value).children();
                                        children.each(function () {
                                            $(this).attr("data-eflex--category-label", "");
                                        });
                                    }
                                });

                            }

                        });
                    } else {
                        $($elem).find('tfoot td').each(function (index, td) {
                            if (index === 0) {
                                $(td).addClass('o-grid--none');
                            } else if ($(td).hasClass('tfoot_td--label')) {
                                $(td).attr('colspan', args.numberOfColumns);
                            }
                        });
                    }
                },

                form: function () {

                    this.setAttributes();
                    this.setClasses();
                    this.removeClasses();

                    // wrap order form review table
                    _dtm.css.config.orderReview.el.wrap('<div class="@mv-u-pad--vert reviewTable__wrap" />');

                    // check if order id does not exist
                    if ($('#order').length === 0) {
                        // add order id
                        $('[name="order"]').attr('id', 'order');
                    }

						
                    // move indicate to top of form
                    $('.indicate').addClass('u-mar--center fn--center u-pad--vert').insertBefore($('#productSelection'));
						

                },

                mobile: function () {

                    // promote navigation buttons to new template
                    $('.navigation_buttons')
                        .removeClass('navigation_buttons')
                        .children()
                        .addClass('o-box--btn--toggle');

                    // hide back button
                    $('#back_button').addClass('hide');

                    // re-add click event back to button
                    $('[href="#formWrap"], [href=#order]').on('click', function () {
                        $('#back_button').removeClass('hide').addClass('column-block');
                    });

                    $('#back_button').on('click', function () {
                        $('#back_button').addClass('hide');
                    });

                }
            };

            // This method sets up criteo detection and supports sticky nav
            _dtm.getCriteo = function (args) {
                // set args object
                args = args || {};
                // set $elem or get default
                args.$elem = args.$elem || $('.criteo_header');
                // if true, just return true to do something else
                args.callback = args.callback !== undefined ? args.callback : false;
                // set support for mobile nav
                args.supportMobileNav = args.supportMobileNav !== undefined ? args.supportMobileNav : true;
                // set placeholder target for criteo
                args.placeholder = $('[data-criteo-placeholder]').length !== 0 ? $('[data-criteo-placeholder]') : _dtm.jQuery.$nav;

                // check if element exists
                if (args.$elem.length > 0 && $('.dtm-criteo').length === 0) {
                    switch (true) {
                        // if we just want to check if it exists
                        case args.callback:
                            return true;
                            break;
                        // if we want to support the sticky nav
                        case args.supportMobileNav:
                            // modify classes and wrap in an outer container
                            args.placeholder
                                .removeClass('fix-to-bottom')
                                .addClass('inner-new-btns')
                                .wrap('<div class="outer-new-btns" />');
                            // set outer new btns jQuery object
                            _dtm.jQuery.$outerNewBtns = $('.outer-new-btns');
                            // add criteo class and prepend into the sticky nav
                            args.$elem
                                .addClass('dtm-criteo o-pos')
                                .prependTo(_dtm.jQuery.$outerNewBtns);
                            // set the outer container to stick to the bottom
                            _dtm.jQuery.$outerNewBtns.addClass('fix-to-bottom');
                            // recalc the new height
                            _dtm.getMobileNav.height = _dtm.jQuery.$outerNewBtns.height();
                            break;
                    }
                }

            };

            // This method sets up the support for sticky nav
            _dtm.setMobileNav = function ($nav, args) {

                // check if nav has the fix to bottom class
                if ($nav.hasClass('fix-to-bottom')) {
                    // we need to remove CSS transform property so menu is fixed to the window
                    _dtm.jQuery.$contentTop.css('transform', 'initial');
                    // we need to increase z-index in it's parent container
                    _dtm.jQuery.$main.css({ 'z-index': 3 });
                }

                // check if support object exists
                if (args.support.length > 0) {
                    // get each pixel and run it
                    $.each(args.support, function (i, set) {
                        set.pixel();
                    });
                }

                // check if mobile nav height exists
                if (_dtm.getMobileNav.height) {
                    // we need to accomodate overlap space by the height of the mobile nav menu
                    _dtm.jQuery.$footer.css({ 'padding-bottom': _dtm.getMobileNav.height * 1.5 });
                }

            };

            // This method sets up support to control a target's presentation whenever a user approaches it
            _dtm.animateToTargetOnScroll = function (params) {
                params = params || {};
                // set distance
                var distance = params.distance || 1.3;
                // set target
                var target = params.target || (function () {
                    return $('#content_bottom').length > 0 ? $('#content_bottom') : $('#formWrap');
                })();
                // set focus
                var focus = master.calc('setDefault', {
                    setting: params.focus, default: false
                }).func;
                // set anchor
                var $window = params.anchor || $(window);

                // set callback for in range
                var callbackInRange = params.callbackInRange || function () { };
                // set callback for out range
                var callbackOutRange = params.callbackOutRange || function () { };

                $window.scroll(function () {
                    // check if scroll position is within range of the target area
                    if (($window.scrollTop() + ($window.height() / distance)) > target.offset().top) {
                        if (focus) {
                            // check if scroll position exceeds past range of the target area
                            if (($window.scrollTop() + ($window.height() / distance)) > (target.offset().top + target.height())) {
                                // invoke out range callback
                                callbackOutRange();
                            } else {
                                // invoke in range callback
                                callbackInRange();
                            }
                        } else {
                            // invoke in range callback
                            callbackInRange();
                        }
                    } else {
                        // invoke out range callback
                        callbackOutRange();
                    }
                });
            };

            // This method handles when form controls should be disabled or enabled based on a conditional status
            _dtm.toggleFormUsability = function (o) {
                o = o || {};
                var $target = o.$target.length > 0 ? o.$target : $('#form');

                if ($target.length > 0) {
                    if (o.status) {
                        $target.find('input, select').each(function () {
                            $(this).attr('disabled', true);
                        });
                    } else {
                        $target.find('input, select').each(function () {
                            $(this).removeAttr('disabled');
                        });
                    }
                }
            };

            // This method sets up the support to return the form to the landing page and enable scroll animation support
            _dtm.showOrderFormOnMobile = function (args) {
                args = args || {};
                var self = {};
                // get order form container
                var $form = args.$form || (function () {
                    return $('#content_bottom').length > 0 ? $('#content_bottom') : $('#formWrap');
                })();

                // get nav
                var $nav = args.$nav || $('.new-btns, .fp-nav');
                // get parent
                var $p = $nav.parent();

                // get anchor
                var $anchor = args.$anchor || $(window);

                // get elements to remove events
                var $removeEventsFrom = args.$removeEventsFrom || $("a[href=#formWrap], a[href=#order], a[href=#mainContainer], a[rel=#formWrap], a[rel=#mainContainer]");
                // set action
                var triggerAction = function () {
                    _dtm.animateToTargetOnScroll({
                        target: $form,
                        anchor: $anchor,
                        callbackInRange: function () {
                            $nav.css({ 'opacity': 0, 'pointer-events': 'none' });
                            $('[data-test-id="ChatWidgetButton"], [data-test-id="ChatWidgetMobileButton"]').css({ 'opacity': 0, 'pointer-events': 'none' });
                            if ($p.hasClass('outer-new-btns')) {
                                $p.addClass('new-btns--is-hidden');
                            }
                        },
                        callbackOutRange: function () {
                            $nav.css({ 'opacity': 1, 'pointer-events': 'all' });
                            $('[data-test-id="ChatWidgetButton"], [data-test-id="ChatWidgetMobileButton"]').css({ 'opacity': 1, 'pointer-events': 'all' });
                            if ($p.hasClass('outer-new-btns')) {
                                $p.removeClass('new-btns--is-hidden');
                            }
                        }
                    });
                };

                self.bindEvents = function () {
                    // attach new click event to anchors
                    $removeEventsFrom.on('click', function () {
                        // jump to the form
                        $form.eflex({ type: 'scroll', trigger: true });
                    });
                };

                // make form visible
                $form.show();
                // add CSS3 animation support
                $nav.addClass('animate');
                // turn off click events that would cause the page to switch
                $removeEventsFrom.off('click');

                triggerAction();

                // when framework js is ready
                $('html').on('dtm/fwjs', self.bindEvents);

                try {
                    $nav.trigger({ type: 'dtm/showOrderFormOnMobile', self: self });
                    triggerEvent('OrderFormShownOnMobile');
                }
                catch (err) {
                    console.log(err.message);
                }
            };

            _dtm.togglePagesOnMobile = function () {
                // Content toggle setup
                $('a[href^="#order"], a[href^="#formWrap"]').eflex({
                    type: 'toggle',
                    show: $('.validation-summary-errors').is(':visible') ? $('#content_bottom, [data-id="content_bottom"]') : $('#content_top, [data-id="content_top"]'),
                    hide: $('.validation-summary-errors').is(':visible') ? $('#content_top, [data-id="content_top"]') : $('#content_bottom, [data-id="content_bottom"]'),
                    onAfter: function (self, link) {
                        try {
                            // jump to top of page
                            window.scroll(0, 0);

                            // check if we are on the order form
                            if (link.data('eflex--toggle-state')) {
                                // hide the order now button in the footer
                                $('.l-footer [href*="order"]').hide();
                            } else {
                                $('.l-footer [href*="order"]').show();
                            }
                        } catch (e) {
                            // log to console if something went wrong
                            console.log(e.message);
                        }
                    }
                });
            };

			// check if we are upgrading the form without going incognito
			

            _dtm.update.form();

				// check if we are upgrading the form
				

            // set nav setting
            var jQueryEflexSliderNav = false;
            // set nav selector
            var jQueryEflexSliderNavSelector;
            // set paginate setting
            var jQueryEflexSliderPaginate = false;
            // set paginate selector
            var jQueryEflexSliderPaginateSelector;

            // check if nav setting is enabled
            if (master.calc('parseBoolean', { string: 'True' }).func) {
                // get nav selector
                jQueryEflexSliderNavSelector = $('.js-eflex--fade__nav');

                // check if nav selector exists
                if (jQueryEflexSliderNavSelector.length > 0) {
                    jQueryEflexSliderNav = jQueryEflexSliderNavSelector;
                } else {
                    jQueryEflexSliderNav = true;
                }
            }

            // check if paginate setting is enabled
            if (master.calc('parseBoolean', { string: 'True' }).func) {
                // get paginate selector
                jQueryEflexSliderPaginateSelector = $('.js-eflex--fade__paginav');

                // check if paginate selector exists
                if (jQueryEflexSliderPaginateSelector.length > 0) {
                    jQueryEflexSliderPaginate = jQueryEflexSliderPaginateSelector;
                } else {
                    jQueryEflexSliderPaginate = true;
                }
            }

            // invoke jQuery Eflex slider
            $('.js-eflex--fade').eflex({
                type: 'slider',
                sliderType: 'carousel',
                animationType: 'CSS3',
                nav: jQueryEflexSliderNav,
                navType: 'button',
                paginate: jQueryEflexSliderPaginate,
                paginateType: 'li',
                htmlWrapper: 'div',
                cssWrapper: 'js-eflex--wrapper',
                duration: 300,
                delay: 5000,
                easing: 'swing',
                eventType: 'click',
                onInit: null,
                onBefore: null,
                onAfter: null,
                auto: master.calc('parseBoolean', { string: 'True' }).func,
                axis: 'horizontal',
                direction: 'left',
                responsive: $('.dtm__in--mv').length > 0 ? true : false,
                await: '',
                swipe: master.calc('parseBoolean', { string: 'False' }).func,
                cssMediaQueries: master.calc('parseBoolean', { string: 'False' }).func
            });
			

        /* NOTE: This method fires twice for some odd reason */
			

            switch (Model.IsMobile) {
                // if on mobile
                case true:
                case 'True':

                    $('html').on('dtm/vimeo', function () {
                        if ($('[data-eflex-scale-vimeo-custom]').length === 0) {
                            _dtm.makeVimeoResponsive();
                        }
                    });

                    $('html').on('dtm/youtube', function () {
                        if ($('[data-eflex-scale-youtube-custom]').length === 0) {
                            _dtm.makeYouTubeResponsive();
                        }
                    });

                    // allow video to resize fluidly
                    $('video').removeAttr('width').removeAttr('height');

					
                /* NOTE: Need to tweak this method */
						/* $('video').eflex( 'scale' ); */
					

                    _dtm.setMobileNav(_dtm.jQuery.$nav, {
                        support: [{ pixel: _dtm.getCriteo }]
                    });

                    switch (DtmContext.Page.PageType) {
                        // if on index or sub page
                        case 'orderPage':
                        case 'SubPage':

							
                            _dtm.togglePagesOnMobile();
								

                            break;
                        // if on upsell page
                        case 'upsell':
							
                            _dtm.mobile.upsellImageToggle();
							

                            break;
                        // if on any other page
                        default:

							
                            _dtm.mobile.upsellImageToggle();
							

                            break;
                    }

				
                    // set all mobile lists to be responsive
                    _dtm.mobile.setResponsiveList();

                    // set mobile footer nav to be responsive
                    if ($('[data-eflex-footer-custom]').length === 0) {
                        _dtm.mobile.setResponsiveFooter();
                    }

                    if ($('[data-eflex-table-custom]').length === 0) {
                        // set order table to be responsive
                        _dtm.update.setResponsiveTable();
                        try {
                            // set event listener to re-apply responsive rules
                            registerEvent('CartChange', function () {
                                _dtm.update.setResponsiveTable();
                            });
                        } catch (e) {
                            console.log(e.message);
                        }
                    }

				

                    break;

                // if on desktop
                case false:
                case 'False':

                    $('.l-footer').eflex('stretch');

					
                    // if on upsell + desktop
                    switch (DtmContext.Page.PageType) {
                        case 'upsell':
                        case 'Custom':
                            // wait for upsell images to finish loading in
                            $('#upsellImage img').on('load', function () {
                                // update page dimensions to prevent any excess scrolling
                                $('.l-footer').eflex('stretch');
                            });
                            break;
                    }
					

                    break;
            }


            switch (DtmContext.Page.PageType) {
                case 'upsell':
                case 'Custom':

                    // get each upsell quantity
                    $('.c-brand--upsell .upsell__qty').each(function (index, value) {
                        // check for viewable options inside
                        if ($(value).height() > 0) {
                            // add spacing between each option
                            $(value).addClass('u-pad--bottom');
                        }
                    });

                    // enable upsell video to work
                    _dtm.enableUpsellVideo();
                    // set grid by the label
                    _dtm.setUpsellGridByLabel();

                    break;
            }

            // check if free shipping banner exists
            if ($('a[href*="freeshipping.com"]').length > 0) {
                $('a[href*="freeshipping.com"]').addClass('o-grid--block fn--center u-mar--vert fx--fade-in');
                $('a[href*="freeshipping.com"]:first').prependTo($('#content_top'));
                if ($('a[href*="freeshipping.com"]').length > 1) {
                    $('a[href*="freeshipping.com"]:last').appendTo($('#content_top'));
                }
            }

			
            if ($('[data-eflex-scroll-custom]').length === 0) {
                // enable scroll support
                $('').not($('.has-fancybox, ' + Model.IsMobile ? '[href^="#formWrap"], [href^="#mainContainer"]' : '')).eflex('scroll');
            }

			

            // check if eflex attribute exists
            if ($('[data-eflex]').length > 0) {
                // iterate eflex attributes
                $('[data-eflex]').each(function (index, value) {
                    // convert into array to check for multiple effects
                    var effects = $(value).data('eflex').split(' ');
                    // check if multiple effects are passed in
                    if (effects.length > 1) {
                        $.each(effects, function (type, effect) {
                            // trigger eflex
                            $(value).eflex(effect);
                        });
                    } else {
                        // trigger eflex
                        $(value).eflex($(value).data('eflex'));
                    }
                });
            }

            // role : adds autoplay parameter support to enable/disable Vimeo videos
            $('html').on('dtm/vimeo', function (vimeo) {
                var q = window.location.search;

                // check if autoplay parameter exists in the url
                if (q.match(/autoplay=0/i)) {
                    $.each(vimeo.api, function () {
                        // get video
                        var $video = $(this.element);
                        // pause video
                        this.pause();
                        // update source to reload video with new params
                        $video.attr('src', $video.attr('src').replace('autoplay=1', 'autoplay=0'));

                        // when video reloads
                        $video.on('load', function () {
                            // animate the video back into visiblity
                            $video.addClass('vimeo-is-ready');
                        });
                    });
                } else {
                    // animate the video into visiblity
                    $('iframe[src*="player.vimeo.com"]').addClass('vimeo-is-ready');
                }
            });

            // trigger framework js custom event
            $('html').trigger({ type: 'dtm/fwjs', dtm: _dtm });


            // trigger automateSteps on windows load
            //if allowAutomateSteps variable is initialized to false, do not call automateSteps()
            if ((typeof (allowAutomateSteps) == 'undefined' || allowAutomateSteps))
                _dtm.automateSteps();

			

            _dtm.scrollToVse();
        });

        

        $(document).ready(function () {

			
            _dtm.eflexLink('[data-code],[data-group-name]', {
                text: 'Remove',
                classes: 'is-selected',
                toggle: master.calc('parseBoolean', { string: 'True' }).func,
                swapClasses: master.calc('parseBoolean', { string: 'is-selected' }).func,
                preserveContent: master.calc('parseBoolean', { string: 'False' }).func,
                disableAfter: 0,
                onInit: null,
                onBefore: null,
                onAfter: null
					});
				

            $('[data-fancybox-url]').each(_dtm.AddFancyboxClass);
            

            $('body').on('click', '.has-popup', function (e) {
                try {
                    e.preventDefault();
                    _dtm.getPopup($(this).attr('href'));
                } catch (e) {
                    console.log(e.message);
                }
            });

            $('body').on('click', '.has-fancybox', function (e) {
                e.preventDefault();

                var $this = $(this), $fb = $this;

                try {
                    // set new deferred
                    var $defer = new $.Deferred();
                    // get href value
                    var href = $this.attr('href');
                    // get group name by rel attribute
                    var group = $this.attr('rel');
                    // extract hash for id value
                    var id = href.substr(1);
                    // check if this link triggers the Google Maps API
                    var gmap = href.match('map.aspx') || false;
                    // set printable
                    var isPrintable = 'is-not-printable';

                    // check if rel contains a group name
                    if (typeof group === 'string') {
                        // re-query fancybox and filter by the group name
                        var $group = $('.has-fancybox').filter('[rel="' + group + '"]');
                        // re-declare variable as empty array
                        $fb = [];
                        // we need to isolate the current element to work forward and reverse loops
                        $group.each(function (index, value) {
                            // first check if element in group matches the current element
                            if (value === $this.get(0)) {
                                // start on current element, loop towards length and push next elements into array
                                for (var i = index; i < $group.length; i++) {
                                    $fb.push({ src: $group.eq(i).attr('href'), href: $group.eq(i).attr('href') });
                                }
                                // loop towards the current index and push previous elements into array
                                for (var i = 0; i < index; i++) {
                                    $fb.push({ src: $group.eq(i).attr('href'), href: $group.eq(i).attr('href') });
                                }
                            }
                        });
                    }

                    // check if link contains a hash
                    if (href.charAt(0).match('#')) {
                        // check if content is printable
                        isPrintable = $(href)[0].hasAttribute('data-print') ? 'is-printable' : isPrintable;
                    }

                    // get width value
                    var w = $this.data('fancybox-width');
                    // get height value
                    var h = $this.data('fancybox-height');

                    // set config options
                    var o = {
                        maxWidth: gmap ? 500 : typeof w !== 'undefined' ? w : '90%',
                        maxHeight: gmap ? 300 : typeof h !== 'undefined' ? h : '90%',
                        wrapCSS: 'fancybox--' + isPrintable + ' c-brand',
                        fitToView: true,
                        autoSize: true,
                        closeClick: false,
                        touch: false,
                        openEffect: 'fade',
                        closeEffect: 'fade',
                        autoCenter: true,
                        afterShow: function () {
                            try {
                                // try triggering after show event on the pop up itself
                                $(this.href).trigger({
                                    type: 'dtm/fancybox/open', fancybox: this
                                });
                            } catch (e) {
                                console.log(e.message);
                            }

                            // otherwise, trigger the after show event on the pop up link
                            $this.trigger({
                                type: 'dtm/fancybox/open', fancybox: this
                            });
                        },
                        afterClose: function (fb) {
                            try {
                                // try triggering after close event on the pop up itself
                                $(fb.href).trigger({
                                    type: 'dtm/fancybox/close', fancybox: fb
                                });
                            } catch (e) {
                                // otherwise, trigger the after close event on the pop up link
                                $(fb.element).trigger({
                                    type: 'dtm/fancybox/close', fancybox: fb
                                });
                            }
                        }
                    };

                    // set the type based on the class
                    switch (true) {
                        case $this.hasClass('fancybox.ajax'):
                            o.type = 'ajax';
                            break;
                        case $this.hasClass('fancybox.iframe'):
                            o.type = 'iframe';
                            break;
                    }

                    // check if link supports any helper method
                    var method = $(this).data('fancybox-method');

                    // set private method to initialize Fancybox
                    var init = function () {
                        // load Fancybox
                        try {
                            $.fancybox.open($fb, o);
                        } catch (e) {
                            console.log(e.message);
                        }
                    };

                    // check if the helper method is a string
                    if (typeof method === 'string') {
                        try {
                            // try triggering the method from the api
                            _dtm.api.fancybox[method](this, $defer, o).done(function () {
                                if (typeof o.content === 'undefined') {
                                    console.log('please define the fancybox content option in your method');
                                } else {
                                    try {
                                        $.fancybox.open('<div>' + o.content + '</div>', o);
                                    } catch (e) {
                                        console.log(e.message);
                                        $.fancybox.open($this, o);
                                    }

                                }
                            });
                        } catch (e) {
                            // otherwise, report to console the error message
                            console.log('method name ' + method + ' could be called from _dtm.api.fancybox.', e.message);
                            // default to normal init
                            init();
                        }
                        // otherwise, default to normal init
                    } else {
                        init();
                    }

                } catch (e) {
                    console.log(e.message);
                }
            });

            // cart method : applies styling hook when cart contains items
            registerEvent('CartChange', function (cart) {
                var $table = $('.orderItemsTable, .c-brand--table');
                var items = _dtmShoppingCart.Items();

                if (items.length > 0) {
                    $table.addClass('c-brand--table--has-items');
                } else {
                    $table.removeClass('c-brand--table--has-items');
                }
            });

            /* OrderForm Checkbox Support */
            $("body").on("change", "input[name*='ActionCheckbox']:checkbox", handleOfferCheckboxChange);

            function handleOfferCheckboxChange() {
                var targetProductCode = $(this).data("target");
                var newProductCode = $(this).data("new");
                var requiredMessage = $(this).data("required");
                var i = $(this).attr("name").replace("ActionCheckbox", "");

                //check to make sure targetProductCode exists
                if (targetProductCode != 'undefined' && targetProductCode != '' && targetProductCode) {
                    if ($(this).is(":checked")) {
                        //Set MatchProductQuantity to attribute data-target when checked
                        if (newProductCode == 'undefined' || newProductCode == '' || !newProductCode) {
                            $('#MatchProductQuantity' + i).val(targetProductCode);
                        }
                        //Set ActionCode to attribute data-new (deluxe offer) when checked
                        else {
                            $('#ActionCode' + i).val(newProductCode);
                        }
                    }
                    else {
                        //Set MatchProductQuantity to empty when unchecked
                        if (newProductCode == 'undefined' || newProductCode == '' || !newProductCode) {
                            $('#MatchProductQuantity' + i).val('');
                        }
                        //Set ActionCode to attribute data-target (main offer) when unchecked
                        else {
                            $('#ActionCode' + i).val(targetProductCode);
                        }
                    }
                }
                else if (requiredMessage != 'undefined' && requiredMessage != '' && requiredMessage) {
                    if ($(this).is(":checked")) {
                        return true;
                    }
                    else {
                        //update to use pretty pop ups once worked out
                        alert(requiredMessage);
                        return false;
                    }
                }
                //trigger ActionQuantity change to update cart
                $('#ActionQuantity' + i).change();
            }
        });

        $('.has-fancybox').on('dtm/fancybox/open', function () {
            //_dtm.toggleFormUsability({ $target: $('[data-form-lightbox]'), status: true });
        });

        $('.has-fancybox').on('dtm/fancybox/close', function () {
            // _dtm.toggleFormUsability({ $target: $('[data-form-lightbox]'), status: false });
        });

    }(jQuery, document, window));
</script>

<div class="hide">
    

<div id="reviewOrder" >
    <div class="FormHeadlineL"><strong>STEP 2:</strong> Review your order</div>

    <style>
        .alignTextRight {
            text-align: right;
        }

        .alignTextLeft {
            text-align: left;
        }

        .disableToggleClick {
            pointer-events: none;
        }
    </style>

    <table id="orderReview" class="orderItemsTable reviewTable">
        <thead class="reviewTableHead">
            <tr>
                
                <th>Item</th>
                
                <th>Quantity</th>
                
                <th>Price</th>
                
                <th></th>
                
            </tr>
        </thead>
        <tbody class="reviewTableBody">
        </tbody>
        <tfoot class="reviewTableFoot alignTextRight">
            
            <tr>
                <td colspan="3">Sub Total:</td>
                <td>
                    <label class="subtotal"></label>
                </td>
            </tr>
            
            <tr>
                <td colspan="3">Shipping</td>
                <td>
                    <label class="phtotal"></label>
                </td>
            </tr>
            
            <tr>
                <td colspan="3">
                    <label for="zc">
                        State Tax:&nbsp;&nbsp;

                  <input type="text" class="zc" id="zc" name="zc" value="" placeholder="Enter Zip Code" /></label>
                </td>
                <td>
                    <span class="taxtotal">$0.00</span></td>
            </tr>
            
            <tr>
                <td colspan="3"><b>Order Total</b></td>
                <td>
                    <span class="summary-total"></span></td>
            </tr>
            
        </tfoot>
    </table>

    <div id="orderFormReviewTableItems">

        
    </div>
</div>

<script type="text/javascript">
    var _firstIndex = '';
    var _firstRun = true;

    var cartItems = [];
    var modifierArray = [];

    function getCartUrl(type) {
        var m = '' == '' ? '' : 'mid=';
        var a = '' == '' ? '' : 'a=';
        var s = '' == '' ? '' : 's=';
        var c = '' == '' ? '' : 'clickId=';

        var arr = [m, a, s, c]

        for (var i = 0; i < arr.length; i++) {
            if (arr[i] == '') {
                arr.splice(i, 1);
                i--;
            }
        }

        var qs = (m + a + s + c) == '' ? '' : ('?' + arr.join('&'));

        var url = '/Cart/' + type + '/Index' + qs;
        return url;
    }



    function loadAllItemStates() {
        handleCartChange();

        var preloadedItems = [];
        var enableEditableQuantity = true;
               

        if (preloadedItems.length > 0) {
            handleCartChange();
        } else if (!enableEditableQuantity) {
            handleCartChange();
        }

        $.each($('[data-condition-missing][data-condition-value]:not([data-condition])'), function () {
            var code = $(this).attr('data-condition-missing');
            var regex = new RegExp("^" + code + "$");
            var cartItem = _dtmShoppingCart.SearchItems(regex);
            if ((preloadedItems.length == 0 && cartItem.length <= 0) || (preloadedItems.length > 0 && preloadedItems.indexOf(code) <= 0)) {
                setDataCondition(this);
            }
        });
    }

    function checkboxToggleXor(removeItems) {

        for (var i = 0; i < removeItems.length; i++) {

            $('#' + removeItems[i] + '').prop('checked', false);
        }

    }

    function radioToggleXor(removeItems) {

        for (var i = 0; i < removeItems.length; i++) {

            $('input[value=' + removeItems[i] + ']').prop('checked', false);
        }

    }

    function validateTextBoxInput(element, maxQuantity) {
        var value = $(element).val();
        var valueInt = parseInt(value);
        var newValue = 0;

        if (valueInt > maxQuantity) {
            newValue = maxQuantity;
        }
        else if (isNaN(valueInt) || valueInt <= 0) {
            newValue = 0;
        }
        else {
            newValue = valueInt;
        }
        $(element).val(newValue);
    }

    function isSelectorModified(selector) {

        var isDataSelect = $(selector).is('select') && typeof $(selector).attr('data-select') !== "undefined";
        var isModified = false;

        if (isDataSelect) {
            var selectedOption = $(selector).find(':selected');
            isModified = ($(selector).attr('data-code-modifier') != null &&
                $(selector).attr('data-code-modifier').length > 0 &&
                $(selectedOption).attr('data-code-alt') != null &&
                $(selectedOption).attr('data-code-alt').length > 0 &&
                ($('#' + $(selector).attr('data-code-modifier')).is(':checked') || $('[name=' + $(selector).attr('data-code-modifier') + '][value=true]').is(':checked')));
        } else {
            isModified = ($(selector).attr('data-code-modifier') != null &&
                $(selector).attr('data-code-modifier').length > 0 &&
                $(selector).attr('data-code-alt') != null &&
                $(selector).attr('data-code-alt').length > 0 &&
                ($('#' + $(selector).attr('data-code-modifier')).is(':checked') || $('[name=' + $(selector).attr('data-code-modifier') + '][value=true]').is(':checked')));
        }

        return isModified;
    }

    function AddToModifierArray(modifierName) {

        var alreadyExists = false;
        if (modifierArray.length > 0) {
            modifierArray.forEach(function (ele) {
                if (ele == modifierName) {
                    alreadyExists = true;
                }
            });
        }
        if (!alreadyExists) {
            modifierArray.push(modifierName);
        }
    }

    function handleModifierChangeAction(name, type) {

        var modifiableSelectors = $('[data-code-modifier=' + name + ']');
        var datacode = "";
        var bonusArray = [];
        var removeItems = [];
        var firstSelectorQuantity = 0;
        var quantity = 0;

        switch (type) {
            case 'checkbox':
                var isModified = $('[name=' + name + ']').is(':checked');

                break;

            case 'radio':
                var isModified = $('[name=' + name + ']:checked').val() == 'true';

                break;
        }


        if (modifiableSelectors.length > 0) {

            for (var i = 0; i < modifiableSelectors.length; i++) {

                var element = $(modifiableSelectors[i]);
                var isSelect = element.is('select') && typeof element.attr('data-select') === "undefined";
                var isDataSelect = element.is('select') && typeof element.attr('data-select') !== "undefined";
                var isRadioOrCB = 'radio,checkbox'.indexOf(element.attr('type')) >= 0;

                if (i == 0) {

                    if (isSelect) {
                        firstSelectorQuantity = isSelect ? element.val() : 1;
                    }
                    else if (isDataSelect) {
                        firstSelectorQuantity = element.attr('data-qty-id') != null ? $('#' + element.attr('data-qty-id')).val() : 1;
                    }
                    else if (isRadioOrCB) {
                        if (element.is(':checked')) {

                            firstSelectorQuantity = element.attr('data-qty-id') != null ? $('#' + element.attr('data-qty-id')).val() : 1;
                        }
                    }

                    if (firstSelectorQuantity > 0) {

                        element = isDataSelect ? element.find(":selected") : element;
                        dataCode = isModified ? element.attr('data-code-alt') : isDataSelect ? element.val() : element.attr('data-code');

                        var bonusAddRemoveArrays = bonusItemHandler(isModified, firstSelectorQuantity, $(modifiableSelectors[i]));

                        bonusArray = bonusArray.concat(bonusAddRemoveArrays.bonusItems);
                        removeItems = removeItems.concat(bonusAddRemoveArrays.removeItems);

                        if (isDataSelect) {
                            removeItem = isModified ? element.val() : element.attr('data-code-alt');
                            removeItems.push(removeItem);
                        }


                    } else {
                        dataCode = "";
                    }

                }
                else {

                    if (isSelect) {
                        quantity = isSelect ? element.val() : 1;
                    }
                    else if (isDataSelect) {
                        quantity = element.attr('data-qty-id') != null ? $('#' + element.attr('data-qty-id')).val() : 1;
                    }
                    else if (isRadioOrCB) {
                        if (element.is(':checked')) {

                            quantity = element.attr('data-qty-id') != null ? $('#' + element.attr('data-qty-id')).val() : 1;
                        } else {
                            quantity = 0;
                        }
                    }
                    if (quantity > 0) {

                        var bonusAddRemoveArrays = bonusItemHandler(isModified, quantity, $(modifiableSelectors[i]));
                        element = isDataSelect ? element.find(":selected") : element;

                        var selector = isModified ? element.attr('data-code-alt') : isDataSelect ? element.val() : element.attr('data-code');

                        if (dataCode == "") {
                            dataCode = selector;
                            firstSelectorQuantity = quantity;
                        } else {
                            bonusArray.push({ Id: selector, Qty: quantity })
                        }

                        bonusArray = bonusArray.concat(bonusAddRemoveArrays.bonusItems);
                        removeItems = removeItems.concat(bonusAddRemoveArrays.removeItems);

                        if (isDataSelect) {
                            removeItem = isModified ? element.val() : element.attr('data-code-alt');
                            removeItems.push(removeItem);
                        }

                    }
                }
            }
        }

        if (firstSelectorQuantity > 0) {
            handleCartChange(dataCode, firstSelectorQuantity, null, removeItems, bonusArray, event);
        }
    }

    function bonusItemHandler(isModified, quantity, selector) {

        var bonusItemsArray = [];
        var removeItemsArray = [];


        if (isModified) {
            //Add bonusItems
            if (selector.attr('data-match-alt') != null && selector.attr('data-match-alt').length > 0) {
                var tempBonusArray = selector.attr('data-match-alt').split(',');
                tempBonusArray.forEach(function (ele) {
                    bonusItemsArray.push({ Id: ele, Qty: quantity });
                });
            }

            //removebonusItems
            if (selector.attr('data-match') != null && selector.attr('data-match').length > 0) {
                var tempBonusArray = selector.attr('data-match').split(',');
                tempBonusArray.forEach(function (ele) {
                    removeItemsArray.push(ele);
                });
            }

            removeItemsArray.push(selector.attr('data-code'));
        }
        else {
            //Add bonusItems
            if (selector.attr('data-match') != null && selector.attr('data-match').length > 0) {
                var tempBonusArray = selector.attr('data-match').split(',');
                tempBonusArray.forEach(function (ele) {
                    bonusItemsArray.push({ Id: ele, Qty: quantity });
                });
            }

            //removebonusItems
            if (selector.attr('data-match-alt') != null && selector.attr('data-match-alt').length > 0) {
                var tempBonusArray = selector.attr('data-match-alt').split(',');
                tempBonusArray.forEach(function (ele) {
                    removeItemsArray.push(ele);
                });
            }

            if (selector.attr('data-code-alt') != null && selector.attr('data-code-alt').length > 0) {
                removeItemsArray.push(selector.attr('data-code-alt'));
            }
        }

        return {
            bonusItems: bonusItemsArray,
            removeItems: removeItemsArray
        };
    }

    function CreateModifierChangeAction(modifierArray) {

        if (modifierArray.length > 0) {

            modifierArray.forEach(function (ele) {

                var modifierName = ele;

                $(document).on('change', '[name=' + modifierName + '], #' + modifierName + '', function () {

                    var type = $(this).attr('type');

                    handleModifierChangeAction(modifierName, type);
                });

            });
        }
    }

    function getXorList(element) {

        var xor = $(element).attr('data-code-xor');
        var isDataCheckbox = $(element).attr('data-checkbox');
        isDataCheckbox = (typeof isDataCheckbox !== typeof undefined);
        var listItems = [];

        if (xor != null && xor.length > 0) {
            var allXORs = xor.split(',');
            for (var i = 0; i < allXORs.length; i++) {
                var singleXOR = allXORs[i];
                setToggleButton(singleXOR, 'Remove');
                listItems.push(singleXOR);
            };
        }

        if (isDataCheckbox) {
            checkboxToggleXor(listItems);
        }

        return listItems;
    }

    function dataMatchProductQuantity(mainItem, bonusItems, dataMatchTrue, event) {

        if (dataMatchTrue) {
            if ((typeof bonusItems != "undefined" && bonusItems != null && bonusItems.length > 0) && (typeof mainItem != "undefined" && mainItem != null && mainItem.length > 0)) {
                var datacode = mainItem;

                var bonusItems = bonusItems.split(',');
                var removeBonusItems = bonusItems.slice();


                var qty = $('[data-cart-code=' + datacode + 'Quantity]').children('[name^=ActionQuantity]').val();
                qty = parseInt(qty);

                if (!isNaN(qty)) {


                    if (qty > 0) {

                        var firstBonusItem = "";
                        var extraBonusItems = [];

                        for (var i = 0; i < bonusItems.length; i++) {

                            if (i == 0) {
                                firstBonusItem = bonusItems[i];
                            }
                            else {
                                extraBonusItems.push({ Id: bonusItems[i], Qty: qty });
                            }
                        }
                        if (firstBonusItem != "") {
                            handleCartChange(firstBonusItem, qty, null, [], extraBonusItems, event);
                        }
                    }
                    else {
                        handleCartChange(datacode, qty, null, removeBonusItems, null, event);
                    }
                }
            }

        }
        else {
            handleCartChange();
        }

    }

    function OnVSCookieLoaded() {
        $('input.zc').keyup(function () {
            updateZip(this.value, getState(), getCountry());
        });

        $('select.shipOptions').change(function () {
            handleCartChange();
        });

        $('#BillingZip, #ShippingZip').keyup(function () {

            var isShipCheckboxChecked = $('#ShippingIsDifferentThanBilling').is(':checked');

            if (this.id == 'ShippingZip') {
                lastChangeType = 'Shipping';
            } else {
                lastChangeType = '';
            }

            if (isShipCheckboxChecked) {
                $('.zc').val($('#ShippingZip').val());
                updateZip($('#ShippingZip').val(), getState(), getCountry());
            }
            else {
                $('.zc').val(this.value);
                updateZip(this.value, getState(), getCountry());
            }
        });

        $('#BillingState, #ShippingState, #BillingCountry, #ShippingCountry').keyup(function () {
            updateZip(getZip(), getState(), getCountry());
        });

        $("[name*='ActionToggle']").click(function () {
            var type = $(this).attr('data-toggle-type') || 'set';
            var toggleTargetIndex = $(this).attr('name').replace('ActionToggle', '');
            var toggleValue = $(this).attr('data-toggle-value') || '1';

            var actionCode = $('[name="ActionCode' + toggleTargetIndex + '"]') || [];
            var actionQuantity = $('[name="ActionQuantity' + toggleTargetIndex + '"]') || [];
            if (toggleTargetIndex == '' || actionCode.length == 0 || actionQuantity.length == 0) {
                console.error('Invalid ActionToggle configuration for ' + toggleTarget);
                return;
            }
            var currentValue = actionQuantity.val();

            if (type == 'add') {
                newValue = currentValue + 1;
            } else {
                if (currentValue == toggleValue) {
                    newValue = 0;
                } else {
                    newValue = toggleValue;
                }
            }
            actionQuantity.val(newValue);
            handleCartChange();
        });

        $('input[name*="ActionCode"][data-default]').each(function (i, item) {
            if ('radio,checkbox'.indexOf($(item).attr('type')) >= 0) {
                var id = $(item).attr('id');
                var name = $(item).attr('name');
                var index = id.replace('ActionCode', '');
                var value = $(item).val();

                var labelFor = $('label[for="' + id + '"]');
                if (labelFor.length > 0) {
                    labelFor.attr('for', 'Action' + index);
                } else {
                    labelFor = $('#ActionCode0').parents('label');
                    if (labelFor.length > 0) {
                        labelFor.attr('for', 'Action' + index);
                    }
                }

                $(this)
                    .attr('id', 'Action' + index)
                    .attr('name', 'Action' + index);
                $(this).before('<input id="' + id + '" name="' + name + '" type="hidden" value="' + value + '" data-default="' + $(item).attr('data-default') + '" data-upgrade="' + $(item).attr('data-upgrade') + '">')
            }
        });

        $('input[data-default]').click(function () {
            var index = ($(this).attr('id') || '').replace('Action', '');
            var currentValue = $(this).val();
            var defaultValue = $(this).attr('data-default');
            var toggleValue = $(this).attr('data-upgrade');
            var newValue;
            if ($(this).is(":checked")) {
                newValue = toggleValue;
            } else {
                newValue = defaultValue;
            }
            $(this).val(newValue);
            if ($('#ActionCode' + index).length > 0) {
                $('#ActionCode' + index).val(newValue);
                handleCartChange();
            } else {
                $('a[data-code="' + currentValue + '"]').attr('data-code', newValue);
                _dtmShoppingCart.UpgradeItem(currentValue, newValue);
            }
        });



        $("[name*='ActionQuantity']").each(function (i, item) {
            var index = (item.name || '').replace(/[^0-9]/g, '');
            if (_firstIndex == '') {
                _firstIndex = index;
            }
            $(item)
                .attr('data-index', index)
                .attr('class', ($(item).attr('class') ? $(item).attr('class') : '') + ' ddl')
                .change(handleCartChange);

            if ($('[name="ActionCode' + index + '"]').length == 0 || 'radio,checkbox'.indexOf($('[name="ActionCode' + index + '"]').attr('type')) >= 0 || $('[name="ActionCode' + index + '"]').is('select')) {
                $('[name="ActionCode' + index + '"]').change(handleCartChange);
            }
            if ($('[name="MatchProductQuantity' + index + '"]').length == 0 || 'radio,checkbox'.indexOf($('[name="MatchProductQuantity' + index + '"]').attr('type')) >= 0) {
                $('[name="MatchProductQuantity' + index + '"]').change(handleCartChange);
            }
        });

        
        var onDataCodesLoaded = function () {
            var modifiers = [];
            var dataMatchArray = [];

            registerEvent("ActionQuantityChange", function (e) {

                if (typeof onActionQuantityChange == 'function') {
                    onActionQuantityChange(e);
                }

                var actionCodeClicked = $('#ActionCode' + e.detail + '').val();
                if (dataMatchArray.length > 0) {
                    var mainItemArray = [];
                    $.each(dataMatchArray, function (idx, ele) {
                        mainItemArray.push(ele.mainItem);
                    });

                    //Check if ActionCode clicked is one of the main items in dataMatchArray , if not just call handleCartChange()
                    if (mainItemArray.indexOf(actionCodeClicked) > -1) {
                        $.each(dataMatchArray, function (idx, ele) {

                            var mainItem = ele.mainItem;
                            var bonusItems = ele.bonusItems;

                            if (actionCodeClicked == mainItem) {
                                //Register changeAction on main item ActionQuantity to inherit bonus
                                dataMatchProductQuantity(mainItem, bonusItems, bonusItems != "", e);
                            }

                        });
                    }
                    else {
                        handleCartChange();
                    }
                }
                else {
                    handleCartChange();
                }
            });
            $('[data-code-modifier]').each(function (i, item) {
                if (modifiers.indexOf($(item).attr('data-code-modifier')) < 0) {
                    modifiers.push($(item).attr('data-code-modifier'));
                }

            });

            for (var i = 0; i < modifiers.length; i++) {
                var modifier = modifiers[i];

                if ($('#' + modifier).length > 0) {
                    $(document).on('change', '#' + modifier, function (event) {
                        var mod = event.target.id;
                        var btns = $('[data-code][data-code-toggle=true][data-code-alt][data-code-modifier=' + mod + ']');
                        var sels = $('select[data-code-modifier=' + mod + ']');
                        var groupBtns = $('[data-group-name][data-code-modifier=' + mod + ']');
                        var isChecked = $('#' + mod).is(':checked');
                        var extraItems = [];
                        var removeItems = [];
                        var mainItem = '';
                        var mainQty = 0;

                        function setCartItemsForGroup(oldCodeSelector, newCodeSelector) {

                            var oldCode = isChecked ? oldCodeSelector : newCodeSelector;
                            var newCode = isChecked ? newCodeSelector : oldCodeSelector;
                            var regex = new RegExp("^" + oldCode + "$");
                            var cartItem = _dtmShoppingCart.SearchItems(regex);
                            var newQty = cartItem.length > 0 ? cartItem[oldCode].qty : 1;

                            if (cartItem.length > 0) {

                                if (mainItem == '' && mainQty == 0) {
                                    mainItem = newCode;
                                    mainQty = newQty;

                                }
                                else {
                                    extraItems.push({
                                        Id: newCode,
                                        Qty: newQty
                                    });
                                }
                                if (removeItems.indexOf(oldCode) < 0) {
                                    removeItems.push(oldCode);
                                }

                            }


                        }

                        groupBtns.each(function (idx, btn) {

                            var groupName = $(btn).attr('data-group-name');
                            var isCheckbox = $(btn).attr('data-checkbox') != null && $(btn).attr('data-checkbox').length > 0 ? $(btn).attr('data-checkbox') : null;

                            if (isCheckbox == "true") {

                                $('[name=' + groupName + ']:checked').each(function (idx, cbx) {



                                    var oldCodeSelector = $(cbx).val();
                                    var newCodeSelector = $(cbx).attr('data-code-alt');

                                    setCartItemsForGroup(oldCodeSelector, newCodeSelector);
                                });


                            }
                            else {

                                var oldCodeSelector = $('[name=' + groupName + ']:checked').val();
                                var newCodeSelector = $('[name=' + groupName + ']:checked').attr('data-code-alt');
                                setCartItemsForGroup(oldCodeSelector, newCodeSelector);
                            }

                        });

                        btns.each(function (idx, btn) {
                            var oldCode = isChecked ? $(btn).attr('data-code') : $(btn).attr('data-code-alt');
                            var newCode = isChecked ? $(btn).attr('data-code-alt') : $(btn).attr('data-code');
                            var newDataMatch = isChecked ? $(btn).attr('data-match-alt') : $(btn).attr('data-match');
                            var oldDataMatch = isChecked ? $(btn).attr('data-match') : $(btn).attr('data-match-alt');
                            var regex = new RegExp("^" + oldCode + "$");
                            var cartItem = _dtmShoppingCart.SearchItems(regex);
                            var newQty = cartItem.length > 0 ? cartItem[oldCode].qty : 1;

                            if (cartItem.length > 0) {
                                if (mainItem == '' && mainQty == 0) {
                                    mainItem = newCode;
                                    mainQty = newQty;

                                }
                                else {
                                    extraItems.push({
                                        Id: newCode,
                                        Qty: newQty
                                    });
                                }

                                if (removeItems.indexOf(oldCode) < 0) {
                                    removeItems.push(oldCode);
                                }

                                if (newDataMatch != null) {

                                    var bonusItems = newDataMatch.split(',');

                                    for (var i = 0; i < bonusItems.length; i++) {
                                        extraItems.push({
                                            Id: bonusItems[0],
                                            Qty: newQty
                                        });
                                    }

                                }
                                if (oldDataMatch != null) {

                                    if (oldDataMatch.length > 0) {
                                        var oldBonusItems = oldDataMatch.split(',');
                                        for (var i = 0; i < oldBonusItems.length; i++) {
                                            removeItems.push(oldBonusItems[i]);
                                        }

                                    }
                                }
                            }
                        });
                        sels.each(function (idx, sel) {
                            var selectedOption = $(sel).find(":selected");
                            var oldCode = isChecked ? $(selectedOption).attr('value') : $(selectedOption).attr('data-code-alt');
                            var newCode = isChecked ? $(selectedOption).attr('data-code-alt') : $(selectedOption).attr('value');
                            var regex = new RegExp("^(" + oldCode + ")$|^(" + newCode + ")$");
                            var cartItem = _dtmShoppingCart.SearchItems(regex);
                            var newQty = cartItem.length > 0 ? cartItem.TotalQuantity : 1;

                            if (cartItem.length > 0) {
                                if (mainItem == '' && mainQty == 0) {
                                    mainItem = newCode;
                                    mainQty = newQty;

                                }
                                else {
                                    extraItems.push({
                                        Id: newCode,
                                        Qty: newQty
                                    });
                                }

                                if (removeItems.indexOf(oldCode) < 0) {
                                    removeItems.push(oldCode);
                                }
                            }
                        });
                        if (mainItem != '') {
                            handleCartChange(mainItem, mainQty, null, removeItems, extraItems, event);
                        }
                    });

                }
            };
            $("[data-code]").each(function (i, item, event) {
                
                if (item.nodeName == 'A') {
                    $(item).attr('href', 'javascript:void(0);');
                }
                

                var selectId = $(this).attr('data-select-id');

                //Items with Select Dropdowns
                var isSelect = $(item).is('select');

                if (isSelect && typeof $(item).attr('data-select') !== 'undefined') {

                    var hasQtySelect = $(this).attr('data-qty-id');
                    var selectItem = $('#' + $(this).attr('id'));

                    if (hasQtySelect != null && hasQtySelect.length > 0) {
                        $('#' + hasQtySelect + '').change(function () {
                            selectItem.trigger('change');

                        });

                    }

                    var modifierId = $(item).attr('data-code-modifier');
                    if (typeof modifierId !== "undefined") {
                        //Change action for DataModifier with no AddToCart button
                        AddToModifierArray(modifierId);
                    }

                    $(item).unbind('change');
                    $(item).change(function () {
                        var datacode = $(this).val() == "0" ? "" : $(this).val();
                        var removeItems = [];
                        var selectedOption = $(item).find(":selected");
                        var overrideQty = (hasQtySelect != null && hasQtySelect.length > 0) ? parseInt($('#' + hasQtySelect + '').val()) : 1;
                        var isModified = isSelectorModified(item) && (selectedOption != null && selectedOption.length > 0) && ($(selectedOption).attr('data-code-alt') != null && $(selectedOption).attr('data-code-alt').length > 0);
                        var modifierName = ($(this).attr('data-code-modifier') != null && $(this).attr('data-code-modifier').length > 0) ? $(this).attr('data-code-modifier') : "";
                        var ifModifierRadio = modifierName != "" ? 'radio'.indexOf($('[name=' + modifierName + ']').attr('type')) >= 0 : false;
                        var preventAction = false;

                        if (ifModifierRadio) {
                            preventAction = !isModified && !$('[name=' + modifierName + ']').is(':checked') && (typeof $(this).attr('data-enforce-modifier') != "undefined");
                        }

                        datacode = isModified ? $(selectedOption).attr('data-code-alt') : datacode;

                        var selectItems = $(this).find('option[value != ""][value != "0"]').map(function () { return this.value }).get().join(",");
                        var altItems = $(this).find('option[value != ""][value != "0"][data-code-alt]').map(function () { return $(this).attr('data-code-alt'); }).get().join(",");

                        var sItems = selectItems + "," + altItems;

                        if (sItems != null && sItems.length > 0) {
                            var allItems = sItems.split(',');
                            for (var i = 0; i < allItems.length; i++) {
                                var singleItems = allItems[i];
                                removeItems.push(singleItems);
                            };
                        }

                        if (!preventAction) {
                            handleCartChange(datacode, overrideQty, null, removeItems, null, event);
                        }

                    });


                }

                //Toggle Button logic
                else {
                    var isRadioOrCB = 'radio,checkbox'.indexOf($(item).attr('type')) >= 0;

                    //PreSelected add-to-cart button on load
                    var isPreselected = $(item).attr('data-pre-selected') != null && $(item).attr('data-pre-selected').length > 0;

                    //Data Match used for bonus items                   
                    var dataMatch = ($(this).attr('data-match') != null && $(this).attr('data-match').length > 0) ? $(this).attr('data-match') : "";
                    var dataMatchAlt = $(this).attr('data-match-alt') != null && $(this).attr('data-match-alt').length > 0 ? $(this).attr('data-match-alt') : "";

                    var dataCode = $(this).attr('data-code');
                    var dataCodeAlt = $(this).attr('data-code-alt');

                    if (dataMatch != "") {
                        dataMatchArray.push({ mainItem: dataCode, bonusItems: dataMatch });
                    }
                    if (dataMatchAlt != "") {
                        dataMatchArray.push({ mainItem: dataCodeAlt, bonusItems: dataMatchAlt });
                    }

                    $(item).unbind('click');

                    //if Radio or Checkbox without toggle button , set State on load
                    if (isRadioOrCB) {
                        var datacode = ($(this).attr('data-code') != null && $(this).attr('data-code').length > 0) ? $(this).attr('data-code') : "";
                        var isModified = isSelectorModified(item);
                        datacode = isModified ? $(this).attr('data-code-alt') : datacode;
                        var hasQtySelect = $(this).attr('data-qty-id');
                        var overrideQty = (hasQtySelect != null && hasQtySelect.length > 0) ? parseInt($('#' + hasQtySelect + '').val()) : 1;
                        var bonusItems = isModified ? $(this).attr('data-match-alt') : $(this).attr('data-match');
                        var additionalItems = [];
                        var removeItems = [];
                        if (bonusItems != null && bonusItems.length > 0) {
                            var bonusItemArray = bonusItems.split(',');
                            for (var i = 0; i < bonusItemArray.length; i++) {

                                additionalItems.push({ Id: bonusItemArray[i], Qty: overrideQty });
                            }
                        }

                        if (datacode != "") {
                            if ($(this).is(':checked')) {
                                if ($(this).is(':radio')) {
                                    removeItems = $(this).attr('data-code-xor') != null ? $(this).attr('data-code-xor').split(',') : [];
                                }
                                handleCartChange(datacode, overrideQty, null, removeItems, additionalItems, event);
                            }
                        }

                        var hasModifier = $(item).attr('data-code-modifier') != null && $(item).attr('data-code-modifier').length > 0;

                        if (hasModifier) {

                            var modifierId = $(item).attr('data-code-modifier');
                            var groupName = $(this).attr('name');
                            var removeItems = [];

                            $('[name="' + groupName + '"]').each(function (i, groupItem) {
                                var tempdatacode = $(groupItem).attr('data-code');

                                if (hasModifier) {
                                    var alt = $(groupItem).attr('data-code-alt');
                                    removeItems.push(alt);
                                }

                                if (tempdatacode != null && tempdatacode.length > 0) {
                                    removeItems.push(tempdatacode);
                                }
                            });

                            //Change action for DataModifier with no AddToCart button
                            AddToModifierArray(modifierId);

                        }

                        if (hasQtySelect != null && hasQtySelect.length > 0) {

                            var selectQtyId = hasQtySelect;

                            $(document).on('change', '#' + selectQtyId, function () {

                                var isModified = isSelectorModified(item);
                                datacode = isModified ? $(item).attr('data-code-alt') : $(item).attr('data-code');
                                var active = isModified ? $('[data-code-alt=' + datacode + ']').is(':checked') : $('[data-code=' + datacode + ']').is(':checked');
                                var overrideQty = $(this).val();
                                var dataMatch = ($(item).attr('data-match') != null && $(item).attr('data-match').length > 0) ? $(item).attr('data-match') : "";
                                var dataMatchAlt = $(item).attr('data-match-alt') != null && $(item).attr('data-match-alt').length > 0 ? $(item).attr('data-match-alt') : "";
                                var dataMatchList = isModified ? dataMatchAlt : dataMatch;
                                var bonusArray = [];

                                if (dataMatchList.length > 0 && dataMatchList != null) {

                                    var bonusItems = dataMatchList.split(',');

                                    for (var i = 0; i < bonusItems.length; i++) {
                                        bonusArray.push({ Id: bonusItems[i], Qty: overrideQty });
                                    }
                                }
                                if (active) {

                                    handleCartChange(datacode, overrideQty, null, [], bonusArray, event);
                                }
                            });
                        }
                    }


                    if (isSelect && $(item).attr('data-select') == null) {
                        var hasModifier = $(item).attr('data-code-modifier') != null && $(item).attr('data-code-modifier').length > 0;
                        var renderItem = true;
                        var hasModifier = ($(this).attr('data-code-modifier') != null && $(this).attr('data-code-modifier').length > 0
                            && $(this).attr('data-code-alt') != null && $(this).attr('data-code-alt').length > 0);

                        if (hasModifier) {
                            var modifierName = $(this).attr('data-code-modifier');
                            var ifModifierCheckbox = 'checkbox'.indexOf($('[name=' + modifierName + ']').attr('type')) >= 0;
                            var ifModifierRadio = 'radio'.indexOf($('[name=' + modifierName + ']').attr('type')) >= 0;

                            if (ifModifierCheckbox) {
                                var isModified = $('[name=' + modifierName + ']').is(':checked');
                            }
                            if (ifModifierRadio) {
                                var isModified = $('[name=' + modifierName + ']:checked').val() == "true";
                                if (!$('[name=' + modifierName + ']').is(':checked')) {
                                    renderItem = false;
                                }
                            }

                            // 
                            AddToModifierArray(modifierName);

                        }
                        datacode = isModified ? $(item).attr('data-code-alt') : $(item).attr('data-code');
                        var qty = $(item).val();
                        var bonusItemArray = [];
                        if (dataMatchArray.length > 0) {

                            dataMatchArray.forEach(function (ele) {
                                if (datacode == ele.mainItem) {
                                    bonusItemArray.push({ Id: ele.bonusItems, Qty: qty });
                                }
                            });

                        }
                        //Add item on load
                        if (renderItem) {
                            var itemCart = getItems();
                            if (itemCart.length < 1) {
                                handleCartChange(datacode, qty, null, [], bonusItemArray, event);
                            }
                        }

                    }

                    var eventAction = isSelect ? "change" : "click";

                    $(item).bind(eventAction, function (event) {
                        var datacode = $(this).attr('data-code');
                        isRadioOrCB = 'radio,checkbox'.indexOf($(this).attr('type')) >= 0;
                        var inputGroupName = isRadioOrCB ? $(this).attr('name') : "";
                        var isToggleButton = $(this).attr('data-code-toggle') != null && $(this).attr('data-code-toggle').length > 0 && $(this).attr('data-code-toggle') == 'true';
                        var removeItems = [];
                        var isModified = isSelectorModified(item);
                        var modifierName = ($(this).attr('data-code-modifier') != null && $(this).attr('data-code-modifier').length > 0) ? $(this).attr('data-code-modifier') : "";
                        var ifModifierRadio = modifierName != "" ? 'radio'.indexOf($('[name=' + modifierName + ']').attr('type')) >= 0 : false;
                        var preventAction = false;
                        if (ifModifierRadio) {
                            preventAction = !isModified && !$('[name=' + modifierName + ']').is(':checked') && (typeof $(this).attr('data-enforce-modifier') != "undefined");
                        }

                        datacode = isModified ? $(this).attr('data-code-alt') : datacode;

                        $('[data-code-toggle=true]').addClass('disableToggleClick');

                        if (inputGroupName != null && inputGroupName.length > 0) {
                            $('[name="' + inputGroupName + '"]').each(function (i, groupItem) {
                                var tempdatacode = $(groupItem).attr('data-code');

                                if (isModified) {
                                    var alt = $(groupItem).attr('data-code-alt');
                                    removeItems.push(alt);
                                }

                                if (tempdatacode != null && tempdatacode.length > 0) {
                                    removeItems.push(tempdatacode);
                                }
                            });
                        }

                        if ($('[data-qty="' + datacode + '"]').length > 0) {
                            var overrideQty = $('[data-qty="' + datacode + '"]').val();
                            handleCartChange(datacode, overrideQty, null, removeItems, null, event);
                        }
                        else if (selectId != null && selectId.length > 0 && !isToggleButton) {

                            var regex = new RegExp("^" + datacode + "$");
                            var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                            var overrideQty = active ? 0 : $('#' + selectId).val();
                            handleCartChange(datacode, overrideQty, null, removeItems, null, event);
                        }
                        else if (isSelect && $(item).attr('data-select') == null) {
                            var overrideQty = $(this).val();
                            var renderItem = true;
                            var hasModifier = ($(this).attr('data-code-modifier') != null && $(this).attr('data-code-modifier').length > 0
                                && $(this).attr('data-code-alt') != null && $(this).attr('data-code-alt').length > 0);

                            if (hasModifier) {
                                var modifierName = $(this).attr('data-code-modifier');
                                var ifModifierCheckbox = 'checkbox'.indexOf($('[name=' + modifierName + ']').attr('type')) >= 0;
                                var ifModifierRadio = 'radio'.indexOf($('[name=' + modifierName + ']').attr('type')) >= 0;

                                if (ifModifierCheckbox) {
                                    var isModified = $('[name=' + modifierName + ']').is(':checked');
                                }
                                if (ifModifierRadio) {
                                    var isModified = $('[name=' + modifierName + ']:checked').val() == "true";
                                    if (!$('[name=' + modifierName + ']').is(':checked')) {
                                        renderItem = false;
                                    }
                                }

                            }

                            var removeItem = isModified ? $(this).attr('data-code') : $(this).attr('data-code-alt');
                            var bonusItemArray = [];
                            datacode = isModified ? $(this).attr('data-code-alt') : datacode;

                            if (dataMatchArray.length > 0) {

                                var datacodeSelected = isModified ? $(this).attr('data-code-alt') : datacode;
                                dataMatchArray.forEach(function (ele) {


                                    if (datacodeSelected == ele.mainItem) {
                                        var tempBonusItemArray = ele.bonusItems.split(',');

                                        tempBonusItemArray.forEach(function (bonusItem) {
                                            bonusItemArray.push({ Id: bonusItem, Qty: overrideQty });
                                        });

                                    }

                                });

                            }

                            removeItems.push(removeItem);

                            removeItems = removeItems.concat(getXorList(this));

                            if (renderItem) {
                                handleCartChange(datacode, overrideQty, null, removeItems, bonusItemArray, event);
                            }
                        }

                        else if (isToggleButton) {

                            var isModified = ($(this).attr('data-code-modifier') != null && $(this).attr('data-code-modifier').length > 0
                                && $(this).attr('data-code-alt') != null && $(this).attr('data-code-alt').length > 0
                                && $('#' + $(this).attr('data-code-modifier')).is(':checked'));
                            datacode = isModified ? $(this).attr('data-code-alt') : datacode;

                            var regex = new RegExp("^" + datacode + "$");
                            var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                            var overrideQty = active ? 0 : 1;
                            if (selectId != null && selectId.length > 0) {

                                if (datacode.indexOf(',') > -1 && selectId.indexOf(',') > -1) {

                                    var allDataCodes = datacode.split(',');
                                    var allSelectIds = selectId.split(',');
                                    var allDataCodesRegex = datacode.replace(',', ')$|^(');
                                    var selectRegex = new RegExp("^(" + allDataCodesRegex + ")$");
                                    active = _dtmShoppingCart.SearchItems(selectRegex).length > 0;
                                    var additionalItems = [];
                                    for (var i = 0; i < allSelectIds.length; i++) {

                                        var singleSelect = allSelectIds[i];
                                        var singleDataCode = allDataCodes[i];
                                        var quantity = active ? 0 : $('#' + singleSelect).val();
                                        if (i == 0) {
                                            datacode = singleDataCode;

                                            overrideQty = quantity;
                                        }
                                        else {
                                            additionalItems.push({ Id: singleDataCode, Qty: quantity });
                                        }

                                    }

                                }
                                else {
                                    overrideQty = active ? 0 : $('#' + selectId).val();
                                }
                            }

                            removeItems = getXorList(this);

                            //Adding bonus item quantities to additionalItems array
                            var bonusItemList = isModified ? dataMatchAlt : dataMatch;
                            if (bonusItemList.length > 0 && bonusItemList != null) {

                                var bonusItems = bonusItemList.split(',');
                                var bonusArray = [];
                                for (var i = 0; i < bonusItems.length; i++) {

                                    bonusArray.push({ Id: bonusItems[i], Qty: overrideQty });
                                }

                                if (typeof additionalItems !== 'undefined' && additionalItems.length > 0) {

                                    additionalItems.concat(bonusArray);

                                }
                                else {
                                    var additionalItems = bonusArray.slice();
                                }
                            }

                            handleCartChange(datacode, overrideQty, null, removeItems, additionalItems, event);
                        }
                        else {
                            if (isRadioOrCB) {

                                var hasQtySelect = $(this).attr('data-qty-id');
                                var overrideQty = (hasQtySelect != null && hasQtySelect.length > 0) ? parseInt($('#' + hasQtySelect + '').val()) : 1;
                                var bonusItemObject = bonusItemHandler(isModified, overrideQty, $(this));
                                removeItems = removeItems.concat(bonusItemObject["removeItems"]);
                                if ($(this).is(':checked') && !preventAction) {


                                    removeItems = removeItems.concat(getXorList(this));

                                    if ($(this).attr('data-checkbox') != null && $(this).attr('data-checkbox').length > 0) {
                                        var tempRemoveCodeArray = getXorList(this);
                                        $.each(tempRemoveCodeArray, function (idx, ele) {
                                            $('[data-code=' + ele + '],[data-code-alt=' + ele + ']').prop('checked', false);
                                        });
                                    }

                                    //Adding bonus item quantities to additionalItems array
                                    var additionalItems = bonusItemObject["bonusItems"];


                                    handleCartChange(datacode, overrideQty, null, removeItems, additionalItems, event);
                                }
                                else {
                                    if (typeof bonusItemObject["bonusItems"] != "undefined") {
                                        $.each(bonusItemObject["bonusItems"], function (idx, ele) {
                                            removeItems.push(ele.Id);
                                        });
                                    }
                                    handleCartChange(datacode, 0, null, removeItems, null, event);
                                }
                            }
                            else {
                                handleCartChange(datacode, null, null, removeItems, null, event);
                            }
                        }
                        if (typeof onItemClick == "function") {
                            onItemClick(this, event);
                        }
                    });

                }
                if (selectId != null && selectId.length > 0) {
                    var datacode = $(item).attr('data-code');

                    if (datacode.indexOf(',') > -1 && selectId.indexOf(',') > -1) {

                        var allDataCodes = datacode.split(',');
                        var allSelectIds = selectId.split(',');
                        var dataCodeRegex = datacode.replace(',', ')$|^(');

                        $.each(allSelectIds, function (index, id) {

                            $(document).on('change', '#' + id, function () {



                                datacode = allDataCodes[index];
                                var regex = new RegExp("^(" + dataCodeRegex + ")$");
                                var active = _dtmShoppingCart.SearchItems(regex).length > 0;

                                if (active) {


                                    var overrideQty = $(this).val();

                                    var additionalItems = [];
                                    for (var i = 0; i < allSelectIds.length; i++) {
                                        var singleSelect = allSelectIds[i];
                                        if (id != singleSelect) {
                                            var singleDataCode = allDataCodes[i];
                                            var quantity = $('#' + singleSelect).val();
                                            additionalItems.push({ Id: singleDataCode, Qty: quantity });
                                        }
                                    }
                                    setToggleButton(datacode, 'Update');
                                    handleCartChange(datacode, overrideQty, null, [], additionalItems, event);
                                }
                            });
                        });
                    }
                    else {
                        $(document).on('change', '#' + selectId, function () {

                            var isModified = ($(item).attr('data-code-modifier') != null && $(item).attr('data-code-modifier').length > 0
                                && $(item).attr('data-code-alt') != null && $(item).attr('data-code-alt').length > 0
                                && $('#' + $(item).attr('data-code-modifier')).is(':checked'));
                            datacode = isModified ? $(item).attr('data-code-alt') : datacode;
                            var regex = new RegExp("^" + datacode + "$");
                            var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                            var overrideQty = $(this).val();
                            var dataMatch = ($(item).attr('data-match') != null && $(item).attr('data-match').length > 0) ? $(item).attr('data-match') : "";
                            var dataMatchAlt = $(item).attr('data-match-alt') != null && $(item).attr('data-match-alt').length > 0 ? $(item).attr('data-match-alt') : "";
                            var dataMatchList = isModified ? dataMatchAlt : dataMatch;
                            var bonusArray = [];

                            if (dataMatchList.length > 0 && dataMatchList != null) {

                                var bonusItems = dataMatchList.split(',');

                                for (var i = 0; i < bonusItems.length; i++) {
                                    bonusArray.push({ Id: bonusItems[i], Qty: overrideQty });
                                }
                            }
                            if (active) {

                                setToggleButton(datacode, 'Update');
                                handleCartChange(datacode, overrideQty, null, [], bonusArray, event);
                            }
                        });
                    }
                }

                if (isPreselected) {
                    var isModified = ($(item).attr('data-code-modifier') != null && $(item).attr('data-code-modifier').length > 0
                        && $(item).attr('data-code-alt') != null && $(item).attr('data-code-alt').length > 0
                        && $('#' + $(item).attr('data-code-modifier')).is(':checked'));
                    var dataMatch = ($(this).attr('data-match') != null && $(this).attr('data-match').length > 0) ? $(this).attr('data-match') : "";
                    var dataMatchAlt = $(this).attr('data-match-alt') != null && $(this).attr('data-match-alt').length > 0 ? $(this).attr('data-match-alt') : "";
                    var dataMatchList = isModified ? dataMatchAlt : dataMatch;
                    var datacode = isModified ? $(item).attr('data-code-alt') : $(item).attr('data-code');
                    var bonusArray = [];

                    if (dataMatchList.length > 0 && dataMatchList != null) {

                        var bonusItems = dataMatchList.split(',');

                        for (var i = 0; i < bonusItems.length; i++) {

                            bonusArray.push({ Id: bonusItems[i], Qty: 1 });
                        }
                    }

                    var itemCart = getItems();
                    if (itemCart.length < 1) {
                        handleCartChange(datacode, null, null, [], bonusArray, event);
                    }
                }
            });

            $("[data-group-name][data-code-toggle=true]").each(function (i, item) {
                var groupName = $(this).attr('data-group-name');
                var isDataSelect = $(this).attr('data-select');
                var isDataCheckbox = $(this).attr('data-checkbox');
                var hasQtySelect = $(this).attr('data-qty-id');
                isDataSelect = (typeof isDataSelect !== typeof undefined);
                isDataCheckbox = (typeof isDataCheckbox !== typeof undefined);



                var overrideQty = 1;
                var removeItems = [];
                var dcSelector = isDataSelect ? ('[name="' + groupName + '"] option[value != ""]') : ('[name="' + groupName + '"]');


                if (isDataSelect) {

                    var selectName = $('[name=' + groupName + ']');
                    selectName.unbind('change');
                    var isDataSelectGroup = $(selectName).attr('data-select-group');
                    isDataSelectGroup = (typeof isDataSelectGroup !== typeof undefined);

                    if (typeof hasQtySelect !== typeof undefined) {
                        $('#' + hasQtySelect + '').change(function () {
                            selectName.trigger('change');

                        })

                    }

                    if (isDataSelectGroup) {
                        selectName.change(function () {
                            var gName = $(this).attr("name");
                            var selectRemove = [];
                            var groupItems = $('[name="' + gName + '"]').find('option[value != ""]').map(function () { return this.value }).get().join(")$|^(");
                            var selectItems = $(this).find('option[value != ""]').map(function () { return this.value }).get().join(",");
                            var newSelectedItem = $(this).val();
                            var regex = new RegExp("^(" + groupItems + ")$");

                            var active = _dtmShoppingCart.SearchItems(regex).length > 0;

                            if (active) {

                                var sItems = selectItems;
                                if (sItems != null && sItems.length > 0) {
                                    var allItems = sItems.split(',');
                                    for (var i = 0; i < allItems.length; i++) {
                                        var singleItems = allItems[i];
                                        selectRemove.push(singleItems);
                                    };
                                }
                                handleCartChange(newSelectedItem, overrideQty, null, selectRemove, null, event);
                            }



                        });

                    }
                    else {
                        selectName.change(function () {
                            var dataCode = $(this).val();
                            var selectItems = $(this).find('option[value != ""]').map(function () { return this.value }).get().join(",");
                            var dataCodes = $(dcSelector)
                                .map(function () { return this.value; })
                                .get().join(')$|^(');
                            var regex = new RegExp("^(" + dataCodes + ")$");
                            var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                            overrideQty = (hasQtySelect != null && hasQtySelect.length > 0) ? parseInt($('#' + hasQtySelect + '').val()) : 1;
                            if (active) {
                                var sItems = selectItems;
                                if (sItems != null && sItems.length > 0) {
                                    var allItems = sItems.split(',');
                                    for (var i = 0; i < allItems.length; i++) {
                                        var singleItems = allItems[i];
                                        removeItems.push(singleItems);
                                    };
                                }

                                handleCartChange(dataCode, overrideQty, null, removeItems, null, event);
                            }
                        });
                    }

                }
                else if (isDataCheckbox) {
                    var hasDataMatch = $('input[type=checkbox][name=' + groupName + '][data-match]').length > 0;
                    if (hasDataMatch) {
                        $('input[type=checkbox][name=' + groupName + '][data-match]').each(function (idx, ele) {
                            var dataMatch = $(this).attr('data-match');
                            var dataCode = $(this).val();
                            dataMatchArray.push({ mainItem: dataCode, bonusItems: dataMatch });

                            dataMatch = $(this).attr('data-match-alt');
                            if (typeof dataMatch != "undefined" && dataMatch.length > 0) {
                                dataMatch = $(this).attr('data-code-alt');
                                dataMatchArray.push({ mainItem: dataCode, bonusItems: dataMatch });
                            }

                        });
                    }

                    $(document).on('change', 'input[type=checkbox][name=' + groupName + ']', function (event) {

                        var group = '[name = ' + groupName + ']';

                        var isModified = ($(group).attr('data-code-modifier') != null && $(group).attr('data-code-modifier').length > 0
                            && $(group).attr('data-code-alt') != null && $(group).attr('data-code-alt').length > 0
                            && $('#' + $(group).attr('data-code-modifier')).is(':checked'));

                        var modifier = isModified ? $('[name = ' + groupName + ']').attr('data-code-modifier') : null;
                        var removeItems = [];
                        var newItems = [];
                        var dataCodes = $('[name=' + groupName + ']')
                            .map(function () { return this.value; })
                            .get().join(')$|^(');

                        if (isModified) {
                            if ($('#' + modifier).is(':checked')) {
                                dataCodes = $('[name=' + groupName + ']')
                                    .map(function () { return $(this).attr('data-code-alt'); })
                                    .get().join(')$|^(');
                            }
                        }

                        var regex = new RegExp("^(" + dataCodes + ")$");
                        var active = _dtmShoppingCart.SearchItems(regex).length > 0;

                        if (active) {
                            $('[data-code-toggle]').addClass('disableToggleClick');
                            $('[name="' + groupName + '"]').each(function (i, groupItem) {
                                var modifier = ($(groupItem).attr('data-code-modifier') != null && $(groupItem).attr('data-code-modifier').length > 0) ? $(groupItem).attr('data-code-modifier') : null;
                                var isModified = modifier != null ? $('#' + modifier + '').is(':checked') : false;
                                var dataMatch = isModified ? $(groupItem).attr('data-match-alt') : $(groupItem).attr('data-match');
                                var tempdatacode = isModified ? $(groupItem).attr('data-code-alt') : $(groupItem).val();

                                var selected = $(groupItem).is(':checked');
                                if (tempdatacode != null && tempdatacode.length > 0) {
                                    if (selected) {
                                        var item = {
                                            Id: tempdatacode,
                                            Qty: 1
                                        }

                                        newItems.push(item);

                                        if (dataMatch != null && dataMatch.length > 0) {
                                            var bonusItems = dataMatch.split(',');
                                            for (var i = 0; i < bonusItems.length; i++) {
                                                newItems.push({ Id: bonusItems[i], Qty: 1 });
                                            }
                                        }
                                    }
                                    else {
                                        removeItems.push(tempdatacode);

                                        if (dataMatch != null && dataMatch.length > 0) {
                                            var bonusItems = dataMatch.split(',');
                                            for (var i = 0; i < bonusItems.length; i++) {
                                                removeItems.push(bonusItems[i]);
                                            }
                                        }
                                    }
                                }
                            });

                            setToggleButton(groupName, 'Update');
                            if (newItems.length > 0) {
                                handleCartChange("", 0, null, removeItems, newItems, event);
                            } else {
                                handleCartChange("", 0, null, removeItems, null, event);
                            }

                        }
                    });
                }
                else {
                    if (hasQtySelect) {
                        var qtySelectId = $(this).attr('data-qty-id');
                        $(document).on('change', 'select[id=' + qtySelectId + ']', function (event) {
                            $('input[type=radio][name=' + groupName + ']').trigger('change');
                        });

                    }

                    //add radio Bonus items to dataMatchArray for ActionQuantityChange link
                    var hasDataMatch = $('input[type=radio][name=' + groupName + '][data-match]').length > 0;
                    if (hasDataMatch) {
                        $('input[type=radio][name=' + groupName + '][data-match]').each(function (idx, ele) {
                            var dataMatch = $(this).attr('data-match');
                            var dataCode = $(this).val();
                            dataMatchArray.push({ mainItem: dataCode, bonusItems: dataMatch });

                            dataMatch = $(this).attr('data-match-alt');
                            if (typeof dataMatch != "undefined" && dataMatch.length > 0) {
                                dataMatch = $(this).attr('data-code-alt');
                                dataMatchArray.push({ mainItem: dataCode, bonusItems: dataMatch });
                            }

                        });
                    }


                    $(document).on('change', 'input[type=radio][name=' + groupName + ']', function (event) {

                        var hasModifier = $('[name = ' + groupName + ']').attr('data-code-alt') != null && $('[name = ' + groupName + ']').attr('data-code-alt').length > 0;
                        var isModified = false;
                        var altCodes = "";
                        var dataCodes = $('[name="' + groupName + '"]')
                            .map(function () { return this.value; })
                            .get().join(')$|^(');


                        var regex = new RegExp("^(" + dataCodes + ")$");

                        if (hasModifier) {

                            var modifier = $('[data-group-name = ' + groupName + ']').attr('data-code-modifier');
                            isModified = $('#' + modifier + '').is(':checked');

                            altCodes = $('[name="' + groupName + '"]')
                                .map(function () { return $(this).attr('data-code-alt'); })
                                .get().join(')$|^(');

                            regex = new RegExp("^(" + dataCodes + ")$|^(" + altCodes + ")$");

                        }

                        var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                        var qty = getToggleButtonQty(groupName, 1);

                        if (active) {
                            var newCodes = [];
                            var removeItems = [];
                            var newCode = isModified ? $(this).attr('data-code-alt') : $(this).val();

                            $('[data-code-toggle]').addClass('disableToggleClick');
                            $('[name="' + groupName + '"]').each(function (i, groupItem) {

                                var tempdatacode = isModified ? $(groupItem).attr('data-code-alt') : $(groupItem).val();
                                var dataMatch = isModified ? $(groupItem).attr('data-match-alt') : $(groupItem).attr('data-match');

                                var selected = $(groupItem).is(':checked');
                                if (tempdatacode != null && tempdatacode.length > 0) {
                                    if (selected) {
                                        newCode = tempdatacode;
                                        if (dataMatch != null && dataMatch.length > 0) {
                                            var bonusItems = dataMatch.split(',');
                                            for (var i = 0; i < bonusItems.length; i++) {
                                                newCodes.push({ Id: bonusItems[i], Qty: qty });
                                            }
                                        }
                                    }
                                    else {
                                        removeItems.push(tempdatacode);
                                        if (dataMatch != null && dataMatch.length > 0) {
                                            var bonusItems = dataMatch.split(',');
                                            for (var i = 0; i < bonusItems.length; i++) {
                                                removeItems.push(bonusItems[i]);
                                            }

                                        }
                                    }
                                }
                            });

                            setToggleButton(groupName, 'Update');
                            handleCartChange(newCode, qty, null, removeItems, newCodes, event);
                        }
                    });
                }

                $(item).click(function (event) {
                    var removeItems = [];

                    var hasModifier = $('[name = ' + groupName + ']').attr('data-code-alt') != null && $('[name = ' + groupName + ']').attr('data-code-alt').length > 0;
                    var isModified = false;
                    var altCodes = "";
                    var dataCodes = $(dcSelector)
                        .map(function () { return this.value; })
                        .get().join(')$|^(');

                    var regex = new RegExp("^(" + dataCodes + ")$");

                    if (hasModifier) {
                        var modifier = hasModifier ? $('[data-group-name = ' + groupName + ']').attr('data-code-modifier') : null;
                        isModified = $('#' + modifier + '').is(':checked');

                        altCodes = $(dcSelector)
                            .map(function () { return $(this).attr('data-code-alt'); })
                            .get().join(')$|^(');

                        regex = new RegExp("^(" + dataCodes + ")$|^(" + altCodes + ")$");
                    }

                    var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                    var newCode = '';
                    var newQty = active ? 0 : 1;
                    var newCodes = [];
                    newQty = getToggleButtonQty(groupName, newQty);
                    $('[data-code-toggle=true]').addClass('disableToggleClick');

                    $('[name="' + groupName + '"]').each(function (i, groupItem) {
                        var tempdatacode = isModified ? $(groupItem).attr('data-code-alt') : $(groupItem).val();
                        var dataMatch = isModified ? $(groupItem).attr('data-match-alt') : $(groupItem).attr('data-match');
                        if (!isDataSelect) {
                            var selected = $(groupItem).is(':checked');
                        }
                        if (tempdatacode != null && tempdatacode.length > 0) {
                            if ((!isDataSelect && selected) || isDataSelect) {
                                newCode = tempdatacode;
                                newCodes.push({ Id: tempdatacode, Qty: newQty });
                                if (dataMatch != null && dataMatch.length > 0) {
                                    var bonusItems = dataMatch.split(',');
                                    for (var i = 0; i < bonusItems.length; i++) {
                                        newCodes.push({ Id: bonusItems[i], Qty: newQty });
                                    }
                                }
                            }
                            else {
                                removeItems.push(tempdatacode);

                                if (dataMatch != null && dataMatch.length > 0) {
                                    var bonusItems = dataMatch.split(',');
                                    for (var i = 0; i < bonusItems.length; i++) {
                                        removeItems.push(bonusItems[i]);
                                    }
                                }

                            }
                        }


                    });

                    if (isDataCheckbox) {

                        var removeItemCheckboxes = [];

                        for (var i = 0; i < newCodes.length; i++) {

                            if (newCodes[i].Qty < 1) {
                                removeItemCheckboxes.push(newCodes[i].Id);
                            }
                        }
                        checkboxToggleXor(removeItemCheckboxes);
                    }

                    removeItems = removeItems.concat(getXorList(this));

                    if (typeof uncheckDataRadios != "undefined" && uncheckDataRadios) {
                        radioToggleXor(removeItems);
                    }

                    handleCartChange(newCode, newQty, null, removeItems, newCodes, event);
                    //for (var i = 0; i < newCodes.length; i++) {
                    //    //var c = newCodes[i];
                    //    handleCartChange(c, newQty, null, removeItems, newCodes, event);
                    //}
                });
            });

        };

        loadAllItemStates();
        onDataCodesLoaded();
        CreateModifierChangeAction(modifierArray);
        registerEvent("DataCodesLoaded", onDataCodesLoaded);
        
        // check if the promo code button exists
        if ($('.ddlPromoButton').length > 0) {
            // append the handle cart change functionality to the button
            $('.ddlPromoButton').attr({ 'onclick': '_firstRun = false; handleCartChange();' });
            $('.ddlPromoButton').on('keyup keypress', function (e) {
                var keyCode = e.keyCode || e.which;
                if (keyCode === 13) {
                    e.preventDefault();
                    return false;
                }
            });
        } else {
            // otherwise, create the button and append it to the promo field
            $('.ddlPromo').after("<input type='button' class='ddlPromoButton' onclick='_firstRun = false; handleCartChange();' value='Apply Code' />");
        }
        

        $("#ShippingIsDifferentThanBilling").on("click", function () {
            var selector = $('#ShippingIsDifferentThanBilling').is(':checked') ? '#ShippingZip' : '#BillingZip';
            var zip = $(selector).val() != undefined ? $(selector).val() : '';

            updateZip(zip, getState(), getCountry());
            handleCartChange();
        });

        $('[name^="ActionAttribute"]').change(function () {
            var index = ($(this).attr('name') || '').replace('ActionAttribute', '');
            var allValues = new Array();
            $.each($('[name="ActionAttribute' + index + '"]'), function () {
                allValues.push($(this).val());
            });
            if ($('[name^="ActionAttribute' + index + '"]').length == allValues.length) {
                handleCartChange();
            }
        });
    }
    function getToggleButtonQty(groupName, defaultValue) {
        var qty = defaultValue;
        var toggleButton = $("[data-group-name='" + groupName + "'][data-code-toggle=true][data-qty-id]");
        if ($(toggleButton).length > 0) {
            var hasQtyId = $(toggleButton).attr("data-qty-id").length > 0;
            var overrideQty = qty;
            if (hasQtyId) {
                var qtyId = $(toggleButton).attr("data-qty-id");
                overrideQty = $("#" + qtyId).val();
            }
            qty = overrideQty;
        }
        if (defaultValue == 0) {
            qty = 0;
        }
        return qty;
    }

    function setToggleButtonQty(groupName, value) {
        var toggleButton = $("[data-group-name='" + groupName + "'][data-code-toggle=true][data-qty-id]");
        if ($(toggleButton).length > 0) {
            var hasQtyId = $(toggleButton).attr("data-qty-id").length > 0;
            if (hasQtyId) {
                var qtyId = $(toggleButton).attr("data-qty-id");
                $("#" + qtyId).val(value);
            }
        }
    }
    function loadItemState(productCode, qty) {
        var getEle = function (pc) {
            var ret = null;

            if ($('[name*=ActionCode][value="' + productCode + '"]').length != 0) {
                ret = $('[name*=ActionCode][value="' + productCode + '"]');
            }
            else if ($('[name*=ActionCode][data-default="' + productCode + '"]').length != 0) {
                ret = $('[name*=ActionCode][data-default="' + productCode + '"]');
            }
            else if ($('[name*=ActionCode][data-upgrade="' + productCode + '"]').length != 0) {
                ret = $('[name*=ActionCode][data-upgrade="' + productCode + '"]');
            }
            else if ($('[name*=ActionCheckbox][data-target="' + productCode + '"]').length != 0) {
                ret = $('[name*=ActionCheckbox][data-target="' + productCode + '"]');
            }
            else if ($('[name*=ActionCheckbox][data-new="' + productCode + '"]').length != 0) {
                ret = $('[name*=ActionCheckbox][data-new="' + productCode + '"]');
            }
            return ret;
        }

        var ele = getEle(productCode);
        var index = ($(ele).attr('name') || '').replace('ActionCode', '');
        var id = productCode;
        var originalId = id;
        var isMod = false;

        var modEle = $('[data-code][data-code-toggle=true][data-code-alt=' + id + '][data-code-modifier]');
        if (modEle.length == 0) {
            modEle = $('select[data-code-modifier] option[data-code-alt=' + id + '], select[data-code-modifier] option[value=' + id + ']');
            if (modEle.length > 0) {
                modEle = $(modEle).parent();
            }
        }

        if (modEle.length > 0 && $('#' + modEle.attr('data-code-modifier')).length > 0) {
            $('#' + modEle.attr('data-code-modifier')).prop('checked', true);
            if (modEle.attr('data-code').length > 0) {
                originalId = modEle.attr('data-code');
            }
            else {
                originalId = $('select[data-code-modifier] option[data-code-alt=' + id + ']').attr('value');
                isMod = true;
                if (originalId == null) {
                    originalId = $('select[data-code-modifier] option[value=' + id + ']').attr('value');
                    isMod = false;
                }
                var cbox = $('#' + $(modEle).attr('data-code-modifier'));
                if (isMod) {
                    $(cbox).attr('checked', true);
                }
                else {
                    $(cbox).attr('checked', false);
                }

            }

            if (originalId == '') {
                originalId = id;
            }
        }

        var selEle = $('select[data-code-modifier] option[data-code-alt=' + id + '], select[data-code-modifier] option[value=' + id + ']');
        if (selEle.length > 0) {
            $(modEle).val(originalId);

            if (typeof $(modEle).attr('data-qty-id') !== "undefined") {
                var selectableEle = $('#' + $(modEle).attr('data-qty-id'));
                $(selectableEle).val(qty);
            }
        }

        var actionEle = $('[name*=ActionCode] option[value="' + id + '"]');
        if (actionEle.length != 0) {
            actionEle.parent().val(id);
        }

        if (ele == null) {
            console.log("No matching elements, item state not loaded for " + id);
            return;
        }
        else if (ele.length > 1) {
            console.log("Too many matching elements, item state not loaded for " + id);
            return;
        }

        var preventCheck = false, preventClick = false;
        if (ele.attr('data-default') == id) {
            if ($('#ActionQuantity' + index).length != 0) {
                $('#ActionQuantity' + index).val(qty);
                preventClick = true;
                preventCheck = true;
            }
        } else if (ele.attr('data-upgrade') == id) {
            ele.val(id);

            if ($('#ActionQuantity' + index).length != 0) {
                $('#ActionQuantity' + index).val(qty);
                preventClick = true;
            }
        } else if (ele.attr('name').indexOf("ActionCheckbox") >= 0) {

            index = ($(ele).attr('name') || '').replace('ActionCheckbox', '');

            if (ele.data('new') == id) {
                ele.prop('checked', true);
            }
            if (ele.data('target') == id) {
                ele.prop('checked', false);
                if ($('#ActionCode' + index).val() != ele.data('target')) {
                    $('#ActionCode' + index).val(ele.data('target'));
                }
            }

            if ($('#ActionQuantity' + index).length != 0) {
                $('#ActionQuantity' + index).val(qty);
                preventClick = true;
            }
        } else if (ele.attr('type') == 'checkbox') {
            ele.prop('checked', true);
        }


        var checkableEle = null;
        var action = $('#Action' + index);


        // Action
        if ($(action).length > 0 && $('[name="Action' + index + '"]').length == 0 || 'radio,checkbox'.indexOf(action.attr('type')) >= 0) {
            action.val(id);
            checkableEle = action;
        }

        else {
            var radioWithModifier = $('input[type=radio][data-code-modifier][data-code-alt=' + id + ']');
            var checkboxWithModifier = $('input[type=checkbox][data-code-modifier][data-code-alt=' + id + ']');
            var radioFromGroup = $('input[type=radio][value=' + id + ']');
            var radioSolo = $('input[type=radio][data-code=' + id + ']');
            var selectFromGroup = $('select option[value= ' + id + ']').parent();
            var checkboxGroup = $('input[type=checkbox][value=' + id + ']');
            var singleCheckbox = $('input[type=checkbox][data-code=' + id + '], input[type=checkbox][data-code-alt=' + id + '] ');
            var isSingleCheckbox = singleCheckbox.length > 0;
            var isRadioWithModifier = $(radioWithModifier).length > 0;
            var isCheckboxWithModifier = $(checkboxWithModifier).length > 0;
            var isRadioSelect = $(radioFromGroup).length > 0 && $('[data-group-name=' + $(radioFromGroup).attr('name') + '][data-code-toggle=true]').length > 0;
            var isRegularSelect = $(selectFromGroup).length > 0 && $('[data-group-name=' + $(selectFromGroup).attr('name') + '][data-code-toggle=true]').length > 0;
            var isCheckboxSelect = $(checkboxGroup).length > 0 && $('[data-group-name=' + $(checkboxGroup).attr('name') + '][data-code-toggle=true]').length > 0;
            var isRadioSolo = $(radioSolo).length > 0;
            var isDataCodeSelect = $('select[data-code=' + id + '], select[data-code-alt=' + id + '] ').length > 0;


            var selectItem = radioFromGroup;
            //Toggle Button + Data Group + Check/Selectable Item
            if (isRegularSelect || isRadioSelect || isCheckboxSelect) {
                if (isRegularSelect) {
                    selectItem = selectFromGroup;
                    selectFromGroup.val(id);
                }
                else if (isRadioSelect) {
                    checkableEle = radioFromGroup;
                }
                else if (isCheckboxSelect) {
                    selectItem = checkboxGroup;
                    checkboxGroup.prop("checked", true);
                }

                var groupName = $(selectItem).attr('name');
                var toggleButton = $('[data-group-name=' + $(selectItem).attr('name') + '][data-code-toggle=true]');

                if ($(toggleButton).length > 0) {
                    registerEvent("ToggleButtonInitialized", function () {
                        setToggleButton(groupName, 'Add');
                    });
                }
            }

            //Select w/ Data-code + qty
            if (isDataCodeSelect) {
                var selector = $('select[data-code=' + id + '], select[data-code-alt=' + id + '] ');
                selector.val(qty);

                var hasModifier = selector.attr('data-code-modifier') != null;

                if (hasModifier) {
                    var modifierName = selector.attr('data-code-modifier');
                    var ifModifierCheckbox = 'checkbox'.indexOf($('[name=' + modifierName + ']').attr('type')) >= 0;
                    var ifModifierRadio = 'radio'.indexOf($('[name=' + modifierName + ']').attr('type')) >= 0;
                    var modifierSelected = $('select[data-code-alt=' + id + '] ');

                    if (modifierSelected.length > 0) {

                        if (ifModifierCheckbox) {
                            $('[name=' + modifierName + ']').attr('checked', true);
                        }
                        else if (ifModifierRadio) {
                            $('[name=' + modifierName + '][value="true"]').attr('checked', true);
                        }
                    }
                    else {
                        if (ifModifierRadio) {
                            $('[name=' + modifierName + '][value=false]').attr('checked', true);
                        } else if (ifModifierCheckbox) {
                            $('[name=' + modifierName + ']').attr('checked', false);
                        }
                    }
                }

            }

            //Radio w/ Data-code only
            else if (isRadioSolo) {
                checkableEle = radioSolo;

                //Radio w/ Radio-Modifier , setting False Radio
                if (radioSolo.attr('data-code-modifier') != null && radioSolo.attr('data-code-modifier').length > 1) {
                    var modifierName = radioSolo.attr('data-code-modifier');
                    if ($('input[type=radio][name=' + modifierName + '][value=false]').length > 0) {
                        $('input[type=radio][name=' + modifierName + '][value=false]').prop('checked', true);
                    }
                }
            }

            //Radio w/ Data-code and Data-Code-Modifier only (Alt code is selected) 
            else if (isRadioWithModifier) {
                var modId = radioWithModifier.attr('data-code-modifier');
                checkableEle = radioWithModifier;
                var ifModifierCheckbox = 'checkbox'.indexOf($('[name=' + modId + '],[id=' + modId + ']').attr('type')) >= 0;
                var ifModifierRadio = 'radio'.indexOf($('[name=' + modId + ']').attr('type')) >= 0;

                if (ifModifierCheckbox) {
                    $('#' + modId + '').attr('checked', true);
                }
                if (ifModifierRadio) {
                    if ($('input[type=radio][name=' + modId + '][value=true]').length > 0) {
                        $('input[type=radio][name=' + modId + '][value=true]').prop('checked', true);
                    }
                }
                preventClick = true;

            }
            //Checkbox w/ Data-code and Data-Code-Modifier only (Alt code is selected) 
            else if (isCheckboxWithModifier) {
                var modId = checkboxWithModifier.attr('data-code-modifier');

                checkableEle = checkboxWithModifier;
                preventClick = true;
                $('#' + modId + '').attr('checked', true);

            }
            else if (isSingleCheckbox) {
                checkableEle = singleCheckbox;
                preventClick = true;
            }
        }

        if (checkableEle != null) {
            if (!preventCheck) {
                checkableEle.attr('checked', 'checked');
            }
            if (!preventClick) {
                checkableEle.trigger('click');
            }
        }

        //Multiple Data-Codes + Multiple Selects

        var dcMultiSelect = $('[data-code*=' + id + '][data-select-id*=","][data-code-toggle=true]');
        var dcMultiSelectCodes = dcMultiSelect.attr('data-code');
        var dcMultiSelectId = dcMultiSelect.attr('data-select-id');
        var usesDcMultiSelect = false;

        if ($(dcMultiSelect).length > 0 && $('#' + $(dcMultiSelect).attr('data-select-id')).length > 0) {

            if (dcMultiSelectCodes.indexOf(',') > -1) {

                var dcMultiSelectCodesArray = dcMultiSelectCodes.replace(' ', '').split(',');

                for (var i = 0; i < dcMultiSelectCodesArray.length; i++) {

                    if (id == dcMultiSelectCodesArray[i]) {
                        usesDcMultiSelect = true;
                    }

                }
            }
            else if (id == dcMultiSelectCodes) {
                usesDcMultiSelect = true;
            }

            if (usesDcMultiSelect) {

                var selectableEle;

                if (dcMultiSelectId.indexOf(',') > -1) {
                    var dcMultiSelectors = dcMultiSelectId.split(',');

                    for (var i = 0; i < dcMultiSelectors.length; i++) {

                        if ($('#' + dcMultiSelectors[i]).length > 0) {
                            var dcMultiSelectProduct = $('#' + dcMultiSelectors[i]).attr('data-select-product');

                            if (dcMultiSelectProduct == id) {
                                selectableEle = $('#' + dcMultiSelectors[i]);
                            }
                        }
                    }

                    if (selectableEle.length > 0) {
                        $(selectableEle).val(qty);
                    }

                    registerEvent("ToggleButtonInitialized", function () {
                        setToggleButton(id, 'Add');
                    });


                }
            }
        }

        // Data-Code + Select
        var dcSelect = $('[data-code=' + id + '][data-select-id][data-code-toggle=true]');
        if ($(dcSelect).length <= 0) {
            dcSelect = $('[data-code-alt=' + id + '][data-select-id][data-code-toggle=true]');
        }

        if ($(dcSelect).length > 0 && $('#' + $(dcSelect).attr('data-select-id')).length > 0) {

            var selectableEle = $('#' + $(dcSelect).attr('data-select-id'));

            $(selectableEle).val(qty);

            registerEvent("ToggleButtonInitialized", function () {
                setToggleButton(id, 'Add');
            });

        }

        // Regular Data Code w/ Toggle Button
        var toggleButton = $('[data-code=' + originalId + ']');

        if (toggleButton.length > 0) {
            registerEvent("ToggleButtonInitialized", function () {
                setToggleButton(originalId, 'Add');
            });
        }

        // Regular Action Code / Quantity
        if ($('[name="ActionCode' + index + '"]').length == 0 || 'radio,checkbox'.indexOf(ele.attr('type')) >= 0) {
            if (!ele.is(':checked')) {
                ele.attr('checked', 'checked');
                ele.trigger('click');
            }

            if ($('#ActionQuantity' + index).length > 0) {
                $('#ActionQuantity' + index).val(qty);
            }
        }
        else {
            $('#ActionQuantity' + index).val(qty);
        }

        // Set Data-Conditions
        $.each($('[data-condition="' + id + '"][data-condition-value]:not([data-condition-missing])'), function () {
            setDataCondition(this);
        });

        //Set qty value for Select with radio/checkbox
        var qtySelect = $('[data-code=' + id + '][data-qty-id][type=radio],[data-code=' + id + '][data-qty-id][type=checkbox]');
        if ($(qtySelect).length <= 0) {
            qtySelect = $('[data-code-alt=' + id + '][data-qty-id][type=radio],[data-code-alt=' + id + '][data-qty-id][type=checkbox]');
        }

        if ($(qtySelect).length > 0 && $('#' + $(qtySelect).attr('data-qty-id')).length > 0) {
            var selectableEle = $('#' + $(qtySelect).attr('data-qty-id'));

            $(selectableEle).val(qty);
        }

    }

    function setDataCondition(obj) {
        var conditionMet = true;
        var type =
            $(obj).is('input[type="checkbox"]') ? "Checkbox" :
                $(obj).is('input[type="radio"]') ? "Radio" :
                    "Text";
        var conditionValue = $(obj).attr('data-condition-value');

        if ($(this).attr('data-condition-qty') != null && $(obj).attr('data-condition-qty').length >= 0) {
            conditionMet = qty == parseInt($(obj).attr('data-condition-qty'));
        }

        if (conditionMet) {
            switch (type) {
                case "Checkbox":
                    if (conditionValue.toLowerCase() == "true") {
                        if (!$(obj).is(':checked')) {
                            $(obj).trigger('click');
                        }
                    }
                    else if (conditionValue.toLowerCase() == "false") {
                        if ($(obj).is(':checked')) {
                            $(obj).trigger('click');
                        }
                    }
                    else {
                        console.log('Condition Value for Checkboxes must be set to "true" or "false"');
                    }
                    break;
                case "Radio":
                    $(obj).attr('checked', 'checked');
                    $(obj).trigger('click');
                    break;
                case "Text":
                    $(obj).val(conditionValue);
                    break;
            }
        }
    }

    function handleCartChange(addItemId, overrideQty, atr, removeItems, additionalItems, evt) {
        if (typeof (onCartChangeBegin) == "function") {
            onCartChangeBegin();
        }

	 
            var html = '';

            var payload = { t: new Date().getTime(), covid: 'b6a095f0-0809-ed11-8b97-a0369f1303c7', zipcode: getZip(), state: getState(), country: getCountry() };
            var uniqueItems = getItems();
            var qtyCounter = uniqueItems.length;

            var toggleItems = [];
            var toggleButtonCaller = null;

            if (typeof (evt) !== 'undefined') {
                var ev = typeof (event) === 'undefined' ? evt : evt || event;
                if (ev != null && ev.currentTarget != null && $(ev.currentTarget).attr('data-code') != null) {
                    toggleButtonCaller = ev.currentTarget;
                    var tempdatacode = $(toggleButtonCaller).attr('data-code');
                    //Toggle Button Click
                    if ($(ev.currentTarget).attr('data-code-toggle') != null && $(ev.currentTarget).attr('data-code-toggle') == 'true') {
                        var isModified = ($(toggleButtonCaller).attr('data-code-modifier') != null && $(toggleButtonCaller).attr('data-code-modifier').length > 0
                            && $(toggleButtonCaller).attr('data-code-alt') != null && $(toggleButtonCaller).attr('data-code-alt').length > 0
                            && $('#' + $(toggleButtonCaller).attr('data-code-modifier')).is(':checked'));
                        //var tempdatacode = $(toggleButtonCaller).attr('data-code');
                        tempdatacode = isModified ? $(toggleButtonCaller).attr('data-code-alt') : tempdatacode;
                        var regex;
                        if (tempdatacode.indexOf(',') > -1) {
                            tempdatacode = tempdatacode.replace(',', ')$|^(');
                            regex = new RegExp("^(" + tempdatacode + ")$");
                        }
                        else {
                            regex = new RegExp("^" + tempdatacode + "$");
                        }



                        var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                        var $toggleButtonCaller = $(toggleButtonCaller).find('[data-code-label]').length > 0
                            ? $(toggleButtonCaller).find('[data-code-label]')
                            : $(toggleButtonCaller);

                        $toggleButtonCaller.html(active ? 'Removing...' : 'Adding...');
                    }

                    else if (overrideQty == null) {
                        var qtyOverride = $(toggleButtonCaller).attr('data-qty-override');
                        if (qtyOverride != null) {
                            overrideQty = qtyOverride;
                        }
                        else {
                            var actionCode = $('[name*="ActionCode"][value="' + tempdatacode + '"]');
                            if (actionCode != null && actionCode.length > 0) {
                                var actionQty = $('[name*="ActionQuantity' + $(actionCode).attr('id').replace('ActionCode', '') + '"]');
                                if (actionQty != null) {
                                    overrideQty = $(actionQty).val();
                                }
                            }
                        }

                    }
                }
            }

            for (var index = 0; index < uniqueItems.length; index++) {
                var item = uniqueItems[index];
                if (item.id != '' && item.id != 'none') {
                    payload['Item' + index] = item.id;
                    payload['Qty' + index] = item.qty;
                    payload['Atr' + index] = item.atr;


                    var isGroup = false;
                    $("[data-group-name][data-code-toggle=true]").each(function (i, v) {
                        var groupName = $(this).attr('data-group-name');

                        $('select[name=' + groupName + '] option[value=' + item.id + ']').parent().each(function (j, z) {
                            isGroup = true;
                            if (item.qty == 0) {
                                setToggleButton(groupName, 'Remove');
                            }
                            toggleItems.push(groupName);
                        });

                        $('input[type=radio][name=' + groupName + '][value=' + item.id + ']').each(function (j, z) {
                            isGroup = true;
                            if (item.qty == 0) {
                                setToggleButton(groupName, 'Remove');
                            }
                            toggleItems.push(groupName);
                        });

                        $('input[type=checkbox][name=' + groupName + '][value=' + item.id + ']').each(function (j, z) {
                            isGroup = true;
                            if (item.qty == 0) {
                                setToggleButton(groupName, 'Remove');
                            }
                            toggleItems.push(groupName);
                        });
                    });

                    if (item.qty == 0) {
                        if (!isGroup) {

                            setToggleButton(item.id, 'Remove');

                            toggleItems.push(item.id);
                        }
                    }

                }
            }

               
            if (typeof addItemId == "string") {
                var hasOverrideQty = !(typeof overrideQty == "undefinied" || overrideQty == null);
                var itemExists = false;
                for (var index = 0; index < uniqueItems.length; index++) {
                    if (payload['Item' + index] == addItemId) {
                        var qty = payload['Qty' + index];
                        if (!hasOverrideQty) {
                            payload['Qty' + index] = qty + 1;
                        } else {
                            payload['Qty' + index] = overrideQty;
                        }
                        payload['Atr' + index] = atr;
                        itemExists = true;
                        break;
                    }
                }
                if (!itemExists && addItemId != '') {
                    qtyCounter++;
                    payload['Item' + qtyCounter] = addItemId;
                    payload['Qty' + qtyCounter] = !hasOverrideQty ? 1 : overrideQty;
                    payload['Atr' + qtyCounter] = atr;
                    toggleItems.push(addItemId);
                }


                if (additionalItems != null && additionalItems.length > 0) {
                    for (var i = 0; i < additionalItems.length; i++) {
                        var extra = additionalItems[i];
                        var extraId = extra.Id;
                        var extraQty = extra.Qty;
                        if (extraId != '' && extraId != addItemId && removeItems.indexOf(extraId) < 0) {
                            qtyCounter++;
                            payload['Item' + qtyCounter] = extraId;
                            payload['Qty' + qtyCounter] = extraQty;
                            toggleItems.push(extraId);
                        }
                    };
                }

                if (removeItems != null && removeItems.length > 0) {
                    for (var i = 0; i < removeItems.length; i++) {
                        var removeItem = removeItems[i];
                        if (removeItem != '' && removeItem != addItemId) {
                            qtyCounter++;
                            payload['Item' + qtyCounter] = removeItem;
                            payload['Qty' + qtyCounter] = 0;
                            toggleItems.push(removeItem);
                        }
                    };
                }
            }
            

            $('.ddlPromo').each(function (index, item) {

                //if digits or not a space,number, hyphen or letter, then don't let keypress work.
                $(item).keydown(function (event) {
                    var inputValue = event.which;

                    if ((inputValue > 64 && inputValue < 91) // uppercase
                        || (inputValue >= 96 && inputValue < 123) // lowercase + numpad numbers
                        || (inputValue >= 48 && inputValue <= 57) // numbers
                        || inputValue == 9 //tab
                        || inputValue == 8// backspace
                        || inputValue == 46 // delete key
                        || (inputValue >= 37 && inputValue <= 40)) // arrows
                    {
                        return;
                    }
                    event.preventDefault();
                });

                //if value contains symbol , clear field
                $(item).on("input", function (e) {
                    var value = $(item).val();
                    var regex = new RegExp("[^A-Za-z0-9]");
                    if (regex.test(value)) {
                        $(item).val("");
                    }
                });

                var id = $(item).val();
                payload['PromoCode'] = id;
            });

            $('.cartParam').each(function (index, item) {
                var id;
                var paramName = $(item).data('paramname') || item.name;
                if ('radio'.indexOf($(item).attr('type')) >= 0) {
                    id = $('[name=' + item.name + ']:checked').val();
                }
                else if ('checkbox'.indexOf($(item).attr('type')) >= 0) {
                    id = $('[name=' + item.name + ']').is(':checked');
                }
                else {
                    id = $(item).val();
                }
                if (payload["param_" + paramName] == null || payload["param_" + paramName] == '') {
                    payload["param_" + paramName] = id;
                }
            });


            $.post(getCartUrl('Edit'),
                payload,
                function (data) {
                    var retailDeliveryFee = 'RDFFEE';
                    $("#retailDeliveryFee").hide();

                    
                    $('.reviewTableBody').html('');
                    $('#orderFormReviewTableItems').html('');
                    $('.futurechargerow').remove();
       

                    var totalQty = 0;

					

                    for (var i = 0; i < data.items.length; i++) {
                        var excludeFromCartCount = false;
                        var dataItem = data.items[i];
                        if (dataItem.props && dataItem.props.length > 0) {
                            for (var pi = 0; pi < dataItem.props.length; pi++) {
                                var prop = dataItem.props[pi];
                                dataItem.props[prop["Key"]] = prop["Value"];

                                if (prop["Key"] == "ExcludeFromCartCount" && prop["Value"] == 'true') {
                                    excludeFromCartCount = true;
                                }
                                if (dataItem.code === retailDeliveryFee) {
                                    $('#retailDeliveryFeeName').html(dataItem.name);
                                    $("#retailDeliveryFee").show();
                                }
                            }
                        }
                        if (!excludeFromCartCount) {
                            totalQty += dataItem.qty;
                        }
                        
                        var tr = renderTr(dataItem, i);
                        $('.reviewTableBody').append(tr);
                        
                        $('#orderFormReviewTableItems').append(getItemHtml(dataItem, i));
                    
                        var dataSelect = $("[data-code='" + dataItem.code + "'][data-select-id]");
                        if (dataSelect.length > 0) {
                            $("#" + dataSelect.attr("data-select-id")).val(dataItem.qty);
                        }
                        var dataCodeSelect = $("select[data-code=" + dataItem.code + "], select[data-code-alt=" + dataItem.code + "]");
                        if (dataCodeSelect.length > 0) {
                            dataCodeSelect.val(dataItem.qty);
                        }
                   

                    }

                    
                    var subtotal = data.totalPrice.toFixed(2);

					 

                    if (data.zipdata && data.zipdata.Fees) {

                        subtotal = (subtotal - parseFloat(data.zipdata.Fees)).toFixed(2);
                    }

                    $('.subtotal').html('$' + subtotal);
                    $('.phtotal').html('$' + data.totalShipping.toFixed(2));
                    $('.summary-total').html('$' + data.total.toFixed(2));
                    $('.cartTotalQty').html(totalQty > 0 ? '(' + totalQty + ')' : '');
                    $('.cartTotalQtyNumbersOnly').html(totalQty > 0 ? '' + totalQty + '' : '');
                    setTax(data.zipdata);

                    if (payload['PromoCode'] && typeof hidePromoErrors === "undefined") {
                        displayError(data.errors);
                    }

                    if (payload['PromoCode'] && typeof (onApplyPromo) == "function") {
                        var promoCode = payload['PromoCode'];
                        var hasPromo = promoCode == data.promoCode;
                        var promoItem = getItemWithKeyValue(data.items, 'id', data.promoCodeTarget);
                        if (hasPromo && promoItem != null) {
                            var fireOnApplyPromo = false;
                            $('.ddlPromo').each(function (i, item) {
                                var current = $(item).attr('data-current');
                                if (typeof (current) == "undefined" || current != promoCode) {
                                    $(item).attr('data-current', promoCode);
                                    fireOnApplyPromo = true;
                                }
                            });
                            if (fireOnApplyPromo) {
                                onApplyPromo(promoCode, promoItem);
                            }
                        }
                    }

					
                    function getFutureChargesLabels(startingLabelIndex) {
                    

                     if ("true" == "true") {
                         var thirtyDayMultiplier = 0;
                         var days = (thirtyDayMultiplier + 1) * 30;
                         var displayDays = (days * (startingLabelIndex - 1));

                         switch (startingLabelIndex) {
                             case 1:
                                 var firstFutureChargeLabel = "" != "" ? "1 " + displayDays + " " : "1st Payment in " + displayDays + " days";
                                 return firstFutureChargeLabel;
                             case 2:
                                 var secondFutureChargeLabel = "" != "" ? "2 " + displayDays + " " : "2nd Payment in " + displayDays + " days";
                                 return secondFutureChargeLabel;
                             case 3:
                                 var thirdFutureChargeLabel = "" != "" ? "3 " + displayDays + " " : "3rd Payment in " + displayDays + " days";
                                 return thirdFutureChargeLabel;
                             default:
                                 var thFutureChargeLabel = "" != "" ? startingLabelIndex + " " + displayDays + " " : startingLabelIndex + "th Payment in " + displayDays + " days";
                                 return thFutureChargeLabel;
                         }
                     }
                     else {
                         switch (startingLabelIndex) {
                             case 1:
                                 var firstFutureChargeLabel = "" != "" ? "1 " : "1st Payment";
                                 return firstFutureChargeLabel;
                             case 2:
                                 var secondFutureChargeLabel = "" != "" ? "2 " : "2nd Payment";
                                 return secondFutureChargeLabel;
                             case 3:
                                 var thirdFutureChargeLabel = "" != "" ? "3 " : "3rd Payment";
                                 return thirdFutureChargeLabel;
                             default:
                                 var thFutureChargeLabel = "" != "" ? startingLabelIndex + " " : startingLabelIndex + "th Payment";
                                    return thFutureChargeLabel;
                            }
                        }
                    }
                    function getFirstPaymentLabel(price, shipping, tax) {

                        

                     var shippingString = (shipping > 0) ? " + $" + shipping.toFixed(2) : "";
                     var taxString = (tax > 0) ? " + $" + tax.toFixed(2) : "";
                     if (shipping > 0 || tax > 0) {
                         return "Your 1st payment is " + "$" + price.toFixed(2) + shippingString + taxString;
                     }
                     return "Your 1st payment is " + price.toFixed(2);
                    }
                    function getExtendedPaySummaryLabels(startingLabelIndex) {
                        switch (startingLabelIndex) {
                            case 2:
                                label = "Your 2nd payment is $";
                                break;
                            case 3:
                                label = "Your 3rd payment is $";
                                break;
                            default:
                                label = "Your " + startingLabelIndex + "th payment is $";
                                break;
                        }
                        return label;
                    }
                    if (typeof (onCartChangeComplete) == "function") {
                        onCartChangeComplete();
                    }

                    if (_dtmShoppingCart != null) {
                        setTimeout(function () { }, 800);

                        var rbgroups = [];

                        for (var i = 0; i < toggleItems.length; i++) {
                            var toggleItem = toggleItems[i];
                            var code = toggleItem;
                            var regex = new RegExp("^" + toggleItem + "$");
                            var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                            var isGroup = $('input[type=radio][name=' + toggleItem + ']').length > 0;
                            code = $('input[type=radio][value=' + toggleItem + '][name]:checked').length > 0 ? $('input[type=radio][value=' + toggleItem + '][name]:checked').attr('name') : code;

                            if (isGroup) {

                                var selectedItem = $('input[type=radio][name=' + toggleItem + ']:checked').val();
                                var cartRegex = new RegExp("^" + selectedItem + "$");
                                var cartItem = _dtmShoppingCart.SearchItems(cartRegex);
                                var hasItem = cartItem.length > 0;
                                if (hasItem) {
                                    setToggleButtonQty(code, cartItem.TotalQuantity);
                                }
                            }

                            setToggleButton(code, active ? 'Add' : 'Remove');
                        };

                        $('[data-code-toggle=true][data-code]').not('[data-code-modifier]').each(function (index, item) {
                            var code = $(this).attr('data-code');

                            if (code.indexOf(',') > -1) {

                                var allDataCodes = code.split(',');
                                var datacodes = code.replace(',', ')$|^(');
                                var regex = new RegExp("^(" + datacodes + ")$");
                                var active = _dtmShoppingCart.SearchItems(regex).length > 0;


                                setToggleButton(code, active ? 'Add' : 'Remove');


                            }
                            else {
                                var isCB = 'checkbox'.indexOf($(this).attr('type')) >= 0;

                                var code = $(this).attr('data-code');
                                var regex = new RegExp("^" + code + "$");
                                var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                                if (isCB) {
                                    $(this).prop("checked", active);
                                }
                                setToggleButton(code, active ? 'Add' : 'Remove');
                            }
                        });

                        $("[data-code-toggle=true][data-group-name]").each(function (i, item) {
                            var groupName = $(this).attr('data-group-name');
                            var isDataCheckbox = $(this).attr('data-checkbox') != null && $(this).attr('data-checkbox').length > 0;
                            var altCodes = "";
                            var hasQtySelect = $(this).attr('data-qty-id');
                            var selector = ($(item)[0].hasAttribute('data-select')) ?
                                ('[name="' + groupName + '"] option[value != ""]') :
                                ('[name="' + groupName + '"]');

                            var removeItems = [];
                            var dataCodes = $(selector)
                                .map(function () { return this.value; })
                                .get().join(')$|^(');

                            var hasModifier = $(this).attr('data-code-modifier') != null && $(this).attr('data-code-modifier').length > 0;

                            if (hasModifier) {
                                altCodes = $('[name="' + groupName + '"]')
                                    .map(function () { return $(this).attr('data-code-alt'); })
                                    .get().join(')$|^(');
                            }

                            var regex = hasModifier ? new RegExp("^(" + dataCodes + ")$|^(" + altCodes + ")$") : new RegExp("^(" + dataCodes + ")$");
                            var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                            setToggleButton(groupName, active ? 'Add' : 'Remove');

                            if (active && typeof hasQtySelect !== typeof undefined) {
                                setToggleButtonQty(groupName, _dtmShoppingCart.SearchItems(regex).TotalQuantity);
                            }

                            if (isDataCheckbox) {
                                $('[name="' + groupName + '"]').each(function (idx, cbx) {

                                    var modifier = hasModifier ? $(cbx).attr('data-code-modifier') : null;
                                    var isModified = modifier != null ? $('#' + modifier + '').is(':checked') : false;
                                    var code = isModified ? $(cbx).attr('data-code-alt') : $(cbx).val();
                                    var regex = new RegExp("^" + code + "$");
                                    var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                                    $(cbx).prop("checked", active);

                                });
                            }

                        });

                        $('[data-code-toggle=true][data-code][data-code-modifier][data-code-alt]').each(function (index, item) {
                            var oldCode = $(this).attr('data-code');
                            var alt = $(this).attr('data-code-alt');
                            var modifier = $(this).attr('data-code-modifier');

                            var isChecked = $('#' + modifier).is(':checked');
                            var code = !isChecked ? $(this).attr('data-code') : $(this).attr('data-code-alt');

                            var regex = new RegExp("^" + code + "$");
                            var active = _dtmShoppingCart.SearchItems(regex).length > 0;
                            setToggleButton(oldCode, active ? 'Add' : 'Remove');
                        });
                    }

                    $('[data-code-toggle=true]').removeClass('disableToggleClick');

                    //Check if cart has any multipay items
                    var hasMultipay = false;
                    for (var i = 0; i < data.items.length; i++) {
                        var item = data.items[i];
                        if (item && item.numpay && item.numpay > 1) {
                            hasMultipay = true;
                            break;
                        }
                    }

                    
                    //Toggle shipping Fields
                    toggleShippingFields(hasMultipay);
                    
                    data.hasMultipay = hasMultipay;
                    _dtmShoppingCart.HasMultipay = hasMultipay;
                    triggerEvent("CartChange", data);

                }, "json")
                .fail(function () {
                    if (typeof (onCartChangeComplete) == "function") {
                        onCartChangeComplete();
                    }
                    $('[data-code-toggle=true]').removeClass('disableToggleClick');
                });
            
    }

    function displayError(errorArray) {
        if (errorArray && errorArray.length > 0) {
            var ele = $('form').find('span[style="color: #FF0000; font-weight: bold"]');

            if (ele.length == 0 && $('.vse').length > 0) {
                ele = $('.vse');
            }

            if (_firstRun) {
                if (ele.children().length) {
                    $.each(ele.find('li'), function (index, item) {
                        data.errors.push($(item).text());
                    });
                }
            }

            var html = '<div class="validation-summary-errors"><span>The following errors have occured:</span>' + '<ul>';
            for (var i = 0; i < errorArray.length; i++) {
                if (html.indexOf(errorArray[i]) < 0) {
                    html += '<li>' + errorArray[i] + '</li>';
                }
            }
            html += '</ul></div>';
            if (!_firstRun) {
                ele.html(html);
                _dtmShoppingCart.ScrollToErrors(ele);
            } else {
                _firstRun = false;
            }
        } else if (!_firstRun) {
            var ele = $('form').find('span[style="color: #FF0000; font-weight: bold"]');
            if (ele.length == 0 && $('.vse').length > 0) {
                ele = $('.vse');
            }
            ele.html('');
        }
    }

    function setToggleButton(code, mode) {
        triggerEvent("ChangeToggleButtonState", {
            key: code,
            state: mode
        });
    }

    function registerEvent(evType, fn, element, useCapture) {
        var elm = element || window;
        if (elm.addEventListener) {
            elm.addEventListener(evType, fn, useCapture || false);
        }
        else if (elm.attachEvent) {
            var r = elm.attachEvent(evType, fn);
        }
        else {
            elm[evType] = fn;
        }
    }

    function triggerEvent(eventName, data, element) {
        try {
            var event;
            var payload = (data && typeof (data.detail) != "undefined")
                ? data
                : (data ? { detail: data } : { detail: '' });
            if (typeof window.CustomEvent === 'function') {
                event = new CustomEvent(eventName, payload || { detail: '' });
            } else if (document.createEvent) {
                event = document.createEvent('HTMLEvents');
                event.detail = payload.detail;
                event.initEvent(eventName, true, true);
            } else if (document.createEventObject) {
                event = document.createEventObject();
                event.detail = payload.detail;
                event.eventType = eventName;
            }
            event.eventName = eventName;
            var el = element || window;
            if (el.dispatchEvent) {
                el.dispatchEvent(event);
            } else if (el.fireEvent && htmlEvents[eventName]) {
                el.fireEvent(event.eventType, event);
            } else if (el[eventName]) {
                el[eventName]();
            } else if (el['on' + eventName]) {
                el['on' + eventName]();
            }
        } catch (error) {
            console.log('Error executing ' + name + ' Event');
        }
    }

    function getItemWithKeyValue(items, key, value) {
        for (var i = 0; i < items.length; i++) {
            var item = items[i];
            if (item[key] == value) {
                return item;
            }
        }
        return null;
    }

    function renderTr(dataItem, i) {
        if (!dataItem.props["HideProduct"]) {
            var tr = '<tr>';
            
            tr += '<td data-eflex--category-label="Item">' + dataItem.name + '</td>';
            
            var hasNoEditButton = $('[data-code=' + dataItem.code + '][data-code-toggle=true][data-noedit=true]').length > 0
                || $('[data-code][data-code-alt=' + dataItem.code + '][data-code-toggle=true][data-noedit=true]').length > 0;

            var noEditInput = $('[name=NoEdit][type=hidden]');
            if (noEditInput.length > 0) {
                var noEditArray = noEditInput.val().split(',');

                hasNoEditButton = (noEditArray.indexOf(dataItem.code) > -1);
            }
            let textBoxThresholdString = (dataItem.props["TextBoxThreshold"] === null || dataItem.props["TextBoxThreshold"] === undefined)
                ? "0"
                : dataItem.props["TextBoxThreshold"];
            let textBoxThreshold = parseInt(textBoxThresholdString);
            if (dataItem.props["NoEdit"] || hasNoEditButton) {
                tr += '<td data-cart-code="' + dataItem.code + 'Quantity" data-cart-noedit="true" data-eflex--category-label="Quantity">' + dataItem.qty + getQuantityHtml(dataItem, i) + '</td>';
            } else {
                tr += '<td data-cart-code="' + dataItem.code + 'Quantity" data-eflex--category-label="Quantity">' + getQtyDdl(dataItem, i, 'True', 'False', textBoxThreshold) + '</td>';
            }
        
            tr += '<td data-cart-code="' + dataItem.code + 'Price" data-eflex--category-label="Price">$' + (dataItem.price * dataItem.qty).toFixed(2) + '</td>';
            
            var currentItemIndex = ($('[name*=ActionCode][value="' + dataItem.id + '"]').attr('id') || '').replace('ActionCode', '');
            if (dataItem.props["NoEdit"]) {
                tr += '<td></td>';
            }
            else {
                tr += '<td><a href="javascript:void(0);" onclick="javascript:$(\'#ActionQuantity' + i + '\').val(0).trigger(\'change\');">Remove</td>';
            }
        
            tr += '</tr>';
            return tr;
        }
        return '';
    }

    function updateTr(dataItem, i) {
        var qtyTd = $("[data-cart-code='" + dataItem.code + "Quantity']");
        if (qtyTd.length != 0) {
            var Quantity = qtyTd.children("[name*='ActionQuantity']")[0];
            $(Quantity).val(dataItem.qty);
            if (qtyTd.attr('data-cart-noedit')) {
                qtyTd.html(dataItem.qty);
                qtyTd.append(Quantity);
            }

        
            $("[data-cart-code='" + dataItem.code + "Price']").html('$' + (dataItem.price * dataItem.qty).toFixed(2) + '');
            
        } else {
            i = $('#orderFormReviewTableItems').children("input").length;
            var tr = renderTr(dataItem, i);
            $('.reviewTableBody').append(tr);
        }


    }

    function updateCartItems(dataItems) {
        $(dataItems).each(function (index, item) {
            var exists = false;
            $(cartItems).each(function (i, cartItem) {
                if (cartItem.code == item.code) {
                    cartItem.added = true;
                    exists = true;
                    return;
                }
            });
            if (!exists) { cartItems.push({ code: item.code, added: true }) };
        });

        $(cartItems).each(function (index, cartItem) {
            var exists = false;
            $(dataItems).each(function (i, item) {
                if (cartItem.code == item.code) {
                    exists = true;
                    return;
                }
            });
            cartItem.added = exists;
        });
    }

    function updateRemovedTr() {

        $(cartItems).each(function (index, item) {
            if (!item.added) {
                var qtyTd = $("[data-cart-code='" + item.code + "Quantity']");
                var Quantity = qtyTd.children("[name*='ActionQuantity']")[0];
                $(Quantity).val('0');
                if (qtyTd.attr('data-cart-noedit')) {
                    qtyTd.html('0');
                    qtyTd.append(Quantity);
                }
        
                $("[data-cart-code='" + item.code + "Price']").html('$' + (0).toFixed(2) + '');
            
            }
        });
    }
    function setTax(data) {
        if (data != null) {

            var zip = $('.zc').val();
            var shipZip = $('#ShippingZip').val();
            var billZip = $('#BillingZip').val();
            var shipCity = $('#ShippingCity').val();
            var billCity = $('#BillingCity').val();
            var shipState = $('#ShippingState').val();
            var billState = $('#BillingState').val();
            var shipCountry = $('#ShippingCountry').val();
            var billCountry = $('#BillingCountry').val();

            if ($('#ShippingIsDifferentThanBilling').is(':checked') && lastChangeType == 'Shipping') {
                if (data.City != '' && data.City != null && shipCity == "") {
                    $('#ShippingCity').val(data.City);
                }
                if (data.CountryCode != '' && data.CountryCode != null && shipCountry == "") {
                    $('#ShippingCountry').val(data.CountryCode);
                }
                if (data.StateCode != '' && data.StateCode != null && shipState == "") {
                    $('#ShippingState').val(data.StateCode);
                }
                if (shipZip == "") {
                    $('#ShippingZip').val(zip);
                }
            } else {
                if (data.City != '' && data.City != null && billCity == "") {
                    $('#BillingCity').val(data.City);
                }
                if (data.CountryCode != '' && data.CountryCode != null && billCountry == "") {
                    $('#BillingCountry').val(data.CountryCode);
                }
                if (data.StateCode != '' && data.StateCode != null && billState == "") {
                    $('#BillingState').val(data.StateCode);
                }
                if (billZip == "") {
                    $('#BillingZip').val(zip);
                }
            }

            var fees = 0;
            if (data.Fees) {
                fees = data.Fees;
            }

            if (data.DeliveryFee != null) {
                $('.taxtotal').html('$' + ((data.Amount + fees) - data.DeliveryFee).toFixed(2));
                $('.summary-total').html('$' + data.TaxTotal.toFixed(2));
                $('#retailDeliveryFeeTotal').html('$' + data.DeliveryFee.toFixed(2));
            }
            else {
                $('.taxtotal').html('$' + (data.Amount + fees).toFixed(2));
            }
            $('.summary-total').html('$' + data.TaxTotal.toFixed(2));
        }
    }

    function getZip() {
        return $('#zc').val();
    }

    function getState() {
        return $('#ShippingIsDifferentThanBilling').is(':checked') ? $('#ShippingState').val() : $('#BillingState').val();
    }
    function getCountry() {
        return $('#ShippingIsDifferentThanBilling').is(':checked') ? $('#ShippingCountry').val() : $('#BillingCountry').val();
    }

    var currentzipcode = '', lastChangeType = '';
    function updateZip(zipcode, state, country) {
        if (zipcode != '' && zipcode != currentzipcode && zipcode.length >= 5) {
            currentzipcode = zipcode;
            $('.zc').val(zipcode);
            handleCartChange();
        }
    }
    

    registerEvent("CartChange", function () {
        updateParentCodeQuantity();
    });
    function getQtyDdl(item, index, allowZero, enableTextbox, textboxThreshold) {
        var html = "";

        if (item.id.indexOf("_LI") !== - 1) {
            var parentCode = item.id.split("_")[0];
            var childSuffix = item.id.split("_")[1];

            if (childSuffix == "LI1") {
                html += '<select id="LineItemQuantity' + index + '" name="LineItemQuantity' + index + '" data-parent-code="' + parentCode + '" data-index="' + index + '" onchange="$(\'#ActionQuantity' + index + '\').val(this.value);triggerEvent(\'ActionQuantityChange\', \'' + index + '\');">';
            }
            else {
                var parentCodeIndex = $("input[data-parent-code=" + parentCode + "]").attr("data-index");
                html += '<select id="LineItemQuantity' + index + '" name="LineItemQuantity' + index + '" data-parent-code="' + parentCode + '" data-index="' + parentCodeIndex + '" onchange="$(\'#ActionQuantity' + parentCodeIndex + '\').val(this.value);triggerEvent(\'ActionQuantityChange\', \'' + parentCodeIndex + '\');">';
            }
        }
        else if ((enableTextbox === "True" && item.qty >= textboxThreshold) || (enableTextbox === "True" && textboxThreshold === 0)) {
            html = '<input class="c-brand--form__input fx--animate o-box" type="number" value="' + item.qty + '" name="ActionQuantity' + index + '" id="ActionQuantity' + index + '" data-index="' + index + '" onchange="validateTextBoxInput(this,' + item.maxQty + ');$(\'#ActionQuantity' + index + '\').val(this.value);triggerEvent(\'ActionQuantityChange\', \'' + index + '\');">';
        }
        else {
            html = '<select id="ActionQuantity' + index + '" name="ActionQuantity' + index + '" data-index="' + index + '" onchange="$(\'#ActionQuantity' + index + '\').val(this.value);triggerEvent(\'ActionQuantityChange\', \'' + index + '\');">';
        }
        if (enableTextbox === "True" && item.qty < textboxThreshold) {
            for (var i = (allowZero != null && allowZero != 'False' ? 0 : item.minQty); i <= textboxThreshold; i++) {

                if (i === textboxThreshold && textboxThreshold !== 0) {
                    html += '<option value="' + i + '" ' + (item.qty == i ? 'selected="selected"' : '') + '>' + i + '+</option>';
                }
                else {
                    html += '<option value="' + i + '" ' + (item.qty == i ? 'selected="selected"' : '') + '>' + i + '</option>';
                }
            }
            html += ' </select>';
        }
        if (enableTextbox === "False") {
            for (var i = (allowZero != null && allowZero != 'False' ? 0 : item.minQty); i <= item.maxQty; i++) {
                html += '<option value="' + i + '" ' + (item.qty == i ? 'selected="selected"' : '') + '>' + i + '</option>';
            }
            html += ' </select>';
        }
        if (item.id.indexOf("_LI") !== -1) {
            var parentCode = item.id.split("_")[0];
            var childSuffix = item.id.split("_")[1];
            var quantity = item.qty;

            if (childSuffix == "LI1") {
                if ($("input[name=ActionQuantity" + index + "]").length === 0) {
                    $("#orderFormReviewTableItems").append("<input type='hidden' id='ActionQuantity" + index + "' name='ActionQuantity" + index + "' data-index='" + index + "' value='" + quantity + "' data-parent-code='" + parentCode + "' data-cart-code='" + parentCode + "Quantity'/>");
                }
            }
        }

        return html;
    }

    function updateParentCodeQuantity() {
        var items = getItems();
        var parentProducts = [];
        $("input[name^=ActionQuantity]").each(function () {
            var parentCode = $(this).attr("data-parent-code");
            if (typeof parentCode !== "undefined") {
                let hasProduct = false;
                $.each(items, function (key, value) {
                    if (parentCode === value.id) {
                        hasProduct = true;
                    }
                });
                if (hasProduct) {
                    parentProducts.push({ index: $(this).attr("data-index"), code: $(this).attr("data-parent-code") });
                }
                else {
                    $("[data-parent-code=" + parentCode + "]").remove();
                }
            }
        });
        var parentProductsCount = parentProducts.length;
        if (parentProductsCount > 0) {
            for (var i = 0; i < parentProductsCount; i++) {
                for (var j = 0; j < items.length; j++) {
                    if (parentProducts[i].code === items[j].id) {
                        $("input[name=ActionQuantity" + parentProducts[i].code + "]").val(items[j].qty);
                    }
                }
            }
        }
    }

    function getItemHtml(item, index) {
        var html = "";
        if (item.id.indexOf("_LI") !== -1) {
            var parentCode = item.id.split("_")[0];
            var childSuffix = item.id.split("_")[1];
            var parentIndex = $('[data-parent-code="' + parentCode + '"]').attr("data-index");

            if (childSuffix == "LI1" && $("input[name=ActionCode" + parentIndex + "]").length === 0) {
                html = '<input type="hidden" id="ActionCode' + parentIndex + '" name="ActionCode' + parentIndex + '"' + ' value="' + parentCode + '" />';
            }
        }
        else {
            html = '<input type="hidden" id="ActionCode' + index + '" name="ActionCode' + index + '"' + ' value="' + item.id + '" />';
        }
        return html;
    }

    function updateItemHtml(dataItem, i) {
        var i = $('#orderFormReviewTableItems').children("input").length;
        if ($('#orderFormReviewTableItems').children("[value='" + dataItem.code + "']").length == 0) {
            $('#orderFormReviewTableItems').append(getItemHtml(dataItem, i));
            i++;
        }
    }

    function getQuantityHtml(item, index) {
        return '<input type="hidden" id="ActionQuantity' + index + '" name="ActionQuantity' + index + '"' + ' value="' + item.qty + '" />';
    }

    function setItems(items) {
        $("[name*='ActionQuantity']").each(function (index, item) {
            $(item).val(0);
        });
        $.get(getCartUrl('ClearCart'), { t: new Date().getTime(), covid: 'b6a095f0-0809-ed11-8b97-a0369f1303c7', zipcode: getZip(), state: getState(), country: getCountry() }, function () {
            if (items && items.length > 0) {
                var html = '';
                for (var i = 0; i < items.length; i++) {
                    var item = items[i];

                    if (item.id && item.qty) {
                        html += '<input type="hidden" id="ActionCode' + i + '" name="ActionCode' + i + '" value="' + item.id + '" />'
                            + '<input type="hidden" id="ActionQuantity' + i + '" name="ActionQuantity' + i + '" value="' + item.qty + '" />';
                    }
                }
                $('#orderFormReviewTableItems').html(html);
                handleCartChange();
            }
        });
    }
    
    function getItems(items) {
        var uniqueItems = new Array();
        $("[name*='ActionQuantity']").each(function (index, item) {
            var id;
            var itemIndex = (item.getAttribute('data-index') ? item.getAttribute('data-index') : (item.id || '').replace('ActionQuantity', ''));
            if ($('[name="ActionCode' + itemIndex + '"]').length == 0 || 'radio,checkbox'.indexOf($('[name="ActionCode' + itemIndex + '"]').attr('type')) >= 0) {
                if ($('[name="ActionCode' + itemIndex + '"][data-upgrade]').length != 0) {
                    id = $('[name="ActionCode' + itemIndex + '"]').val();
                } else {
                    id = $('[name="ActionCode' + itemIndex + '"]:checked').val();
                }
            } else {
                id = $('[name="ActionCode' + itemIndex + '"]').val();
                if ($('[name="ActionCode' + itemIndex + '"]').attr('data-checkbox')) {
                    var checkBoxName = $('[name="ActionCode' + itemIndex + '"]').attr('name').replace('Code', 'Checkbox');
                    var checkBoxEle = $('[name="' + checkBoxName + '"]');

                    if (checkBoxEle.attr('data-new') == id) {
                        checkBoxEle.prop('checked', true);
                    }
                }
            }
            if (id != null && id != '' && id != 'none') {
                var qty = $(item).val();
                var atr;
                if ($('[name="ActionAttribute' + itemIndex + '"]').length == 0 || 'radio,checkbox'.indexOf($('[name="ActionAttribute' + itemIndex + '"]').attr('type')) >= 0) {
                    if ($('[name="ActionAttribute' + itemIndex + '"]').length == 1) {
                        atr = $('[name="ActionAttribute' + itemIndex + '"]:checked').val();
                    } else {
                        var allValues = new Array();
                        $.each($('[name="ActionAttribute' + itemIndex + '"]:checked'), function () {
                            allValues.push($(this).val());
                        });
                        atr = allValues.join(',');
                    }
                } else {
                    if ($('[name="ActionAttribute' + itemIndex + '"]').length == 1) {
                        atr = $('[name="ActionAttribute' + itemIndex + '"]').val();
                    } else {
                        var allValues = new Array();
                        $.each($('[name="ActionAttribute' + itemIndex + '"]'), function () {
                            allValues.push($(this).val());
                        });
                        atr = allValues.join(',');
                    }
                }
                if (uniqueItems[id]) {
                    for (var ui = 0; ui < uniqueItems.length; ui++) {
                        var uitem = uniqueItems[ui];
                        if (uitem.id == id) {
                            uitem.qty += parseInt(qty);
                            break;
                        }
                    }
                } else {
                    uniqueItems[id] = true;
                    uniqueItems[uniqueItems.length] = { id: id, qty: parseInt(qty), atr: atr };
                }

                if ($('[name="MatchProductQuantity' + itemIndex + '"]').length == 0 || 'radio,checkbox'.indexOf($('[name="MatchProductQuantity' + itemIndex + '"]').attr('type')) >= 0) {
                    var match = $('[name="MatchProductQuantity' + itemIndex + '"]:checked').val();
                } else {
                    var match = $('[name="MatchProductQuantity' + itemIndex + '"]').val();
                }
                if (typeof match != "undefined" && match.length > 0) {
                    if (uniqueItems[match]) {
                        for (var ui = 0; ui < uniqueItems.length; ui++) {
                            var uitem = uniqueItems[ui];
                            if (uitem.id == match) {
                                uitem.qty += parseInt(qty);
                                break;
                            }
                        }
                    } else {
                        uniqueItems[match] = true;
                        uniqueItems[uniqueItems.length] = { id: match, qty: parseInt(qty), atr: atr };
                    }
                }
            } else {
                console.log('id was blank, skipping.')
            }
        });
        return uniqueItems;
    }

    var DtmShoppingCart = function () {
        var self = this;
        self.scrollToTopPosition = parseFloat("-200");

        self.CurrentErrors = [];

        self.Count = function () {
            return self.Items().length;
        }

        self.Items = function () {
            return getItems();
        };

        self.HasMultipay = false;

        self.SearchItems = function (pattern) {
            var items = getItems();
            var results = [];

            results["TotalQuantity"] = 0;

            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                if (new RegExp(pattern).test(item.id)) {
                    results[results.length] = item;
                    results[item.id] = item;
                    results["TotalQuantity"] += item.qty;
                }
            }
            return results;
        };

        self.SetItems = function (items) {
            setItems(items);
        }

        self.AddErrors = function (errorsArray) {
            var allErrors = self.CurrentErrors.concat(errorsArray);

            var uniqueErrors = [];
            for (var i = 0, l = allErrors.length; i < l; i++) {
                if (uniqueErrors.indexOf(allErrors[i]) === -1) {
                    uniqueErrors.push(allErrors[i]);
                }
            }
            self.DisplayErrors(uniqueErrors, true);
            self.ScrollToErrors();
        };

        self.RemoveErrors = function (errorsArray) {
            var currentErrors = self.CurrentErrors;

            var uniqueErrors = [];
            for (var i = 0, l = currentErrors.length; i < l; i++) {
                var currentError = currentErrors[i];
                var alreadyExists = false;
                for (var j = 0; j < errorsArray.length; j++) {
                    var toRemoveError = errorsArray[j];

                    if (currentErrors.indexOf(toRemoveError) > -1 && currentError == toRemoveError) {
                        alreadyExists = true;
                    }
                }

                if (uniqueErrors.indexOf(currentError) === -1 && !alreadyExists) {
                    uniqueErrors.push(currentError);
                }
            }
            self.DisplayErrors(uniqueErrors, true);
        };

        self.ScrollToErrors = function (customElement) {
            if (self.CurrentErrors.length > 0) {
                var ele = getErrorElement();
                $.scrollTo(ele, { top: self.scrollToTopPosition });
            } else if (customElement) {
                $.scrollTo(customElement, { top: self.scrollToTopPosition });
            }
        };

        function getErrorElement() {
            var ele = $('form').find('span[style="color: #FF0000; font-weight: bold"]');

            if (ele.length == 0) {
                //For IE
                ele = $('form').find('span[style="color: rgb(255, 0, 0); font-weight: bold;"]');
            }

            if (ele.length == 0 && $('.vse').length > 0) {
                ele = $('.vse');
            }
            return ele;
        }

        self.UpgradeItem = function (currentCode, newCode) {
            var items = self.Items();

            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                if (item.id == currentCode) {
                    item.id = newCode;
                    break;
                }
            }

            self.SetItems(items);
        };

        self.DisplayErrors = function (errorsArray, show) {
            if (errorsArray && errorsArray.length > 0) {
                var ele = getErrorElement();

                if (_firstRun) {
                    if (ele.children().length) {
                        $.each(ele.find('li'), function (index, item) {
                            errorsArray.push($(item).text());
                        });
                    }
                }

                var html = '<div class="validation-summary-errors"><span>The following errors have occured:</span>' +
                    '<ul>';
                for (var i = 0; i < errorsArray.length; i++) {
                    if (html.indexOf(errorsArray[i]) < 0) {
                        html += '<li>' + errorsArray[i] + '</li>';
                    }
                }
                html += '</ul></div>';
                self.CurrentErrors = errorsArray;

                if (!_firstRun || show) {
                    ele.html(html);
                    self.ScrollToErrors();
                } else {
                    _firstRun = false;
                }

            } else if (!_firstRun || show) {
                var ele = getErrorElement();
                ele.html('');
                self.CurrentErrors = [];
            }
        };
    };
    var _dtmShoppingCart = new DtmShoppingCart();

   
    //Disable and hide Shipping checkbox if isMultipay = true
    function toggleShippingFields(isMultipay) {
        let shippingCbx = $("[name='ShippingIsDifferentThanBilling']:checkbox");
        let shippingLabel = $("#ShippingIsSame");
        if (!shippingLabel) {
            shippingLabel = shippingCbx.parent().parent();
        }

        if (isMultipay) {
            if (shippingCbx.is(":checked")) {
                shippingCbx.prop("checked", false);
                toggleShipping();
            }
            shippingCbx.prop("disabled", true);
            shippingLabel.hide();
        } else if ($('#otCARD').length == 0 || $('#otCARD').is(':checked')) {
            shippingCbx.prop("disabled", false);
            shippingLabel.show();
        }

    }


    registerEvent("PaymentOptionSelected", function () {
        if (_dtmShoppingCart) {
            toggleShippingFields(_dtmShoppingCart.HasMultipay);
        }
    });

    

</script>

</div>


<div class="l-controls left-absolute top-absolute @print-only-hide">
    <div id="rscContentTop"></div>

<div id="a_v_loader"></div>
<script id="track_script">

    var __pos;
    try {
        __pos = eval('[]')[0];
    } catch (err) { }
    var safe_referrer = (document.referrer == '' ? '' : document.referrer.split('?')[0]);
    var params = 'covid=b6a095f0-0809-ed11-8b97-a0369f1303c7&referrer=' + encodeURIComponent(safe_referrer);
    window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (str, key, value) {
        if (key != '' && key != null) {
            if (__pos && __pos[key] && window.location.search.indexOf(__pos[key]) < 0) {
                params += '&' + __pos[key] + '=' + value;
            }
            params += '&' + key + '=' + value;
        }
    });

    function areCookiesEnabled() {
        let cookiesEnabled = navigator.cookieEnabled;
        if (!cookiesEnabled) {
            document.cookie = "cookiemonster";
            cookiesEnabled = document.cookie.indexOf("cookiemonster") != -1;

            if (cookiesEnabled)
                document.cookie = "cookiemonster; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
        }
        return cookiesEnabled;
    }
    params += '&ace=' + areCookiesEnabled();

    var __trackscript = document.createElement("script");
    __trackscript.type = "text/javascript";
    __trackscript.src = '/ActivateVisitor/Index/?' + params;
    (document.getElementsByTagName("body")[0] || document.body || document.getElementsByTagName("head")[0] || document.head).appendChild(__trackscript);

    window.dtmVisitorCreated = true;

    
</script>
<noscript>
    
    <iframe src="https://idvftfbs.dtmstage.com/ActivateVisitor/Index?covid=b6a095f0-0809-ed11-8b97-a0369f1303c7&amp;ifr=1&amp;"></iframe>
    
</noscript>

<link href="https://idvftfbs.dtmstage.com/Shared/css/jquery-ui.custom.min.css?v=6.0.1722.1545" rel="stylesheet" />
<style>
    .ui-menu {
        border-radius: 0.5em;
        line-height: 1.25;
        padding: 0;
        overflow: hidden;
        color: #1C3144;
        font-size: 1.25rem;
        font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
        border-color: hsl(0, 0%, 80%);
        box-shadow: 0 0 1em hsla(0, 0%, 0%, 0.2);
    }

    .ui-menu .ui-menu-item {
        display: block;
        padding: 1em 0;
        margin: 0 1.25em;
        width: auto;
        box-sizing: border-box;
    }

    .ui-menu .ui-menu-address {
        position: relative;
        display: flex;
        align-items: flex-end;
        transition: transform .3s ease-in-out, opacity .3s ease-in-out;
    }

    .ui-menu-address {
        transform: translateX(2%);
        opacity: .69;
    }

    .ui-menu-droppin {
        width: 1em;
        height: 1em;
        margin-right: 0.5em;
        position: relative;
        align-self: center;
        transition: transform .3s ease-in-out;
        transform-origin: 35% 40%;
    }

    .ui-menu-droppin::before,
    .ui-menu-droppin::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        margin: auto;
        transition: transform .3s ease-in-out, opacity .3s ease-in-out;
    }

    .ui-menu-droppin::before {
        background: url(https://idvftfbs.dtmstage.com/shared/images/icons/drop-pin.svg) no-repeat;
    }

    .ui-menu-droppin::after {
        background: url(https://idvftfbs.dtmstage.com/shared/images/icons/drop-pin-color.svg) no-repeat;
        opacity: 0;
    }

    .ui-menu-item:hover .ui-menu-droppin,
    .ui-state-focus .ui-menu-droppin {
        transform: rotate(-90deg);
        align-self: flex-end;
    }

    .ui-menu-item:hover .ui-menu-address,
    .ui-state-focus .ui-menu-address {
        transform: translateX(0);
        opacity: 1;
    }

    .ui-menu-item:hover .ui-menu-droppin::before,
    .ui-state-focus .ui-menu-droppin::before,
    .ui-menu-droppin::after {
        opacity: 0;
        transform: scale(0);
    }

    .ui-menu-droppin::before,
    .ui-state-focus .ui-menu-droppin::after,
    .ui-menu-item:hover .ui-menu-droppin::after {
        opacity: 1;
        transform: scale(1);
    }

    .ui-menu .ui-menu-item:not(:last-child) {
        border-bottom: 0.1em solid #ccc;
    }

    .ui-menu .ui-menu-logo {
        margin: 0;
        display: flex;
        align-items: center;
        opacity: 1;
    }

    .ui-menu-address > strong {
        margin-right: 0.5em;
    }

    .ui-menu-address > small {
        color: gray;
    }

    .ui-menu-logo img {
        max-width: 120px;
        width: auto;
    }

    .ui-menu .ui-state-focus,
    .ui-menu .ui-state-hover {
        background: none;
        color: currentColor;
        border: none;
        font-weight: inherit;
        cursor: pointer;
    }
</style> 

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&key=AIzaSyBhtEs33yVV7l4K9pcx-Aph1rdEdXkT0uQ"></script>

<style>
    
    /* This allows Google suggestion box to expand fluidly and prevent cut-off text */
    .pac-container {
        width: auto !important;
    }
    
</style>
<script> 
    if (typeof (AddressEngine) != "function") {
        var AddressEngine = function (config) {
            var self = this;

            self.IsInitial = true;
            self.labels = [];
            self.placeholders = [];
            self.countries = [];
            self.territories = [];
            self.alwaysShowCardTypes = true;
            self.config = config || {};
            self.allowSearch = false;
            self.disable = false;
            self.sessionId = '49cbffc9-781e-4879-b5ab-80a3546ae81c';
            self.PlacesChoiceId = "";
            self.defaultCountry = '';
            self.currentCountry = '';

                
            self.territories[self.territories.length] = {
                code: 'GU',
                name: 'Guam',
                twoDigit: 'GU',
                threeDigit: ''
            };
                
            self.territories[self.territories.length] = {
                code: 'VI',
                name: 'Virgin Islands',
                twoDigit: 'VI',
                threeDigit: ''
            };
                
            self.territories[self.territories.length] = {
                code: 'PR',
                name: 'Puerto Rico',
                twoDigit: 'PR',
                threeDigit: ''
            };
                
            self.countries[self.countries.length] = {
                code: 'USA',
                name: 'United States',
                twoDigit: 'US',
                threeDigit: 'USA'
            };
            

            self.states = [];
            
            self.states[self.states.length] = {
                code: 'AL',
                name: 'Alabama',
                twoDigit: 'AL'
            };
            
            self.states[self.states.length] = {
                code: 'AK',
                name: 'Alaska',
                twoDigit: 'AK'
            };
            
            self.states[self.states.length] = {
                code: 'AZ',
                name: 'Arizona',
                twoDigit: 'AZ'
            };
            
            self.states[self.states.length] = {
                code: 'AR',
                name: 'Arkansas',
                twoDigit: 'AR'
            };
            
            self.states[self.states.length] = {
                code: 'CA',
                name: 'California',
                twoDigit: 'CA'
            };
            
            self.states[self.states.length] = {
                code: 'CO',
                name: 'Colorado',
                twoDigit: 'CO'
            };
            
            self.states[self.states.length] = {
                code: 'CT',
                name: 'Connecticut',
                twoDigit: 'CT'
            };
            
            self.states[self.states.length] = {
                code: 'DE',
                name: 'Delaware',
                twoDigit: 'DE'
            };
            
            self.states[self.states.length] = {
                code: 'DC',
                name: 'District Of Columbia',
                twoDigit: 'DC'
            };
            
            self.states[self.states.length] = {
                code: 'FL',
                name: 'Florida',
                twoDigit: 'FL'
            };
            
            self.states[self.states.length] = {
                code: 'GA',
                name: 'Georgia',
                twoDigit: 'GA'
            };
            
            self.states[self.states.length] = {
                code: 'HI',
                name: 'Hawaii',
                twoDigit: 'HI'
            };
            
            self.states[self.states.length] = {
                code: 'ID',
                name: 'Idaho',
                twoDigit: 'ID'
            };
            
            self.states[self.states.length] = {
                code: 'IL',
                name: 'Illinois',
                twoDigit: 'IL'
            };
            
            self.states[self.states.length] = {
                code: 'IN',
                name: 'Indiana',
                twoDigit: 'IN'
            };
            
            self.states[self.states.length] = {
                code: 'IA',
                name: 'Iowa',
                twoDigit: 'IA'
            };
            
            self.states[self.states.length] = {
                code: 'KS',
                name: 'Kansas',
                twoDigit: 'KS'
            };
            
            self.states[self.states.length] = {
                code: 'KY',
                name: 'Kentucky',
                twoDigit: 'KY'
            };
            
            self.states[self.states.length] = {
                code: 'LA',
                name: 'Louisiana',
                twoDigit: 'LA'
            };
            
            self.states[self.states.length] = {
                code: 'ME',
                name: 'Maine',
                twoDigit: 'ME'
            };
            
            self.states[self.states.length] = {
                code: 'MD',
                name: 'Maryland',
                twoDigit: 'MD'
            };
            
            self.states[self.states.length] = {
                code: 'MA',
                name: 'Massachusetts',
                twoDigit: 'MA'
            };
            
            self.states[self.states.length] = {
                code: 'MI',
                name: 'Michigan',
                twoDigit: 'MI'
            };
            
            self.states[self.states.length] = {
                code: 'MN',
                name: 'Minnesota',
                twoDigit: 'MN'
            };
            
            self.states[self.states.length] = {
                code: 'MS',
                name: 'Mississippi',
                twoDigit: 'MS'
            };
            
            self.states[self.states.length] = {
                code: 'MO',
                name: 'Missouri',
                twoDigit: 'MO'
            };
            
            self.states[self.states.length] = {
                code: 'MT',
                name: 'Montana',
                twoDigit: 'MT'
            };
            
            self.states[self.states.length] = {
                code: 'NE',
                name: 'Nebraska',
                twoDigit: 'NE'
            };
            
            self.states[self.states.length] = {
                code: 'NV',
                name: 'Nevada',
                twoDigit: 'NV'
            };
            
            self.states[self.states.length] = {
                code: 'NH',
                name: 'New Hampshire',
                twoDigit: 'NH'
            };
            
            self.states[self.states.length] = {
                code: 'NJ',
                name: 'New Jersey',
                twoDigit: 'NJ'
            };
            
            self.states[self.states.length] = {
                code: 'NM',
                name: 'New Mexico',
                twoDigit: 'NM'
            };
            
            self.states[self.states.length] = {
                code: 'NY',
                name: 'New York',
                twoDigit: 'NY'
            };
            
            self.states[self.states.length] = {
                code: 'NC',
                name: 'North Carolina',
                twoDigit: 'NC'
            };
            
            self.states[self.states.length] = {
                code: 'ND',
                name: 'North Dakota',
                twoDigit: 'ND'
            };
            
            self.states[self.states.length] = {
                code: 'OH',
                name: 'Ohio',
                twoDigit: 'OH'
            };
            
            self.states[self.states.length] = {
                code: 'OK',
                name: 'Oklahoma',
                twoDigit: 'OK'
            };
            
            self.states[self.states.length] = {
                code: 'OR',
                name: 'Oregon',
                twoDigit: 'OR'
            };
            
            self.states[self.states.length] = {
                code: 'PA',
                name: 'Pennsylvania',
                twoDigit: 'PA'
            };
            
            self.states[self.states.length] = {
                code: 'RI',
                name: 'Rhode Island',
                twoDigit: 'RI'
            };
            
            self.states[self.states.length] = {
                code: 'SC',
                name: 'South Carolina',
                twoDigit: 'SC'
            };
            
            self.states[self.states.length] = {
                code: 'SD',
                name: 'South Dakota',
                twoDigit: 'SD'
            };
            
            self.states[self.states.length] = {
                code: 'TN',
                name: 'Tennessee',
                twoDigit: 'TN'
            };
            
            self.states[self.states.length] = {
                code: 'TX',
                name: 'Texas',
                twoDigit: 'TX'
            };
            
            self.states[self.states.length] = {
                code: 'UT',
                name: 'Utah',
                twoDigit: 'UT'
            };
            
            self.states[self.states.length] = {
                code: 'VT',
                name: 'Vermont',
                twoDigit: 'VT'
            };
            
            self.states[self.states.length] = {
                code: 'VA',
                name: 'Virginia',
                twoDigit: 'VA'
            };
            
            self.states[self.states.length] = {
                code: 'WA',
                name: 'Washington',
                twoDigit: 'WA'
            };
            
            self.states[self.states.length] = {
                code: 'WV',
                name: 'West Virginia',
                twoDigit: 'WV'
            };
            
            self.states[self.states.length] = {
                code: 'WI',
                name: 'Wisconsin',
                twoDigit: 'WI'
            };
            
            self.states[self.states.length] = {
                code: 'WY',
                name: 'Wyoming',
                twoDigit: 'WY'
            };
            

            var defaultLanguage = {
                type: 'English',
                CardNumberLabel: 'Card Number',
                CardNumberPlaceholder: '#### #### #### ####',
                CardExpirationLabel: 'Expiration Date',
                CardExpirationPlaceholder: 'MM/YYYY',
                CardCvv2Label: 'CVV2',
                CardCvv2Placeholder: '###',
                FullNameLabel: 'Full Name',
                FullNamePlaceholder: '*Full Name',
                FirstNameLabel: 'First Name',
                FirstNamePlaceholder: '*First Name',
                LastNameLabel: 'Last Name',
                LastNamePlaceholder: '*Last Name',
                FullStreetLabel: 'Address',
                FullStreetPlaceholder: '*Address',
                StreetLabel: 'Address',
                StreetPlaceholder: '*Address',
                Street2Label: 'Address 2',
                Street2Placeholder: 'Suite / Apt',
                CityLabel: 'City',
                CityPlaceholder: '*City',
                ZipLabel: 'Zip Code',
                ZipPlaceholder: '*Zip Code',
                StateLabel: 'State',
                StatePlaceholder: '*State',
                CountryLabel: 'Country',
                CountryPlaceholder: '*Country',
                PhoneLabel: 'Phone',
                PhonePlaceholder: '*Phone',
                EmailLabel: 'Email',
                EmailPlaceholder: '*Email'
            };
            var labels = [
                {
                    type: "",
                    CardNumberLabel: '',
                    CardNumberPlaceholder: '*Card Number',
                    CardExpirationLabel: '',
                    CardExpirationPlaceholder: '',
                    CardCvv2Label: '',
                    CardCvv2Placeholder: '',
                    FullNameLabel: '',
                    FullNamePlaceholder: '*Full Name:',
                    FirstNameLabel: '',
                    FirstNamePlaceholder: '*First Name:',
                    LastNameLabel: '',
                    LastNamePlaceholder: '*Last Name:',
                    FullStreetLabel: '',
                    FullStreetPlaceholder: '',
                    StreetLabel: '',
                    StreetPlaceholder: '',
                    Street2Label: '',
                    Street2Placeholder: '',
                    CityLabel: '',
                    CityPlaceholder: 'City',
                    ZipLabel: '',
                    ZipPlaceholder: 'Zip Code',
                    StateLabel: '',
                    StatePlaceholder: 'Choose State',
                    CountryLabel: '',
                    CountryPlaceholder: 'Choose Country',
                    PhoneLabel: '',
                    PhonePlaceholder: '*Phone Number',
                    EmailLabel: '',
                    EmailPlaceholder: 'example@email.com',
                },
                defaultLanguage,
                {
                    type: 'French',
                    CardNumberLabel: 'Numéro de carte',
                    CardNumberPlaceholder: '#### #### #### ####',
                    CardExpirationLabel: 'Date d\'expiration',
                    CardExpirationPlaceholder: 'MM/YYYY',
                    CardCvv2Label: 'CVV2',
                    CardCvv2Placeholder: '###',
                    FullNameLabel: 'Nom complet',
                    FullNamePlaceholder: '*Nom complet',
                    FirstNameLabel: 'Prénom',
                    FirstNamePlaceholder: '*Prénom',
                    LastNameLabel: 'Nom de famille',
                    LastNamePlaceholder: '*Nom de famille',
                    FullStreetLabel: 'Adresse de la rue',
                    FullStreetPlaceholder: '*Adresse',
                    StreetLabel: 'Adresse',
                    StreetPlaceholder: '*Adresse',
                    Street2Label: 'Adresse 2',
                    Street2Placeholder: 'Suite / Apt',
                    CityLabel: 'Ville',
                    CityPlaceholder: '*Ville',
                    ZipLabel: 'Le code postal',
                    ZipPlaceholder: '*Le code postal',
                    StateLabel: 'Etat',
                    StatePlaceholder: '*Etat',
                    CountryLabel: 'Pays',
                    CountryPlaceholder: '*Pays',
                    PhoneLabel: 'Téléphone',
                    PhonePlaceholder: '*Numéro de téléphone',
                    EmailLabel: 'Email',
                    EmailPlaceholder: '*email@domain.com'
                },
                {
                    type: 'Spanish',
                    CardNumberLabel: 'Número de tarjeta',
                    CardNumberPlaceholder: '#### #### #### ####',
                    CardExpirationLabel: 'Vencimiento',
                    CardExpirationPlaceholder: 'MM/YYYY',
                    CardCvv2Label: 'CVV2',
                    CardCvv2Placeholder: '###',
                    FullNameLabel: 'Nombre completo',
                    FullNamePlaceholder: '*Nombre completo',
                    FirstNameLabel: 'Nombre de pila',
                    FirstNamePlaceholder: '*Nombre de pila',
                    LastNameLabel: 'Apellido',
                    LastNamePlaceholder: '*Apellido',
                    FullStreetLabel: 'Dirección',
                    FullStreetPlaceholder: '*Dirección',
                    StreetLabel: 'Dirección',
                    StreetPlaceholder: '*Dirección',
                    Street2Label: 'Dirección 2',
                    Street2Placeholder: 'Suite / Apt',
                    CityLabel: 'Ciudad',
                    CityPlaceholder: '*Ciudad',
                    ZipLabel: 'Código postal',
                    ZipPlaceholder: '*Código postal',
                    StateLabel: 'Estado',
                    StatePlaceholder: '*Estado',
                    CountryLabel: 'País',
                    CountryPlaceholder: '*País',
                    PhoneLabel: 'Teléfono',
                    PhonePlaceholder: '*Teléfono',
                    EmailLabel: 'Correo electrónico',
                    EmailPlaceholder: '*Correo electrónico'
                }
            ];

            self.isMatch = function (a, b) {
                return a != null && b != null
                    && a.toUpperCase().trim() == b.toUpperCase().trim();
            };

            self.getCountryCode = function (value) {
                for (var i = 0; i < self.countries.length; i++) {
                    var country = self.countries[i];
                    if (self.isMatch(country.twoDigit, value)
                        || self.isMatch(country.threeDigit, value)
                        || self.isMatch(country.name, value)) {
                        return country.code;
                    }
                }
                return value;
            }

            self.getStateCode = function (value) {
                for (var i = 0; i < self.states.length; i++) {
                    var state = self.states[i];
                    if (self.isMatch(state.twoDigit, value)
                        || self.isMatch(state.name, value)) {
                        return state.code;
                    }
                }
                return value;
            }

            function getAddressType(target) {
                if (target.attr('name').indexOf('Shipping') >= 0)
                    return 'Shipping';
                return 'Billing';
            };

            self.setAddress = function (target, data) {
                var addressType = getAddressType(target);

                var cleanValue = function (name, value) {
                    if (name.indexOf('Country') >= 0) {
                        value = self.getCountryCode(value);
                    }
                    if (name.indexOf('State') >= 0) {
                        value = self.getStateCode(value);
                    }
                    return value;
                };

                var setInputValue = function (name, value) {
                    var id = addressType + name;
                    var ele = $('#' + id);
                    var isValidValue = false;
                    value = cleanValue(name, value);
                    if (ele.length > 0) {
                        if (ele.is('select')) {
                            if ($("#" + id + " option[value='" + value + "']").length != 0) {
                                isValidValue = true;
                            }
                        } else if (ele.is('input')) {
                            isValidValue = true;

                        }
                    }
                    if (isValidValue && value != null) {
                        ele.val(value.trim());
                    }
                    return ele;
                };

                setInputValue('FullStreet', data.Street + ' ' + data["Street2"]);
                setInputValue('Street', data.Street);
                setInputValue('Street2', data["Street2"]);
                setInputValue('City', data.City);
                setInputValue('Country', data.Country);
                setInputValue('State', data.State);
                setInputValue('Zip', data.PostalCode).trigger('keyup');

                if (typeof triggerEvent == 'function') {
                    triggerEvent("GoogleAutoComplete_AddressUpdated");
                }
                
            }

            self.setFormLanguage = function (language) {
                var collection = null;
                for (var i = 0; i < labels.length; i++) {
                    var languageCollection = labels[i];
                    if (languageCollection.type == "LM" || languageCollection.type.toLowerCase() == language.toLowerCase()) {
                        collection = languageCollection;
                        break;
                    }
                }
                if (collection == null) {
                    collection = defaultLanguage;
                }
                self.labels = collection;

                self.processLabels();
            };

            self.processLabel = function (type, name) {
                var id = type + name;
                var fieldCt = $('#' + id + 'Ct');
                if (config.enableTransformLabels) {
                    if (fieldCt.length > 0) {
                        var fieldLabel = fieldCt.find('label.label');
                        if (fieldLabel.length == 0) {
                            fieldLabel = fieldCt.find('label:first');
                        }
                        if (fieldLabel.length > 0) {
                            var newLabel = self.labels[name + 'Label'];
                            if (typeof (newLabel) != "undefined") {
                                var isRequired = fieldLabel.find('span:contains("*")').length > 0;
                                var template = (isRequired ? '<span class="requiredIcon">*</span>' : '') + newLabel + '<span class="labelColon">:</span>';
                                fieldLabel.html(template);
                            }
                        }
                    }
                }

                var item = $('#' + id);
                if (item.length > 0) {
                    if (item.is('select')) {
                        if (item.find(':first').text().indexOf('Choose') > -1) {
                            item.find(':first').text('Choose ' + self.labels[name + 'Label']);
                        }
                    } else if (item.is('input')) {
                        item.attr('placeholder', self.labels[name + 'Placeholder']);
                    }
                }
            };

            self.processLabels = function () {
                var addressFormItems = ['FullName', 'FirstName', 'LastName', 'FullStreet', 'Street', 'Street2', 'City', 'Zip', 'State', 'Country'];
                var addressTypes = ['Billing', 'Shipping'];
                for (var i = 0; i < addressFormItems.length; i++) {
                    var addressFormItem = addressFormItems[i];
                    for (var j = 0; j < addressTypes.length; j++) {
                        var type = addressTypes[j];
                        self.processLabel(type, addressFormItem);
                    }
                }
                var formItems = ['Phone', 'Email', 'CardNumber', 'CardExpiration', 'CardCvv2'];
                for (var k = 0; k < formItems.length; k++) {
                    var formItem = formItems[k];
                    self.processLabel('', formItem);
                }
            };

            function mutatePaymentForm() {
                var billingInfo = $("#billingInformation");
                var paymentInfo = $("#paymentForm");
                var paymentInfoParent = paymentInfo.parent();
                billingInfo.parent().prepend(paymentInfo);
                paymentInfoParent.prepend(billingInfo);
                if ($('#productSelection').val() != undefined) {
                    billingInfo.parent().prepend($('#productSelection'));
                }
            }

            self.onNameChange = function () {
                var value = $(this).val();
                var type = getAddressType($(this));

                if (value) {
                    value = value.replace(/\s+/gi, ' ').trim();
                    var results = value.split(' ');

                    var firstName = results.length > 0 ? $.trim(results[0]) : '';
                    var lastName = value.substr(results[0].length, value.length).trim();
                    $("#" + type + "FirstName").val(firstName);
                    $("#" + type + "LastName").val(lastName);
                }
            };

            self.greyCards = function () {
                if (!self.alwaysShowCardTypes) {
                    $('#visaImg').attr('src', '/shared/images/visa-g.png?v=6.0.1722.1545');
                    $('#amexImg').attr('src', '/shared/images/amex-g.png?v=6.0.1722.1545');
                    $('#discoverImg').attr('src', '/shared/images/discover-g.png?v=6.0.1722.1545');
                    $('#mastercardImg').attr('src', '/shared/images/mastercard-g.png?v=6.0.1722.1545');
                }
            };

            self.showAllCardsInColor = function () {
                $('#visaImg').attr('src', '/shared/images/payment/visa.svg?v=6.0.1722.1545');
                $('#amexImg').attr('src', '/shared/images/payment/amex.svg?v=6.0.1722.1545');
                $('#discoverImg').attr('src', '/shared/images/payment/discover.svg?v=6.0.1722.1545');
                $('#mastercardImg').attr('src', '/shared/images/payment/mastercard.svg?v=6.0.1722.1545');
            };

            self.evaluateCardType = function () {
                if ($('#CardNumber').val()) {
                    var cardNumber = $('#CardNumber');
                    self.greyCards();
                    if (cardNumber.val()[0] === "4") {
                        $('#visaImg').attr('src', '/shared/images/payment/visa.svg?v=6.0.1722.1545');
                        $('#CardType').val("V");
                    } else if (cardNumber.val()[0] === "3") {
                        $('#amexImg').attr('src', '/shared/images/payment/amex.svg?v=6.0.1722.1545');
                        $('#CardType').val("AX");
                    } else if (cardNumber.val()[0] === "6") {
                        $('#discoverImg').attr('src', '/shared/images/payment/discover.svg?v=6.0.1722.1545');
                        $('#CardType').val("D");
                    } else if (cardNumber.val()[0] === "5") {
                        $('#mastercardImg').attr('src', '/shared/images/payment/mastercard.svg?v=6.0.1722.1545');
                        $('#CardType').val("M");
                    } else {
                        $('#CardType').val("M");
                    }
                } else {
                    self.showAllCardsInColor();
                }
            };

            self.drawPayment = function (target) {
                var cardTypeHost = $(target);
                if (cardTypeHost.length > 0) {
                    cardTypeHost.find('img').remove();
                }
                self.greyCards();

                var cardNumber = $('#CardNumber');

                $('#CardTypeCt').remove();
                if ($('#CardType').length == 0) {
                    cardNumber.parent().append("<input type='hidden' id='CardType' name='CardType' />");
                }
                if (cardNumber.length > 0) {
                   cardNumber.on('keyup change input', self.evaluateCardType);
                }

                var allowedCards = config.payment.allowedCards;
                if (allowedCards == "" || allowedCards == null) {
                    allowedCards = ["visa", "mastercard", "amex", "discover"];
                } else {
                    allowedCards = allowedCards.split(',');
                }
                
                for (var i = 0; i < allowedCards.length; i++) {
                    var allowedCardType = allowedCards[i].toLowerCase();
                    var cardImage = cardTypeHost.find('#' + allowedCardType + 'Img');
                    if (cardImage.length > 0) {
                        cardImage.show();
                    } else {
                        cardTypeHost.append("<img id='" + allowedCardType + "Img' src='https://idvftfbs.dtmstage.com/shared/images/payment/&quot;&#32;+&#32;allowedCardType&#32;+&#32;&quot;.svg?v=6.0.1722.1545' alt='" + allowedCardType + " accepted.' width='37'>");
                    }
                }
            };

            self.transform = function () {
                if (config.mergeName) {
                    var twoBecomeOne = function (type, label, placeholder) {
                        var firstName = $('#' + type + 'FirstNameCt');
                        var firstNameValue = typeof $('#' + type + 'FirstName').val() == "undefined" ? "" : $('#' + type + 'FirstName').val() ;
                        var lastName = $('#' + type + 'LastNameCt');
                        var lastNameValue = typeof $('#' + type + 'LastName').val() == "undefined" ? "" : $('#' + type + 'LastName').val();
                        if (firstName.length > 0 && lastName.length > 0) {
                            /* @NOTE: let CSS template handle whether the labeling should be displayed or not */
                            var hasVisibleLabel = $("#" + type + "FirstNameCt").find('label:first').is(':visible');
                            var classes = $("#" + type + "FirstNameCt").find('input:first').attr('class');
                            var template = "<div id='" + type + "FullNameCt' class='fldCt required'>" +
                                "<label class='label' style='" + (hasVisibleLabel ? '' : '') + "'><span class='requiredIcon'>*</span>" + label + "<span class='labelColon'>:</span></label>" +
                                "<span class='fld'><input id='" + type + "FullName' maxlength='100' name='" + type + "FullName' type='text' placeholder='" + placeholder + "' value='' class='" + classes + "'></span>" +
                                "</div>" +
                                "<input id='" + type + "FirstName' name='" + type + "FirstName' type='hidden' value='"+ firstNameValue +"' >" +
                                "<input id='" + type + "LastName' name='" + type + "LastName' type='hidden' value='" + lastNameValue +"'>";
                            var deployTo = ($("#" + type.toLowerCase() + "Information").length > 0 ? $("#" + type.toLowerCase() + "Information") : null) || $("#" + type + "FirstNameCt").parent()
                            deployTo
                                .find("#" + type + "FirstNameCt")
                                .before(template);
                            $("#" + type + "FirstNameCt").remove();
                            $("#" + type + "LastNameCt").remove();
                            $("#" + type + "FullName").on('change input keyup blur', self.onNameChange);
                        }
                    };

                    twoBecomeOne('Billing', self.labels["FullNameLabel"], self.labels["FullNamePlaceholder"]);
                    twoBecomeOne('Shipping', self.labels["FullNameLabel"], self.labels["FullNamePlaceholder"]);
                }

                if (config.mergeAddress) {
                    var allForOne = function (type) {
                        var allowHiding = $('#' + type + 'Street').val() == '';
                        var checkAndHide = function (name) {
                            if ($('#' + type + name + 'Ct').length > 0 && allowHiding) {
                                $('#' + type + name + 'Ct').hide();
                            }
                        };
                        checkAndHide('Street2');
                        checkAndHide('City');
                        checkAndHide('State');
                        checkAndHide('Zip');
                        checkAndHide('Country');

                        if ($('#' + type + 'Street').length > 0) {
                            $('#' + type + 'Street').on('blur input change', function () {
                                var checkAndShow = function (name) {
                                    if ($('#' + type + name + 'Ct').length > 0 && !$('#' + type + name + 'Ct').is(':visible')) {
                                        $('#' + type + name + 'Ct').show();
                                    }
                                };
                                checkAndShow('Street2');
                                checkAndShow('City');
                                checkAndShow('State');
                                checkAndShow('Zip');
                                checkAndShow('Country');
                            });
                        }
                    };

                    allForOne('Billing');
                }

                if (config.movePayment) {
                    mutatePaymentForm();
                }

                if (config.payment) {
                    self.drawPayment('.ccImage, #cc');
                }

                self.setFormLanguage(config.language);
            };

            self.addressAutocomplete = function () {
                if (config.enableServerMode) {
                    
                } else {
                    var initialize = function () {
                        var acRaw = [];
                        var allowedCountries = [];
                        acRaw = acRaw.concat(self.countries);
                        if (self.territories && self.territories.length > 0) {
                            acRaw = acRaw.concat(self.territories);
                        }

                        for (var i = 0; i < acRaw.length; i++) {
                            allowedCountries.push(acRaw[i].twoDigit);
                        }

                        var componentRestrictions = self.countries && self.countries.length == 1 ? { country: allowedCountries } : null;
                        var payload = {
                            autocomplete: 'false'
                        };
                        if (componentRestrictions != null) {
                            payload['componentRestrictions'] = componentRestrictions;
                        }

                        var linkAddress = function (addressType) {
                            if ($('#' + addressType + 'Street').length == 0) return;
                            var input = document.getElementById(addressType + 'Street');
                            var autocomplete = new google.maps.places.Autocomplete(input, payload);

                            google.maps.event.addListener(autocomplete, 'place_changed', function () {
                                var place = autocomplete.getPlace();

                                if (!place.geometry) {
                                    // User entered the name of a Place that was not suggested and
                                    // pressed the Enter key, or the Place Details request failed.
                                    return;
                                }

                                var addressTypes = ['street_number', 'route', 'locality', 'postal_code', 'administrative_area_level_1', 'country'];
                                var address = { Street: '', City: '', PostalCode: '', State: '', Country: '' };
                                var usTerritory =  ["PR", "GU", "VI" ];
                                var isUsTerritory = false;
                                var isUSA = false;
                                
                                for (var i = 0; i < place.address_components.length; i++) {
                                    var component = place.address_components[i];
                                    var type = component.types[0];
                                    var value = component["short_name"];
                                    if (addressTypes.indexOf(type) > -1) {

                                        if(type== 'country')
                                        {
                                            if (usTerritory.indexOf(value) > -1)
                                            {
                                                isUsTerritory = true;
                                                isUSA = true;
                                                break;
                                            }
                                            if (value == "US")
                                            {
                                                isUSA = true;
                                            }
                                        }
                                    }
                                }

                                for (var i = 0; i < place.address_components.length; i++) {
                                    var component = place.address_components[i];
                                    var type = component.types[0];
                                    var value = component["short_name"];
                                    if (addressTypes.indexOf(type) > -1) {
                                        switch (type) {
                                            case 'street_number':
                                                address.Street = value + ' ' + address.Street;
                                                break;
                                            case 'route':
                                                address.Street = address.Street + value;
                                                break;
                                            case 'locality':
                                                address.City = value;
                                                break;
                                            case 'postal_code':
                                                address.PostalCode = value;
                                                break;
                                            case 'administrative_area_level_1':
                                                address.State = value;
                                                break;
                                            case 'country':
                                                address.Country = value;
                                                break;
                                        }
                                    }
                                }

                                if (isUsTerritory)
                                {
                                    var state = address.State;
                                    var country = address.Country
                                    address.State = country;
                                    address.Country = "USA";
                                }

                                //If NOT USA , zip field changes to type 'text' to show keyboard on mobile devices
                                if (isUSA) {
                                    if ($('#BillingZip').length) {
                                        $('#BillingZip').attr("type", "tel");
                                    }
                                    if ($('#ShippingZip').length) {
                                        $('#ShippingZip').attr("type", "tel");
                                    }                                   
                                }
                                else {
                                    if ($('#BillingZip').length) {
                                        $('#BillingZip').attr("type", "text");
                                    }
                                    if ($('#ShippingZip').length) {
                                        $('#ShippingZip').attr("type", "text");
                                    }
                                }

                                self.setAddress($('#' + addressType + 'Street'), address);
                            });

                            google.maps.event.addDomListener(input, 'keydown', function (e) {
                                if (e.keyCode == 13) {
                                    e.preventDefault();
                                }
                            });
                        };
                        linkAddress('Billing');
                        linkAddress('Shipping');
                    };
                    try {
                        
                        google.maps.event.addDomListener(window, 'load', initialize);
                        
                    } catch (error) {
                        console.error('Google Maps not loaded: ' + error);
                    }

                }
            };

            self.defaultValues = function () {
                var valueType = ["Billing", "Shipping"];

                valueType.forEach(function (type) {

                    var firstName = typeof $('#' + type + 'FirstName').val() == "undefined"  ? "" : $('#' + type + 'FirstName').val();
                    var lastName = typeof $('#' + type + 'LastName').val() == "undefined"? "" : $('#' + type + 'LastName').val();

                    if (firstName.length > 0 && lastName.length > 0) {
                        var fullName = firstName + ' ' + lastName;
                        
                        $('#' + type + 'FullName').val(fullName).trigger('change');
                        
                    }

                    if (!self.currentCountry && self.countries.length > 1 && self.defaultCountry) {
                        $('#' + type + 'Country').val(self.defaultCountry);
                    }

                });

            };

            this.initialize = function () {
                if (self.IsInitial) {
                    self.IsInitial = false;

                    self.transform();
                    self.addressAutocomplete();
                    self.defaultValues();
                }
            };

            $(document).ready(function () {
                self.initialize();

                if (config.enableServerMode) {
                  //  $('#BillingStreet, #ShippingStreet').attr('autocomplete', 'new-password');
                }
            });
        };

        var _addressEngine = new AddressEngine({
            mergeName: "true" == "true",
            mergeAddress: "true" == "true",
            isMobile: "false" == "true",
            language: "English",
            payment: {
                allowedCards: "Visa,Mastercard,Amex,Discover",
                alwaysShowCardTypes: "false" == "true"
            },
            enableTransformLabels: "true" == "true",
            movePayment: "false" == "true",
            enableServerMode: "false" == "true"
        });
        if (typeof (registerEvent) === "function") {
            registerEvent('ECDrawFormComplete', function () {
                _addressEngine.drawPayment('.ccImage');
                if ($('#cc').length > 0 && !$('#cc').is(':visible')) {
                    $('#cc').remove();
                }
            });
        }
    }

function debounce(func, wait, immediate) {
    var timeout;
    return function () {
        var context = this, args = arguments;
        var later = function () {
            timeout = null;
            if (!immediate) func.apply(context, args);
        };
        var callNow = immediate && !timeout;
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
        if (callNow) func.apply(context, args);
    };
}

function createCookie(name, value, minutes) {
    if (minutes) {
        var date = new Date();
        date.setTime(date.getTime() + (minutes * 60 * 1000));
        var expires = "; expires=" + date.toGMTString();
    } else {
        var expires = "";
    }
    document.cookie = name + "=" + value + expires + "; path=/";
}

function getCookie(name) {
    var value = "; " + document.cookie;
    var parts = value.split("; " + name + "=");
    if (parts.length == 2) return parts.pop().split(";").shift();
}

function createSessionCookie(sessionId) {
    var sessionTokenExists = document.cookie.indexOf("gpac=");
    if (sessionTokenExists <= -1) {
        var date = new Date();
        var timeStamp = date.getTime();
        timeStamp = timeStamp.toString();
        createCookie("gpac", sessionId + "-" + timeStamp, 4);
    }
}

function hasValidCharacters(text) {
    /* Regex for letters, numbers, spaces, underscores, hyphen, period*/
    var pattern = new RegExp('^(?:[A-Za-z0-9 _.-]+)(?:[A-Za-z0-9 _.-]*)$');
    var isRegexMatch = pattern.test(text);
   
    return isRegexMatch;
       
}


</script>

<div id="rscContentBottom"></div>

<!-- Begin Impression -->
<script src="https://www.googletagmanager.com/gtag/js?id=AW-783317133"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'AW-783317133'
        
    );
</script>
<!-- End Impression -->

        <!-- CODE: AW-783317133 -->
    

<!-- Begin Impression -->
<script src="https://www.googletagmanager.com/gtag/js?id=AW-11199771989"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'AW-11199771989'
        
    );
</script>
<!-- End Impression -->

        <!-- CODE: AW-11199771989 -->
    

<!-- Begin AdRoll Pixel -->
<script type="text/javascript">
    adroll_adv_id = 'Q66EY4L33RBG7ELCTFUKH2';
    adroll_pix_id = 'S63VWK3C5VATRP4PX7VZLU';
    (function () {
        document.onreadystatechange = function () {
            if (document.readyState === 'complete') {
                var script = document.createElement("script");
                script.async = true;
                script.src = "https://s.adroll.com/j/roundtrip.js";

                document.head.appendChild(script);
            }
        };
    })();
</script>
<!-- End AdRoll Pixel -->


<!-- Begin Impression -->
<script>
    !function (f, b, e, v, n, t, s) {
        if (f.fbq) return; n = f.fbq = function () {
            n.callMethod ?
                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
        };
        if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
        n.queue = []; t = b.createElement(e); t.async = !0;
        t.src = v; s = b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '659071311261578');
    fbq('trackSingle', '659071311261578', 'ViewContent');

    
    addEventListener("SessionLoaded", function () {
        $.ajax({
            url: '/shared/services/visitorsession.ashx?covid=b6a095f0-0809-ed11-8b97-a0369f1303c7',
            data: '',
            type: 'POST'
        }).always(function (data) {
            fbq('trackSingle', '659071311261578', 'PageView', {}, { eventID: data + '41b68c61-aba3-4b2d-bf32-dd4c4ea3a293' });
        });

        window.dtmFacebookManager.SaveFacebookBrowswerId();
    });
    

    (function (w, d) {
        var FacebookManager = function () {
            const fbCookieName = '_fbp',
                dataUrl = '//' + window.location.host + '/shared/services/VisitorData.ashx';

            var setVisitorSessionData = function (id) {
                let url = dataUrl;
                url += '?covid=';
                url += 'b6a095f0-0809-ed11-8b97-a0369f1303c7';
                url += '&key=';
                url += 'FacebookBrowserId';
                url += '&value=';
                url += id;
                
                $.ajax({
                    url: url,
                    data: '',
                    type: 'POST'
                });
            };

            var getCookie = function () {
                    var v = document.cookie.match('(^|;) ?' + fbCookieName + '=([^;]*)(;|$)');
                    return v ? v[2] : null;
            };

            this.SaveFacebookBrowswerId = function () {
                var fbId = getCookie();
                if (fbId)
                {
                    setVisitorSessionData(fbId);
                }   
            };
        };

        w.dtmFacebookManager = new FacebookManager();
    })(window, document);
    
</script>
<noscript>
    <img height="1" width="1" style="display: none"
       alt="" src="https://www.facebook.com/tr?id=659071311261578&ev=PageView&noscript=1" />
</noscript>
<!-- End Impression -->

<script>
    var __hasFiredAddPaymentInfo = false;
    var __hasFiredAddToCart = false;
	var __checkoutInitialized = false;

    var handleFBAddToCart = function () {
        __hasFiredAddToCart = true;
        fbq('trackSingle', '659071311261578', 'AddToCart');
    }

    var handleFBInitiateCheckout = function () {
        __checkoutInitialized = true;
        fbq('trackSingle', '659071311261578', 'InitiateCheckout');
    }

    var handleFBAddPaymentInfo = function () {
        var isValid = true;
        $('#CardNumber, #CardExpirationMonth, #CardExpirationYear, #CardCvv2')
            .each(function () {
                if ($(this).val() == '') {
                    isValid = false;
                }
            });
        if (isValid && !__hasFiredAddPaymentInfo) {
            __hasFiredAddPaymentInfo = true;
            fbq('trackSingle', '659071311261578', 'AddPaymentInfo');
        }
    }
    
    if (window.Receiver) {
        var fbReceiver = window.Receiver("Facebook");
        fbReceiver.onPaymentInfoChange = handleFBAddPaymentInfo;
        fbReceiver.onZipChange = function() {
            if ($('#BillingZip').val() != '' && !__hasFiredAddToCart) {
                handleFBAddToCart();
            }
            handleFBInitiateCheckout();
        };
    }
    //ShoppingCart
    else {
        $('#CardNumber, #CardExpirationMonth, #CardExpirationYear, #CardCvv2').one('keyup input change', handleFBAddPaymentInfo);

        

                //$(document).one('click', '[data-code]', function () {
                //    if (!__hasFiredAddToCart) {
                //        handleFBAddToCart();
                //    }
                //});

        (function () {

            let _itemsAdded = [];
            let _itemsAddedQty = {};




            function fbAddToCart(cart) {

                if (!cart || !cart.items) {
                    return;
                }

                var itemsClone = [];

                for (var i = 0; i < cart.items.length; i++) {
                    var item = cart.items[i];
                    var itemClone = {
                        id: item.id,
                        qty: item.qty,
                        name: item.name,
                        price: item.price
                    };

                    itemsClone.push(itemClone);

                }

                let itemsToAdd = [];
                for (var i = 0; i < itemsClone.length; i++) {
                    var item = itemsClone[i];

                    if (_itemsAdded.indexOf(item.id) < 0) {
                        itemsToAdd.push(item);
                        _itemsAdded.push(item.id);
                        _itemsAddedQty[item.id] = item.qty;
                    } else if (_itemsAddedQty[item.id] != item.qty) {
                        let origQty = item.qty;
                        item.qty = item.qty - _itemsAddedQty[item.id];
                        _itemsAddedQty[item.id] = origQty;
                        itemsToAdd.push(item);
                    }
                }


                for (var i = 0; i < itemsToAdd.length; i++) {
                    var item = itemsToAdd[i];
                    fbq('trackSingle', '659071311261578', 'AddToCart', {
                        content_ids: [item.id],
                        contents: [{id: item.id, quantity: item.qty}],
                        content_name: item.name,
                        content_type: 'product',
                        currency: 'USD',
                        value: (item.price * item.qty).toFixed(2)

                    });
                }
            }

            
            addEventListener("CartChange", function (data) {
                if (data) {
                    fbAddToCart(data.detail);
                }
            });
            


        })();

            

 }
</script>


<!-- Begin Impression -->
<script src="https://www.googletagmanager.com/gtag/js?id=AW-11199774815"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'AW-11199774815'
        
    );
</script>
<!-- End Impression -->

        <!-- CODE: AW-11199774815 -->
    

<!-- Begin Impression -->
<script src="https://www.googletagmanager.com/gtag/js?id=AW-11199771989"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'AW-11199771989'
        
    );
</script>
<!-- End Impression -->

        <!-- CODE: AW-11199771989 -->
    

<!-- Begin Impression -->
<script src="https://www.googletagmanager.com/gtag/js?id=AW-11199771989"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'AW-11199771989'
        
    );
</script>
<!-- End Impression -->

        <!-- CODE: AW-11199771989 -->
    

<!-- Begin Impression -->
<script>
    !function (f, b, e, v, n, t, s) {
        if (f.fbq) return; n = f.fbq = function () {
            n.callMethod ?
                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
        };
        if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
        n.queue = []; t = b.createElement(e); t.async = !0;
        t.src = v; s = b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1111551113100302');
    fbq('trackSingle', '1111551113100302', 'ViewContent');

    
    addEventListener("SessionLoaded", function () {
        $.ajax({
            url: '/shared/services/visitorsession.ashx?covid=b6a095f0-0809-ed11-8b97-a0369f1303c7',
            data: '',
            type: 'POST'
        }).always(function (data) {
            fbq('trackSingle', '1111551113100302', 'PageView', {}, { eventID: data + '41b68c61-aba3-4b2d-bf32-dd4c4ea3a293' });
        });

        window.dtmFacebookManager.SaveFacebookBrowswerId();
    });
    

    (function (w, d) {
        var FacebookManager = function () {
            const fbCookieName = '_fbp',
                dataUrl = '//' + window.location.host + '/shared/services/VisitorData.ashx';

            var setVisitorSessionData = function (id) {
                let url = dataUrl;
                url += '?covid=';
                url += 'b6a095f0-0809-ed11-8b97-a0369f1303c7';
                url += '&key=';
                url += 'FacebookBrowserId';
                url += '&value=';
                url += id;
                
                $.ajax({
                    url: url,
                    data: '',
                    type: 'POST'
                });
            };

            var getCookie = function () {
                    var v = document.cookie.match('(^|;) ?' + fbCookieName + '=([^;]*)(;|$)');
                    return v ? v[2] : null;
            };

            this.SaveFacebookBrowswerId = function () {
                var fbId = getCookie();
                if (fbId)
                {
                    setVisitorSessionData(fbId);
                }   
            };
        };

        w.dtmFacebookManager = new FacebookManager();
    })(window, document);
    
</script>
<noscript>
    <img height="1" width="1" style="display: none"
       alt="" src="https://www.facebook.com/tr?id=1111551113100302&ev=PageView&noscript=1" />
</noscript>
<!-- End Impression -->

<script>
    var __hasFiredAddPaymentInfo = false;
    var __hasFiredAddToCart = false;
	var __checkoutInitialized = false;

    var handleFBAddToCart = function () {
        __hasFiredAddToCart = true;
        fbq('trackSingle', '1111551113100302', 'AddToCart');
    }

    var handleFBInitiateCheckout = function () {
        __checkoutInitialized = true;
        fbq('trackSingle', '1111551113100302', 'InitiateCheckout');
    }

    var handleFBAddPaymentInfo = function () {
        var isValid = true;
        $('#CardNumber, #CardExpirationMonth, #CardExpirationYear, #CardCvv2')
            .each(function () {
                if ($(this).val() == '') {
                    isValid = false;
                }
            });
        if (isValid && !__hasFiredAddPaymentInfo) {
            __hasFiredAddPaymentInfo = true;
            fbq('trackSingle', '1111551113100302', 'AddPaymentInfo');
        }
    }
    
    if (window.Receiver) {
        var fbReceiver = window.Receiver("Facebook");
        fbReceiver.onPaymentInfoChange = handleFBAddPaymentInfo;
        fbReceiver.onZipChange = function() {
            if ($('#BillingZip').val() != '' && !__hasFiredAddToCart) {
                handleFBAddToCart();
            }
            handleFBInitiateCheckout();
        };
    }
    //ShoppingCart
    else {
        $('#CardNumber, #CardExpirationMonth, #CardExpirationYear, #CardCvv2').one('keyup input change', handleFBAddPaymentInfo);

        

                //$(document).one('click', '[data-code]', function () {
                //    if (!__hasFiredAddToCart) {
                //        handleFBAddToCart();
                //    }
                //});

        (function () {

            let _itemsAdded = [];
            let _itemsAddedQty = {};




            function fbAddToCart(cart) {

                if (!cart || !cart.items) {
                    return;
                }

                var itemsClone = [];

                for (var i = 0; i < cart.items.length; i++) {
                    var item = cart.items[i];
                    var itemClone = {
                        id: item.id,
                        qty: item.qty,
                        name: item.name,
                        price: item.price
                    };

                    itemsClone.push(itemClone);

                }

                let itemsToAdd = [];
                for (var i = 0; i < itemsClone.length; i++) {
                    var item = itemsClone[i];

                    if (_itemsAdded.indexOf(item.id) < 0) {
                        itemsToAdd.push(item);
                        _itemsAdded.push(item.id);
                        _itemsAddedQty[item.id] = item.qty;
                    } else if (_itemsAddedQty[item.id] != item.qty) {
                        let origQty = item.qty;
                        item.qty = item.qty - _itemsAddedQty[item.id];
                        _itemsAddedQty[item.id] = origQty;
                        itemsToAdd.push(item);
                    }
                }


                for (var i = 0; i < itemsToAdd.length; i++) {
                    var item = itemsToAdd[i];
                    fbq('trackSingle', '1111551113100302', 'AddToCart', {
                        content_ids: [item.id],
                        contents: [{id: item.id, quantity: item.qty}],
                        content_name: item.name,
                        content_type: 'product',
                        currency: 'USD',
                        value: (item.price * item.qty).toFixed(2)

                    });
                }
            }

            
            addEventListener("CartChange", function (data) {
                if (data) {
                    fbAddToCart(data.detail);
                }
            });
            


        })();

            

 }
</script>


<!-- Begin Impression -->
<script src="https://www.googletagmanager.com/gtag/js?id=AW-11199771989"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'AW-11199771989'
        
    );
</script>
<!-- End Impression -->

        <!-- CODE: AW-11199771989 -->
    

<!-- Begin Impression -->
<script src="https://www.googletagmanager.com/gtag/js?id=AW-11200763840"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'AW-11200763840'
        
    );
</script>
<!-- End Impression -->

        <!-- CODE: AW-11200763840 -->
    

<!-- Begin Impression -->
<script src="https://www.googletagmanager.com/gtag/js?id=AW-11200763840"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'AW-11200763840'
        
    );
</script>
<!-- End Impression -->

        <!-- CODE: AW-11200763840 -->
    
<div id="rscPageBottom"></div>

<!-- Code: c8e6b77d-a63e-ed11-8b97-a0369f1303c7 -->
<script>
    
    $(document).ready(function () {
        
		var __fromSubmitters = [];
		$('form')
			.each(function (i, item){
				$(item).find('input[type="submit"], input[type="image"], button[type="submit"]')
				.bind('click', function (e){
					__fromSubmitters[$(item)] = $(this);
				});
			});
		$('form')
		.bind('submit', function (e){
			var self = $(this);
			if(typeof(self.attr('data-submitting-state')) == 'undefined'){
                e.preventDefault();
                if (typeof (self.attr('data-processing-message')) == 'undefined') {
                    $.facebox('<div role="alert">' + (typeof (__processingMessage) == "undefined" ? "Processing Order . . ." : __processingMessage) + '</div>');
                } else {
                    var processingMessage = self.attr('data-processing-message');
                    $.facebox('<div role="alert">' + processingMessage + '</div>');
                }
				self.attr('data-submitting-state', 'complete');
				setTimeout(function (){
                    _ValidationRunning = false;
                    var submitter = __fromSubmitters[self];
                    if (submitter != null) {
                        submitter.trigger('click');
                    } else {
                        self.submit();
                    }
				}, 250);
				return false;
			} else {
			return true;
			}
		});
        
    });
    
</script>


<script async type="text/javascript" src="https://static.klaviyo.com/onsite/js/klaviyo.js?company_id=XaPgHF"></script>


<script>
    var _learnq = _learnq || [];

    document.addEventListener("DOMContentLoaded", function () {
        let email = document.getElementById("Email");
        if (!email) {
            email = document.getElementsByName("Email")[0];
        }

        if (document.cookie.indexOf("__kla_id") >= 0) {
            klaviyo.Identify(null);
        } else if (email && email.value !== '') {
            klaviyo.Identify(email.value);
            if (klaviyo.HasExistingItems) {
                klaviyo.AddExistingItems();
            }
        }

        if (email) {
            email.addEventListener("change", function () {
                klaviyo.Identify(this.value);
                if (klaviyo.HasExistingItems) {
                    klaviyo.AddExistingItems();
                }
            });
        }
    });

    addEventListener("CartChange", function (event) {

        let data = event.detail,
            cart = {
                total: data.total,
                itemNames: [],
                items: []
            };

        for (let i = 0; i < data.items.length; i++) {
            let item = data.items[i],
                cartItem = {
                    sku: item.sku,
                    price: item.price,
                    name: item.desc,
                    qty: item.qty,
                    code: item.code
                };

            cart.items.push(cartItem);
            cart.itemNames.push(cartItem.name);
        }


        klaviyo.AddToCart(cart);
    });


    document.addEventListener("DOMContentLoaded", function () {
        if (klaviyo.FireCheckout) {
            klaviyo.StartedCheckout();
        }

        setTimeout(klaviyo.ViewProduct.bind(klaviyo), 15000);

    });

    const Klaviyo = function () {
        var items = [], identified = false, self = this;
        this.Identify = function (email) {
            if (email) {
                _learnq.push(['identify', {
                    '$email': email
                }]);
            }

            identified = true;
        };

        var isIdentified = function () {
            if (identified || document.cookie.indexOf("__kla_id") >= 0) {
                return true;
            }
            return false;
        };

        this.ImageUrls = {};
        this.ProductUrls = {};
        this.Ids = {};
        this.ProductInfo = {};

		
        this.ImageUrls["SLIDER"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/flawless--color-home.png";


        this.ImageUrls["SLIDER"] = "https://idvftfbs.dtmstage.com/images/products/flawless-brows-blue.png";


        this.ImageUrls["FLAWBLUSH"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/flawless--color--home.png";


        this.ImageUrls["REP2PK"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/replacement-heads.png?appV=6.0.1722.1545";

        this.ImageUrls["FTFLEGHEAD"] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--legs.png?appV=6.0.1722.1545";

        this.ImageUrls["REP4PK"] = "https://idvftfbs.dtmstage.com/images/products/replacements.png?appV=6.0.1722.1545";

        this.ImageUrls["FTFNURZRHB24"] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--nurazor.png?appV=6.0.1722.1545";

        this.ImageUrls["FTFLAWLEG"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/flawless-legs-home.png";


        this.ImageUrls["SNAILKI"] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--salon-nails.png";


        this.ImageUrls["FTFLAWBROW"] = "https://idvftfbs.dtmstage.com/images/products/flawless-brows-blue.png";


        this.ImageUrls["FLBODYR"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/flawless-body.png";


        this.ImageUrls["RGCASE"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/flawless-body.png";


        this.ImageUrls["FTDERMA"] = "https://idvftfbs.dtmstage.com/images/products/dermaplane-glo.png";


        this.ImageUrls["FTDERMG"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/dermaplane-glo-heads.png";


        this.ImageUrls["FTFCONTOUR"] = "https://idvftfbs.dtmstage.com/images/products/contour.jpg";


        this.ImageUrls["FTFLAWLEGT"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/flawless-legs-home.png";


        this.ImageUrls["NURAZ1"] = "https://idvftfbs.dtmstage.com/images/products/NuRazor.png";


        this.ImageUrls["FTFBFR2"] = "https://idvftfbs.dtmstage.com/images/products/fridge-closed.jpg";


        this.ImageUrls["PEDIREPKI"] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--pedi.png";


        this.ImageUrls["FTFBFR-FSH"] = "https://idvftfbs.dtmstage.com/images/products/fridge-closed.jpg";


        this.ImageUrls["FTFLADPA"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/adaptor-home.png";


        this.ImageUrls["FLAWLCLEANS"] = "https://idvftfbs.dtmstage.com/images/products/flawless-cleanse.jpg";


        this.ImageUrls["ICEROLLER"] = "https://idvftfbs.dtmstage.com/images/products/flawless-ice.jpg";


        this.ImageUrls["FLACLEANSPA"] = "https://idvftfbs.dtmstage.com/images/products/cleanse-spa-2.jpg";


        this.ImageUrls[""] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--cleanse-spa.png?appV=6.0.1722.1545";

        this.ImageUrls["FLAW30PABLUE"] = "https://idvftfbs.dtmstage.com/images/products/flawless-blue.png";


        this.ImageUrls["FLANAILS"] = "https://idvftfbs.dtmstage.com/images/products/flawless-nails.png";


        this.ImageUrls["FLBR30BL"] = "https://idvftfbs.dtmstage.com/images/products/flawless-brows-blue.png";


        this.ImageUrls[""] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--salon-nails.png?appV=6.0.1722.1545";

        this.ImageUrls["PEDIFL"] = "https://idvftfbs.dtmstage.com/images/products/flawless-pedi.png";


        this.ImageUrls["SILKMASFL"] = "https://idvftfbs.dtmstage.com/images/products/flawless-silk-mask-2.png";


        this.ImageUrls["REPH2PK"] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--body.png";


        this.ImageUrls["REPLNAILKI"] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--salon-nails.png";


        this.ImageUrls["FTDERMGRH"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/dermaplane-glo-heads.png?appV=6.0.1722.1545";

        this.ImageUrls["2PFRH"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/replacement-heads-3_0.png?appV=6.0.1722.1545";

        this.ImageUrls["REPCLSPAKI"] = "https://idvftfbs.dtmstage.com/images/products/replacement-heads--cleanse-spa.png";


        this.ImageUrls["STEAM"] = "https://idvftfbs.dtmstage.com/images/products/flawless-steamer.jpg";


        this.ImageUrls["FFSMS"] = "https://idvftfbs.dtmstage.com/images/products/flawless-silk-mask-2.png";


        this.ImageUrls["SILKMASK"] = "https://idvftfbs.dtmstage.com/images/products/flawless-silk-mask-2.png";


        this.ImageUrls["FLAWBIKIU"] = "https://idvftfbs.dtmstage.com/images/products/flawless-bikini-main.jpg";


        this.ImageUrls["FLAWMITTS"] = "https://idvftfbs.dtmstage.com//images/products/mitt.jpg";


        this.ImageUrls["FTFLADPAFS"] = "https://idvftfbs.dtmstage.com/images/products/3.0000/adaptor-home.png";


        this.ImageUrls["DSMKSILK"] = "https://idvftfbs.dtmstage.com//images/silk-mask.png";


        this.ImageUrls["FLAWBAG"] = "https://idvftfbs.dtmstage.com//images/cosmetic-bag.jpg";


        this.ImageUrls["DSMKSILK"] = "https://idvftfbs.dtmstage.com//images/silk-mask.png";


        this.ProductUrls["FTFLAWLEG"] = "https://idvftfbs.dtmstage.com/LEGS.dtm";


        this.ProductUrls["FTDERMG"] = "https://idvftfbs.dtmstage.com/GLO.dtm";


        this.ProductUrls["FTFCONTOUR"] = "https://idvftfbs.dtmstage.com/CONTOUR.dtm";


        this.ProductUrls["NURAZ1"] = "https://idvftfbs.dtmstage.com/NU.dtm";


        this.ProductUrls["FTFBFR2"] = "https://idvftfbs.dtmstage.com/NFRIG.dtm";


        this.ProductUrls["FTFBFR-FSH"] = "https://idvftfbs.dtmstage.com/NFRIG.dtm";


        this.ProductUrls["FLAWLCLEANS"] = "https://idvftfbs.dtmstage.com/CLEANSE.dtm";


        this.ProductUrls["ICEROLLER"] = "https://idvftfbs.dtmstage.com/ICE.dtm";


        this.ProductUrls["FLACLEANSPA"] = "https://idvftfbs.dtmstage.com/SPA.dtm";


        this.ProductUrls["FLAW30PABLUE"] = "https://idvftfbs.dtmstage.com/PBLUE.dtm";


        this.ProductUrls["FLANAILS"] = "https://idvftfbs.dtmstage.com/NAILS.dtm";


        this.ProductUrls["FLBR30BL"] = "https://idvftfbs.dtmstage.com/BROWPB.dtm";


        this.ProductUrls["PEDIFL"] = "https://idvftfbs.dtmstage.com/PEDI.dtm";


        this.ProductUrls["SILKMASFL"] = "https://idvftfbs.dtmstage.com/MASK.dtm";


        this.ProductUrls["STEAM"] = "https://idvftfbs.dtmstage.com/STEAM.dtm";


        this.ProductUrls["FFSMS"] = "https://idvftfbs.dtmstage.com/MASK4.dtm";


        this.ProductUrls["SILKMASK"] = "https://idvftfbs.dtmstage.com/MASK.dtm";


        this.ProductUrls["FLAWBIKIU"] = "https://idvftfbs.dtmstage.com/BIKINI.dtm";


        this.ProductInfo["MAINPRODUCT"] = {
            "ProductName": "Name",
            "ProductSku": "",
            "ProductPrice": 1.99
        };

        this.ProductInfo["GST"] = {
            "ProductName": "Non Continental U.S. Shipping Surcharge",
            "ProductSku": "SURCHARGE",
            "ProductPrice": .00
        };

        this.ProductInfo["WHITE"] = {
            "ProductName": "Finishing Touch® Flawless® - White",
            "ProductSku": "FLAWWHITE",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BLUSH"] = {
            "ProductName": "Finishing Touch® Flawless® - Blush",
            "ProductSku": "FLAWBLUSH",
            "ProductPrice": 19.99
        };

        this.ProductInfo["LAVEN"] = {
            "ProductName": "Finishing Touch® Flawless® - Lavender",
            "ProductSku": "FLAWLAVEN",
            "ProductPrice": 19.99
        };

        this.ProductInfo["R2"] = {
            "ProductName": "Facial Hair Remover Replacement Heads - 2 Pack",
            "ProductSku": "REP2PK",
            "ProductPrice": 12.99
        };

        this.ProductInfo["LEGREP"] = {
            "ProductName": "Legs Replacement Head",
            "ProductSku": "FTFLEGHEAD",
            "ProductPrice": 24.99
        };

        this.ProductInfo["R4"] = {
            "ProductName": "Facial Hair Remover Replacement Heads - 4 Pack",
            "ProductSku": "REP4PK",
            "ProductPrice": 19.99
        };

        this.ProductInfo["NUREP"] = {
            "ProductName": "Nu Razor™ Hair Remover Replacement Heads",
            "ProductSku": "FTFNURZRHB24",
            "ProductPrice": 14.99
        };

        this.ProductInfo["LEG"] = {
            "ProductName": "Legs",
            "ProductSku": "FTFLAWLEG",
            "ProductPrice": 59.98
        };

        this.ProductInfo["SNREP2"] = {
            "ProductName": "Salon Nails Replacement Heads",
            "ProductSku": "SNAILKI",
            "ProductPrice": 9.99
        };

        this.ProductInfo["BROW"] = {
            "ProductName": "Brows",
            "ProductSku": "FTFLAWBROW",
            "ProductPrice": 19.99
        };

        this.ProductInfo["ADDSHIP"] = {
            "ProductName": "Non-Continental U.S. Shipping Surcharge",
            "ProductSku": "SURCHARGE",
            "ProductPrice": .00
        };

        this.ProductInfo["WHITERECH"] = {
            "ProductName": "Rechargeable Finishing Touch® Flawless® - White",
            "ProductSku": "FTFACIAL",
            "ProductPrice": 29.98
        };

        this.ProductInfo["BOD"] = {
            "ProductName": "Finishing Touch® Flawless® Body™",
            "ProductSku": "FLBODYR",
            "ProductPrice": 29.99
        };

        this.ProductInfo["BODBON"] = {
            "ProductName": "BONUS Finishing Touch® Flawless® Body™ Carrying Case",
            "ProductSku": "RGCASE",
            "ProductPrice": .00
        };

        this.ProductInfo["DERMA"] = {
            "ProductName": "Dermaplane",
            "ProductSku": "FTDERMA",
            "ProductPrice": 9.99
        };

        this.ProductInfo["GLO"] = {
            "ProductName": "Flawless Dermaplane GLO™ Lighted Facial Exfoliator",
            "ProductSku": "FTDERMG",
            "ProductPrice": 19.99
        };

        this.ProductInfo["CONTOUR"] = {
            "ProductName": "Flawless Contour™ Facial Roller",
            "ProductSku": "FTFCONTOUR",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BLACK"] = {
            "ProductName": "Finishing Touch® Flawless® - Black",
            "ProductSku": "FLAWBLK",
            "ProductPrice": 19.99
        };

        this.ProductInfo["LEGT"] = {
            "ProductName": "Legs",
            "ProductSku": "FTFLAWLEGT",
            "ProductPrice": 39.99
        };

        this.ProductInfo["BLACK2"] = {
            "ProductName": "Finishing Touch® Flawless® - Black",
            "ProductSku": "FTFLAWBLK",
            "ProductPrice": 19.99
        };

        this.ProductInfo["NU"] = {
            "ProductName": "Nu Razor™ Hair Remover",
            "ProductSku": "NURAZ1",
            "ProductPrice": 39.99
        };

        this.ProductInfo["NFRIG"] = {
            "ProductName": "Beauty Fridge",
            "ProductSku": "FTFBFR2",
            "ProductPrice": 59.99
        };

        this.ProductInfo["PREP"] = {
            "ProductName": "Pedi Replacement Heads",
            "ProductSku": "PEDIREPKI",
            "ProductPrice": 9.99
        };

        this.ProductInfo["NFRIGFS"] = {
            "ProductName": "Beauty Fridge ",
            "ProductSku": "FTFBFR-FSH",
            "ProductPrice": 59.99
        };

        this.ProductInfo["ADAPT"] = {
            "ProductName": "Adaptor",
            "ProductSku": "FTFLADPA",
            "ProductPrice": 4.99
        };

        this.ProductInfo["CORAL2"] = {
            "ProductName": "Finishing Touch® Flawless® - Coral",
            "ProductSku": "FLAWCORAL",
            "ProductPrice": 19.99
        };

        this.ProductInfo["RF30"] = {
            "ProductName": "Facial Hair Remover Replacement Heads 3.0 - 2 Pack",
            "ProductSku": "REP302PK",
            "ProductPrice": 12.99
        };

        this.ProductInfo["CLEANSE"] = {
            "ProductName": "Cleanse",
            "ProductSku": "FLAWLCLEANS",
            "ProductPrice": 39.99
        };

        this.ProductInfo["ICE"] = {
            "ProductName": "Ice Roller",
            "ProductSku": "ICEROLLER",
            "ProductPrice": 9.99
        };

        this.ProductInfo["SPA"] = {
            "ProductName": "Cleanse Spa",
            "ProductSku": "FLACLEANSPA",
            "ProductPrice": 29.99
        };

        this.ProductInfo["SPAREP"] = {
            "ProductName": "Cleanse Spa Replacement Heads",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["PBLUE"] = {
            "ProductName": "Facial Hair Remover - Parisian Blue",
            "ProductSku": "FLAW30PABLUE",
            "ProductPrice": 19.99
        };

        this.ProductInfo["NAILS"] = {
            "ProductName": "Salon Nails",
            "ProductSku": "FLANAILS",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BROWPB"] = {
            "ProductName": "Brows - Parisian Blue ",
            "ProductSku": "FLBR30BL",
            "ProductPrice": 19.99
        };

        this.ProductInfo["NAILSREP"] = {
            "ProductName": "Salon Nails Replacement Heads",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["PEDI"] = {
            "ProductName": "Pedi ",
            "ProductSku": "PEDIFL",
            "ProductPrice": 19.99
        };

        this.ProductInfo["MASK"] = {
            "ProductName": "Silk Mask",
            "ProductSku": "SILKMASFL",
            "ProductPrice": 9.99
        };

        this.ProductInfo["BODREP"] = {
            "ProductName": "Body Replacement Heads & 1 SensaGuard Cover",
            "ProductSku": "REPH2PK",
            "ProductPrice": 14.99
        };

        this.ProductInfo["SNREP"] = {
            "ProductName": "Salon Nails Replacement Heads",
            "ProductSku": "REPLNAILKI",
            "ProductPrice": 7.99
        };

        this.ProductInfo["GLOREP"] = {
            "ProductName": "Set of 6 Flawless Dermaplane GLO™ Lighted Facial Exfoliator Replacement Heads",
            "ProductSku": "FTDERMGRH",
            "ProductPrice": 9.99
        };

        this.ProductInfo["R219"] = {
            "ProductName": "Facial Hair Remover Replacement Heads - 2 Pack",
            "ProductSku": "2PFRH",
            "ProductPrice": 12.99
        };

        this.ProductInfo["CSREP"] = {
            "ProductName": "Cleanse Spa Replacement Heads",
            "ProductSku": "REPCLSPAKI",
            "ProductPrice": 9.99
        };

        this.ProductInfo["STEAM"] = {
            "ProductName": "STEAM",
            "ProductSku": "STEAM",
            "ProductPrice": .00
        };

        this.ProductInfo["MASK4"] = {
            "ProductName": "Silk Mask - Set of 4",
            "ProductSku": "FFSMS",
            "ProductPrice": 29.99
        };

        this.ProductInfo["MASK1299"] = {
            "ProductName": "Silk Mask",
            "ProductSku": "SILKMASK",
            "ProductPrice": 12.99
        };

        this.ProductInfo["BIKINI"] = {
            "ProductName": "Bikini",
            "ProductSku": "FLAWBIKIU",
            "ProductPrice": 19.99
        };

        this.ProductInfo["FACEBLUSH"] = {
            "ProductName": "Facial Hair Remover - Blush",
            "ProductSku": "FLAW30BLUSH",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BROWBLUSH"] = {
            "ProductName": "Brows- Blush",
            "ProductSku": "FLBR30USH",
            "ProductPrice": 19.99
        };

        this.ProductInfo["STEAMER"] = {
            "ProductName": "Facial Steamer",
            "ProductSku": "FLAWSTEAM",
            "ProductPrice": 49.88
        };

        this.ProductInfo["FACELAV"] = {
            "ProductName": "Facial Hair Remover - Lavender",
            "ProductSku": "FLAW30LAVEN",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BUNFACE"] = {
            "ProductName": "FABULOUS FACE BUNDLE - Facial Hair Remover - Parisian Blue",
            "ProductSku": "BUNFACE",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNBROW"] = {
            "ProductName": "FABULOUS FACE BUNDLE - Brows - Parisian Blue",
            "ProductSku": "BUNBROW",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNNAIL"] = {
            "ProductName": "POLISH + PURIFY BUNDLE -  Salon Nails",
            "ProductSku": "BUNNAIL",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNPEDI"] = {
            "ProductName": "POLISH + PURIFY BUNDLE - Pedi",
            "ProductSku": "BUNPEDI",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNFACE2"] = {
            "ProductName": "HAIR BE GONE BUNDLE - Facial Hair Remover - Parisian Blue",
            "ProductSku": "BUNFACE",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNBIK"] = {
            "ProductName": "HAIR BE GONE BUNDLE - Bikini",
            "ProductSku": "BUNBIK",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNCLSE"] = {
            "ProductName": "TEXTURE + TONE BUNDLE - Cleanse",
            "ProductSku": "BUNCLSE",
            "ProductPrice": 35.00
        };

        this.ProductInfo["BUNDERM"] = {
            "ProductName": "TEXTURE + TONE BUNDLE - Flawless Dermaplane GLO™ Lighted Facial Exfoliator & 6 Replacement Heads",
            "ProductSku": "BUNDERM",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNSTEAM"] = {
            "ProductName": "TEXTURE + TONE BUNDLE - Facial Steamer",
            "ProductSku": "BUNSTEAM",
            "ProductPrice": 43.50
        };

        this.ProductInfo["BUNFACE3"] = {
            "ProductName": "FOREVER SUMMER BUNDLE - Facial Hair Remover - Parisian Blue",
            "ProductSku": "BUNFACE",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNNUR"] = {
            "ProductName": "FOREVER SUMMER BUNDLE - Nu Razor™ Hair Remover",
            "ProductSku": "BUNNUR",
            "ProductPrice": 35.00
        };

        this.ProductInfo["BUNBIK2"] = {
            "ProductName": "FOREVER SUMMER BUNDLE - Bikini",
            "ProductSku": "BUNBIK",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNCLSE2"] = {
            "ProductName": "BEAUTY LOVER BUNDLE - Cleanse",
            "ProductSku": "BUNCLSE",
            "ProductPrice": 35.00
        };

        this.ProductInfo["BUNCONT"] = {
            "ProductName": "BEAUTY LOVER BUNDLE - Flawless Contour™ Facial Roller",
            "ProductSku": "BUNCONT",
            "ProductPrice": 17.00
        };

        this.ProductInfo["BUNICE"] = {
            "ProductName": "BEAUTY LOVER BUNDLE - Ice Roller",
            "ProductSku": "BUNICE",
            "ProductPrice": 9.00
        };

        this.ProductInfo["SLFACECP"] = {
            "ProductName": "SALE! Facial Hair Remover - Crystal Pink",
            "ProductSku": "SLFACE",
            "ProductPrice": 13.99
        };

        this.ProductInfo["SLFACBRWDUO"] = {
            "ProductName": "SALE! Facial Hair Remover + Brows - Mermaid",
            "ProductSku": "SLFACBRWDUO",
            "ProductPrice": 29.99
        };

        this.ProductInfo["SLFLBROW"] = {
            "ProductName": "SALE! Brows - Blush",
            "ProductSku": "SLFLBROW",
            "ProductPrice": 13.99
        };

        this.ProductInfo["SLFLBODYR"] = {
            "ProductName": "SALE! Body Hair Remover",
            "ProductSku": "SLFLBODYR",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BUNFACEBROWBUNDLE"] = {
            "ProductName": "Fabulous Face Bundle (Face + Brows)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNNAILPEDIBUNDLE"] = {
            "ProductName": "Polish + Purify Bundle (Nails + Pedi)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNFACEBIKBUNDLE"] = {
            "ProductName": "Hair Be Gone Bundle (Face + Bikini)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNCLNSDERMBUNDLE"] = {
            "ProductName": "Texture + Tone Bundle (Cleanse/Glo/Steamer)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNFACENUBUNDLE"] = {
            "ProductName": "Forever Summer Bundle (Face/NuRazor/Bikini)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNCLNSCONTBUNDLE"] = {
            "ProductName": "Beauty Lover Bundle (Cleanse/Contour/Ice)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["MITT"] = {
            "ProductName": "Pure Clean Mitts (set of 7) ",
            "ProductSku": "FLAWMITTS",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BUNCLEANMITTBUNDLE"] = {
            "ProductName": "Face Be Clean Bundle (Cleanse + Pure Clean Mitts)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNCLSEM"] = {
            "ProductName": "FACE BE CLEAN BUNDLE - Cleanse",
            "ProductSku": "BUNCLSE",
            "ProductPrice": 35.00
        };

        this.ProductInfo["BUNMITTS"] = {
            "ProductName": "FACE BE CLEAN BUNDLE - Pure Clean Mitts",
            "ProductSku": "BUNPCMITTS",
            "ProductPrice": 17.00
        };

        this.ProductInfo["PLAVEN"] = {
            "ProductName": "Facial Hair Remover - Lavender",
            "ProductSku": "FLAW30LAVEN",
            "ProductPrice": 19.99
        };

        this.ProductInfo["ADAPTF"] = {
            "ProductName": "Adaptor - FREE SHIPPING!",
            "ProductSku": "FTFLADPAFS",
            "ProductPrice": 4.99
        };

        this.ProductInfo["FREEMASK"] = {
            "ProductName": "FREE! Silk Mask",
            "ProductSku": "DSMKSILK",
            "ProductPrice": .00
        };

        this.ProductInfo["CBAG"] = {
            "ProductName": "FREE Cosmetic Bag and FREE Shipping with purchase over $29.99",
            "ProductSku": "FLAWBAG",
            "ProductPrice": .00
        };

        this.ProductInfo["FREESM"] = {
            "ProductName": "FREE GIFT WITH PURCHASE!  Flawless Silk Mask",
            "ProductSku": "DSMKSILK",
            "ProductPrice": .00
        };

        this.ProductInfo["FREEADAPT"] = {
            "ProductName": "FREE GIFT WITH PURCHASE! Adaptor",
            "ProductSku": "FLADAPT",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNPCMITTS"] = {
            "ProductName": "FACE BE CLEAN BUNDLE - Pure Clean Mitts",
            "ProductSku": "BUNPCMITTS",
            "ProductPrice": 17.00
        };

        this.ProductInfo["WHITEN"] = {
            "ProductName": "Finishing Touch® Flawless® - White",
            "ProductSku": "FLAWWHITE",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BLUSHN"] = {
            "ProductName": "Finishing Touch® Flawless® - Blush",
            "ProductSku": "FLAWBLUSH",
            "ProductPrice": 19.99
        };

        this.ProductInfo["SEAN"] = {
            "ProductName": "Finishing Touch® Flawless® - Seaglass",
            "ProductSku": "FLAWSGLASS",
            "ProductPrice": 19.99
        };

        this.ProductInfo["LAVENN"] = {
            "ProductName": "Finishing Touch® Flawless® - Lavender",
            "ProductSku": "FLAWLAVEN",
            "ProductPrice": 19.99
        };

        this.ProductInfo["R2N"] = {
            "ProductName": "Facial Hair Remover Replacement Heads - 2 Pack",
            "ProductSku": "REP2PK",
            "ProductPrice": 12.99
        };

        this.ProductInfo["R4N"] = {
            "ProductName": "Facial Hair Remover Replacement Heads - 4 Pack",
            "ProductSku": "REP4PK",
            "ProductPrice": 19.99
        };

        this.ProductInfo["LEGN"] = {
            "ProductName": "Legs",
            "ProductSku": "FTFLAWLEG",
            "ProductPrice": 59.98
        };

        this.ProductInfo["LEGREPN"] = {
            "ProductName": "Legs Replacement Head",
            "ProductSku": "FTFLEGHEAD",
            "ProductPrice": 24.99
        };

        this.ProductInfo["BROWN"] = {
            "ProductName": "Brows",
            "ProductSku": "FTFLAWBROW",
            "ProductPrice": 19.99
        };

        this.ProductInfo["WHITERECHN"] = {
            "ProductName": "Rechargeable Finishing Touch® Flawless® - White",
            "ProductSku": "FTFACIAL",
            "ProductPrice": 29.98
        };

        this.ProductInfo["BODN"] = {
            "ProductName": "Finishing Touch® Flawless® Body™",
            "ProductSku": "FLBODYR",
            "ProductPrice": 29.99
        };

        this.ProductInfo["BODREPN"] = {
            "ProductName": "Body Replacement Heads & 1 SensaGuard Cover",
            "ProductSku": "REPH2PK",
            "ProductPrice": 14.99
        };

        this.ProductInfo["DERMAN"] = {
            "ProductName": "Dermaplane",
            "ProductSku": "FTDERMA",
            "ProductPrice": 9.99
        };

        this.ProductInfo["BODBONN"] = {
            "ProductName": "BONUS Finishing Touch® Flawless® Body™ Carrying Case",
            "ProductSku": "RGCASE",
            "ProductPrice": .00
        };

        this.ProductInfo["GLON"] = {
            "ProductName": "Flawless Dermaplane GLO™ Lighted Facial Exfoliator",
            "ProductSku": "FTDERMG",
            "ProductPrice": 19.99
        };

        this.ProductInfo["GLOREPN"] = {
            "ProductName": "Set of 6 Flawless Dermaplane GLO™ Lighted Facial Exfoliator Replacement Heads",
            "ProductSku": "FTDERMGRH",
            "ProductPrice": 9.99
        };

        this.ProductInfo["CONTOURN"] = {
            "ProductName": "Contour",
            "ProductSku": "FTFCONTOUR",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BLACK2N"] = {
            "ProductName": "Finishing Touch® Flawless® - Black",
            "ProductSku": "FTFLAWBLK",
            "ProductPrice": 19.99
        };

        this.ProductInfo["NUN"] = {
            "ProductName": "Nu Razor&trade; Hair Remover ",
            "ProductSku": "NURAZ1",
            "ProductPrice": 39.99
        };

        this.ProductInfo["NFRIGN"] = {
            "ProductName": "Beauty Fridge",
            "ProductSku": "FTFBFR2",
            "ProductPrice": 59.99
        };

        this.ProductInfo["NUREPN"] = {
            "ProductName": "Nurazor™ Hair Remover Replacement Heads",
            "ProductSku": "FTFNURZRHB24",
            "ProductPrice": 14.99
        };

        this.ProductInfo["NFRIGFSN"] = {
            "ProductName": "Beauty Fridge",
            "ProductSku": "FTFBFR-FSH",
            "ProductPrice": 59.99
        };

        this.ProductInfo["ADAPTFN"] = {
            "ProductName": "Adaptor - FREE SHIPPING!",
            "ProductSku": "FTFLADPAFS",
            "ProductPrice": 4.99
        };

        this.ProductInfo["ADAPTN"] = {
            "ProductName": "Adaptor",
            "ProductSku": "FTFLADPA",
            "ProductPrice": 4.99
        };

        this.ProductInfo["CORAL2N"] = {
            "ProductName": "Finishing Touch® Flawless® - Coral",
            "ProductSku": "FLAWCORAL",
            "ProductPrice": 19.99
        };

        this.ProductInfo["RF30N"] = {
            "ProductName": "Facial Hair Remover Replacement Heads - 2 Pack",
            "ProductSku": "REP302PK",
            "ProductPrice": 12.99
        };

        this.ProductInfo["CLEANSEN"] = {
            "ProductName": "Cleanse",
            "ProductSku": "FLAWLCLEANS",
            "ProductPrice": 39.99
        };

        this.ProductInfo["ICEN"] = {
            "ProductName": "Ice Roller",
            "ProductSku": "ICEROLLER",
            "ProductPrice": 9.99
        };

        this.ProductInfo["SPAN"] = {
            "ProductName": "Cleanse Spa",
            "ProductSku": "FLACLEANSPA",
            "ProductPrice": 29.99
        };

        this.ProductInfo["PBLUEN"] = {
            "ProductName": "Facial Hair Remover",
            "ProductSku": "FLAW30PABLUE",
            "ProductPrice": 19.99
        };

        this.ProductInfo["NAILSN"] = {
            "ProductName": "Nail",
            "ProductSku": "FLANAILS",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BROWPBN"] = {
            "ProductName": "Brows",
            "ProductSku": "FLBR30BL",
            "ProductPrice": 19.99
        };

        this.ProductInfo["SPAREPN"] = {
            "ProductName": "Cleanse Spa Replacement Heads",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["NAILSREPN"] = {
            "ProductName": "Salon Nails Replacement Heads",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["PEDIN"] = {
            "ProductName": "Pedi",
            "ProductSku": "PEDIFL",
            "ProductPrice": 19.99
        };

        this.ProductInfo["MASKN"] = {
            "ProductName": "Silk Mask",
            "ProductSku": "SILKMASFL",
            "ProductPrice": 9.99
        };

        this.ProductInfo["CSREPN"] = {
            "ProductName": "Cleanse Spa Replacement Heads",
            "ProductSku": "REPCLSPAKI",
            "ProductPrice": 9.99
        };

        this.ProductInfo["SNREPN"] = {
            "ProductName": "Salon Nails Replacement Heads",
            "ProductSku": "REPLNAILKI",
            "ProductPrice": 7.99
        };

        this.ProductInfo["PREPN"] = {
            "ProductName": "Pedi Replacement Heads",
            "ProductSku": "PEDIREPKI",
            "ProductPrice": 9.99
        };

        this.ProductInfo["R219N"] = {
            "ProductName": "Facial Hair Remover Replacement Heads - 2 Pack",
            "ProductSku": "2PFRH",
            "ProductPrice": 12.99
        };

        this.ProductInfo["SNREP2N"] = {
            "ProductName": "Salon Nails Replacement Heads",
            "ProductSku": "SNAILKI",
            "ProductPrice": 9.99
        };

        this.ProductInfo["STEAMN"] = {
            "ProductName": "STEAM",
            "ProductSku": "STEAM",
            "ProductPrice": .00
        };

        this.ProductInfo["MASK4N"] = {
            "ProductName": "Silk Mask - Set of 4",
            "ProductSku": "FFSMS",
            "ProductPrice": 29.99
        };

        this.ProductInfo["MASK1299N"] = {
            "ProductName": "Silk Mask",
            "ProductSku": "SILKMASK",
            "ProductPrice": 12.99
        };

        this.ProductInfo["BIKININ"] = {
            "ProductName": "Bikini",
            "ProductSku": "FLAWBIKIU",
            "ProductPrice": 19.99
        };

        this.ProductInfo["FACEBLUSHN"] = {
            "ProductName": "Facial Hair Remover - Blush",
            "ProductSku": "FLAW30BLUSH",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BROWBLUSHN"] = {
            "ProductName": "Brows- Blush",
            "ProductSku": "FLBR30USH",
            "ProductPrice": 19.99
        };

        this.ProductInfo["STEAMERN"] = {
            "ProductName": "Facial Steamer",
            "ProductSku": "FLAWSTEAM",
            "ProductPrice": 49.88
        };

        this.ProductInfo["FACELAVN"] = {
            "ProductName": "Facial Hair Remover - Lavender",
            "ProductSku": "FLAW30LAVEN",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BUNFACEN"] = {
            "ProductName": "FABULOUS FACE BUNDLE - Facial Hair Remover",
            "ProductSku": "BUNFACE",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNBROWN"] = {
            "ProductName": "FABULOUS FACE BUNDLE - Brows - Parisian Blue",
            "ProductSku": "BUNBROW",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNNAILN"] = {
            "ProductName": "POLISH + PURIFY BUNDLE - Salon Nails",
            "ProductSku": "BUNNAIL",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNPEDIN"] = {
            "ProductName": "POLISH + PURIFY BUNDLE - Pedi",
            "ProductSku": "BUNPEDI",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNFACE2N"] = {
            "ProductName": "HAIR BE GONE BUNDLE - Facial Hair Remover",
            "ProductSku": "BUNFACE",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNBIKN"] = {
            "ProductName": "HAIR BE GONE BUNDLE - Bikini",
            "ProductSku": "BUNBIK",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNCLSEN"] = {
            "ProductName": "TEXTURE + TONE BUNDLE - Cleanse",
            "ProductSku": "BUNCLSE",
            "ProductPrice": 35.00
        };

        this.ProductInfo["BUNDERMN"] = {
            "ProductName": "TEXTURE + TONE BUNDLE - Flawless Dermaplane GLO™ Lighted Facial Exfoliator & 6 Replacement Heads",
            "ProductSku": "BUNDERM",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNSTEAMN"] = {
            "ProductName": "TEXTURE + TONE BUNDLE - Facial Steamer",
            "ProductSku": "BUNSTEAM",
            "ProductPrice": 43.50
        };

        this.ProductInfo["BUNFACE3N"] = {
            "ProductName": "FOREVER SUMMER BUNDLE - Facial Hair Remover",
            "ProductSku": "BUNFACE",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNNURN"] = {
            "ProductName": "FOREVER SUMMER BUNDLE - Nu Razor™ Hair Remover",
            "ProductSku": "BUNNUR",
            "ProductPrice": 35.00
        };

        this.ProductInfo["BUNBIK2N"] = {
            "ProductName": "FOREVER SUMMER BUNDLE - Bikini",
            "ProductSku": "BUNBIK",
            "ProductPrice": 17.50
        };

        this.ProductInfo["BUNCLSE2N"] = {
            "ProductName": "BEAUTY LOVER BUNDLE - Cleanse",
            "ProductSku": "BUNCLSE",
            "ProductPrice": 35.00
        };

        this.ProductInfo["BUNCONTN"] = {
            "ProductName": "BEAUTY LOVER BUNDLE - Flawless Contour™ Facial Roller",
            "ProductSku": "BUNCONT",
            "ProductPrice": 17.00
        };

        this.ProductInfo["BUNICEN"] = {
            "ProductName": "BEAUTY LOVER BUNDLE - Ice Roller",
            "ProductSku": "BUNICE",
            "ProductPrice": 9.00
        };

        this.ProductInfo["SLFACECPN"] = {
            "ProductName": "SALE! Facial Hair Remover - Crystal Pink",
            "ProductSku": "SLFACE",
            "ProductPrice": 13.99
        };

        this.ProductInfo["SLFACBRWDUON"] = {
            "ProductName": "SALE! Facial Hair Remover + Brows - Mermaid",
            "ProductSku": "SLFACBRWDUO",
            "ProductPrice": 29.99
        };

        this.ProductInfo["SLFLBROWN"] = {
            "ProductName": "SALE! Brows - Blush",
            "ProductSku": "SLFLBROW",
            "ProductPrice": 13.99
        };

        this.ProductInfo["SLFLBODYRN"] = {
            "ProductName": "SALE! Body Hair Remover",
            "ProductSku": "SLFLBODYR",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BUNFACEBROWBUNDLEN"] = {
            "ProductName": "Fabulous Face Bundle (Face + Brows)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNNAILPEDIBUNDLEN"] = {
            "ProductName": "Polish + Purify Bundle (Nails + Pedi)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNFACEBIKBUNDLEN"] = {
            "ProductName": "Hair Be Gone Bundle (Face + Bikini)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNCLNSDERMBUNDLEN"] = {
            "ProductName": "TEXTURE + TONE BUNDLE -  (Cleanse/Glo/Steamer)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNFACENUBUNDLEN"] = {
            "ProductName": "Forever Summer Bundle (Face/NuRazor/Bikini)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNCLNSCONTBUNDLEN"] = {
            "ProductName": "Beauty Lover Bundle (Cleanse/Contour/Ice)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["MITTN"] = {
            "ProductName": "Pure Clean",
            "ProductSku": "FLAWMITTS",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BUNCLEANMITTBUNDLEN"] = {
            "ProductName": "Face Be Clean Bundle (Cleanse + Pure Clean Mitts)",
            "ProductSku": "",
            "ProductPrice": .00
        };

        this.ProductInfo["BUNCLSEMN"] = {
            "ProductName": "FACE BE CLEAN BUNDLE - Cleanse",
            "ProductSku": "BUNCLSE",
            "ProductPrice": 35.00
        };

        this.ProductInfo["BUNMITTSN"] = {
            "ProductName": "Face Be Clean Bundle - Mitts",
            "ProductSku": "BUNPCMITTS",
            "ProductPrice": 17.00
        };

        this.ProductInfo["BUNPCMITTSN"] = {
            "ProductName": "FACE BE CLEAN BUNDLE - Pure Clean Mitts (7 Mitts)",
            "ProductSku": "BUNPCMITTS",
            "ProductPrice": 17.00
        };

        this.ProductInfo["PLAVENN"] = {
            "ProductName": "Facial Hair Remover - Lavender",
            "ProductSku": "FLAW30LAVEN",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BLACKN"] = {
            "ProductName": "Finishing Touch® Flawless® - Black",
            "ProductSku": "FLAWBLK",
            "ProductPrice": 19.99
        };

        this.ProductInfo["LEGTN"] = {
            "ProductName": "Legs",
            "ProductSku": "FTFLAWLEGT",
            "ProductPrice": 39.99
        };

        this.ProductInfo["UA"] = {
            "ProductName": "UNDERARM Hair Remover",
            "ProductSku": "UNDERARM",
            "ProductPrice": 29.99
        };

        this.ProductInfo["SHR"] = {
            "ProductName": "STRAY HAIR REMOVER",
            "ProductSku": "STRYHAIR",
            "ProductPrice": 19.99
        };

        this.ProductInfo["UAN"] = {
            "ProductName": "Underarm",
            "ProductSku": "UNDERARM",
            "ProductPrice": 29.99
        };

        this.ProductInfo["SHRN"] = {
            "ProductName": "Stray Hair Remover",
            "ProductSku": "STRYHAIR",
            "ProductPrice": 19.99
        };

        this.ProductInfo["SHFEE"] = {
            "ProductName": "$5.99 S&H Charge",
            "ProductSku": "SH",
            "ProductPrice": .00
        };

        this.ProductInfo["FREEMASKN"] = {
            "ProductName": "FREE! Silk Mask",
            "ProductSku": "DSMKSILK",
            "ProductPrice": .00
        };

        this.ProductInfo["CBAGN"] = {
            "ProductName": "FREE Cosmetic Bag",
            "ProductSku": "FLAWBAG",
            "ProductPrice": .00
        };

        this.ProductInfo["FREESMN"] = {
            "ProductName": "FREE GIFT WITH PURCHASE!  Flawless Silk Mask",
            "ProductSku": "DSMKSILK",
            "ProductPrice": .00
        };

        this.ProductInfo["FREEADAPTN"] = {
            "ProductName": "FREE GIFT WITH PURCHASE! Adaptor",
            "ProductSku": "FLADAPT",
            "ProductPrice": .00
        };

        this.ProductInfo["FREECSPA"] = {
            "ProductName": "FREE Cleanse Spa Shower Wand",
            "ProductSku": "FREECSPA",
            "ProductPrice": .00
        };

        this.ProductInfo["FREECSRH"] = {
            "ProductName": "FREE Cleanse Spa Replacement Heads",
            "ProductSku": "FREECSRH",
            "ProductPrice": .00
        };

        this.ProductInfo["FW4N"] = {
            "ProductName": "Facial Hair Remover 4.0 - White",
            "ProductSku": "FTFACE4W",
            "ProductPrice": 19.99
        };

        this.ProductInfo["FL4N"] = {
            "ProductName": "Facial Hair Remover 4.0 - Lavender Glow",
            "ProductSku": "FTFACE4L",
            "ProductPrice": 19.99
        };

        this.ProductInfo["FB4N"] = {
            "ProductName": "Facial Hair Remover 4.0 - Blue",
            "ProductSku": "FTFACE4B",
            "ProductPrice": 19.99
        };

        this.ProductInfo["FR4N"] = {
            "ProductName": "Facial Hair Remover 4.0 - Rose",
            "ProductSku": "FTFACE4R",
            "ProductPrice": 19.99
        };

        this.ProductInfo["BTU"] = {
            "ProductName": "Body Touch Up",
            "ProductSku": "BTUPLACEHOLDER",
            "ProductPrice": 29.99
        };

        this.ProductInfo["FREEREPNU"] = {
            "ProductName": "FREE NuRazor Replacement Heads",
            "ProductSku": "FREEREPNU",
            "ProductPrice": .00
        };

        this.ProductInfo["FREEREPPED"] = {
            "ProductName": "FREE Pedi Replacement Heads",
            "ProductSku": "FREEREPPED",
            "ProductPrice": .00
        };

        this.ProductInfo["FREEREPNAIL"] = {
            "ProductName": "FREE Salon Nails Replacement Heads",
            "ProductSku": "FREEREPNAIL",
            "ProductPrice": .00
        };

        this.ProductInfo["FREEREP2PK"] = {
            "ProductName": "FREE Finishing Touch Flawless 2020 Replacement Heads (Pack of 2)",
            "ProductSku": "FREEREP2PK",
            "ProductPrice": .00
        };

        this.ProductInfo["FREEREPH2PK"] = {
            "ProductName": "FREE Body Replacement Heads & 1 SensaGuard Cover",
            "ProductSku": "FREEREPH2PK",
            "ProductPrice": .00
        };

        this.ProductInfo["FLEG"] = {
            "ProductName": "Free Legs Replacement Head",
            "ProductSku": "FREELEGHEAD",
            "ProductPrice": .00
        };

        this.Ids["MAINPRODUCT"] = "254b261c-d3ef-e711-93fe-a0369f1303c6";

        this.Ids["GST"] = "244b261c-d3ef-e711-93fe-a0369f1303c6";

        this.Ids["WHITE"] = "57cdd695-c5aa-e811-93fe-a0369f1303c6";

        this.Ids["BLUSH"] = "160deca8-c5aa-e811-93fe-a0369f1303c6";

        this.Ids["LAVEN"] = "d56f42c3-c5aa-e811-93fe-a0369f1303c6";

        this.Ids["R2"] = "a5a65b1c-c6aa-e811-93fe-a0369f1303c6";

        this.Ids["LEGREP"] = "f957614e-c6aa-e811-93fe-a0369f1303c6";

        this.Ids["R4"] = "13da4928-c6aa-e811-93fe-a0369f1303c6";

        this.Ids["NUREP"] = "9520b273-ea21-ea11-8b97-a0369f1303c7";

        this.Ids["LEG"] = "8d17fb3a-c6aa-e811-93fe-a0369f1303c6";

        this.Ids["SNREP2"] = "393aa092-d672-eb11-8b97-a0369f1303c7";

        this.Ids["BROW"] = "6b260261-c6aa-e811-93fe-a0369f1303c6";

        this.Ids["ADDSHIP"] = "5c4911de-c6aa-e811-93fe-a0369f1303c6";

        this.Ids["WHITERECH"] = "50480019-41fa-e811-93fe-a0369f1303c6";

        this.Ids["BOD"] = "df2aa410-ed15-e911-93fe-a0369f1303c6";

        this.Ids["BODBON"] = "6b10f4ab-2040-e911-93fe-a0369f1303c6";

        this.Ids["DERMA"] = "ab175dc8-e71f-e911-93fe-a0369f1303c6";

        this.Ids["GLO"] = "3288fc03-a592-e911-93fe-a0369f1303c6";

        this.Ids["CONTOUR"] = "431b99a0-07bd-e911-93fe-a0369f1303c6";

        this.Ids["BLACK"] = "f9a0796c-0cc9-e911-8b8d-d094667d2ed1";

        this.Ids["LEGT"] = "09cba77f-0cc9-e911-8b8d-d094667d2ed1";

        this.Ids["BLACK2"] = "10f479c6-6a1c-ea11-8b97-a0369f1303c7";

        this.Ids["NU"] = "709a0633-fb1c-ea11-8b97-a0369f1303c7";

        this.Ids["NFRIG"] = "375f69f4-3820-ea11-8b97-a0369f1303c7";

        this.Ids["PREP"] = "e42f02de-b06f-eb11-8b97-a0369f1303c7";

        this.Ids["NFRIGFS"] = "eb852098-e754-ea11-8b97-a0369f1303c7";

        this.Ids["ADAPT"] = "4034b87d-989a-ea11-8b97-a0369f1303c7";

        this.Ids["CORAL2"] = "dee94f3d-00a5-ea11-8b97-a0369f1303c7";

        this.Ids["RF30"] = "f6caaf1f-64d2-ea11-8b97-a0369f1303c7";

        this.Ids["CLEANSE"] = "4313c27a-cdf2-ea11-8b97-a0369f1303c7";

        this.Ids["ICE"] = "f20edb21-1afd-ea11-8b97-a0369f1303c7";

        this.Ids["SPA"] = "94587947-0814-eb11-8b97-a0369f1303c7";

        this.Ids["SPAREP"] = "fe5d039f-7740-eb11-8b97-a0369f1303c7";

        this.Ids["PBLUE"] = "078cea53-593f-eb11-8b97-a0369f1303c7";

        this.Ids["NAILS"] = "1426d066-593f-eb11-8b97-a0369f1303c7";

        this.Ids["BROWPB"] = "71f14411-c83f-eb11-8b97-a0369f1303c7";

        this.Ids["NAILSREP"] = "08500d5a-3441-eb11-8b97-a0369f1303c7";

        this.Ids["PEDI"] = "0517d642-ca4e-eb11-8b97-a0369f1303c7";

        this.Ids["MASK"] = "840f4906-c06c-eb11-8b97-a0369f1303c7";

        this.Ids["BODREP"] = "9b924e55-ed15-e911-93fe-a0369f1303c6";

        this.Ids["SNREP"] = "1a7401cc-b06f-eb11-8b97-a0369f1303c7";

        this.Ids["GLOREP"] = "cd47e11d-a592-e911-93fe-a0369f1303c6";

        this.Ids["R219"] = "eca5b87e-4571-eb11-8b97-a0369f1303c7";

        this.Ids["CSREP"] = "ea9015b8-b06f-eb11-8b97-a0369f1303c7";

        this.Ids["STEAM"] = "920725ab-2dd8-eb11-8b97-a0369f1303c7";

        this.Ids["MASK4"] = "ace77113-4df1-eb11-8b97-a0369f1303c7";

        this.Ids["MASK1299"] = "5f407374-2d68-ec11-8b97-a0369f1303c7";

        this.Ids["BIKINI"] = "1a8ba98d-2d68-ec11-8b97-a0369f1303c7";

        this.Ids["FACEBLUSH"] = "1cc154fa-e277-ec11-8b97-a0369f1303c7";

        this.Ids["BROWBLUSH"] = "de39e81e-e377-ec11-8b97-a0369f1303c7";

        this.Ids["STEAMER"] = "12fa66e7-df9f-ec11-8b97-a0369f1303c7";

        this.Ids["FACELAV"] = "518722dc-aeb9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNFACE"] = "9d3444ff-afb9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNBROW"] = "7a8bbe24-b0b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNNAIL"] = "2674eb68-b0b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNPEDI"] = "b8624194-b0b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNFACE2"] = "f8f666eb-b0b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNBIK"] = "00fdfa03-b1b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNCLSE"] = "f06b0f3b-b1b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNDERM"] = "f74fd25a-b1b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNSTEAM"] = "1a247674-b1b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNFACE3"] = "b150c08c-b1b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNNUR"] = "170a27a5-b1b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNBIK2"] = "0affcdc3-b1b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNCLSE2"] = "f411c5e8-b1b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNCONT"] = "24272b02-b2b9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNICE"] = "699f8d14-b2b9-ec11-8b97-a0369f1303c7";

        this.Ids["SLFACECP"] = "c059dd11-6bba-ec11-8b97-a0369f1303c7";

        this.Ids["SLFACBRWDUO"] = "54d3315d-6bba-ec11-8b97-a0369f1303c7";

        this.Ids["SLFLBROW"] = "df118f7d-6bba-ec11-8b97-a0369f1303c7";

        this.Ids["SLFLBODYR"] = "d1429297-6bba-ec11-8b97-a0369f1303c7";

        this.Ids["BUNFACEBROWBUNDLE"] = "2bbcf3e1-abc4-ec11-8b97-a0369f1303c7";

        this.Ids["BUNNAILPEDIBUNDLE"] = "282821e3-d9c4-ec11-8b97-a0369f1303c7";

        this.Ids["BUNFACEBIKBUNDLE"] = "c91cfb0d-dac4-ec11-8b97-a0369f1303c7";

        this.Ids["BUNCLNSDERMBUNDLE"] = "f736153f-dac4-ec11-8b97-a0369f1303c7";

        this.Ids["BUNFACENUBUNDLE"] = "a6f46a52-dac4-ec11-8b97-a0369f1303c7";

        this.Ids["BUNCLNSCONTBUNDLE"] = "f871ee6a-dac4-ec11-8b97-a0369f1303c7";

        this.Ids["MITT"] = "56af8091-d5e8-ec11-8b97-a0369f1303c7";

        this.Ids["BUNCLEANMITTBUNDLE"] = "518aea41-d6e8-ec11-8b97-a0369f1303c7";

        this.Ids["BUNCLSEM"] = "5ccea48d-d6e8-ec11-8b97-a0369f1303c7";

        this.Ids["BUNMITTS"] = "a2fee2b8-d6e8-ec11-8b97-a0369f1303c7";

        this.Ids["PLAVEN"] = "f4cf78ac-e2f7-ec11-8b97-a0369f1303c7";

        this.Ids["ADAPTF"] = "44df686b-989a-ea11-8b97-a0369f1303c7";

        this.Ids["FREEMASK"] = "a9efb107-6baf-eb11-8b97-a0369f1303c7";

        this.Ids["CBAG"] = "ef020266-9baf-ec11-8b97-a0369f1303c7";

        this.Ids["FREESM"] = "94d208e7-4ab0-ec11-8b97-a0369f1303c7";

        this.Ids["FREEADAPT"] = "336286a9-aeb9-ec11-8b97-a0369f1303c7";

        this.Ids["BUNPCMITTS"] = "93d493d8-a2ed-ec11-8b97-a0369f1303c7";

        this.Ids["WHITEN"] = "73d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BLUSHN"] = "74d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SEAN"] = "75d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["LAVENN"] = "76d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["R2N"] = "77d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["R4N"] = "78d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["LEGN"] = "79d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["LEGREPN"] = "7ad70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BROWN"] = "7bd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["WHITERECHN"] = "7cd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BODN"] = "7dd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BODREPN"] = "7ed70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["DERMAN"] = "7fd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BODBONN"] = "80d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["GLON"] = "81d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["GLOREPN"] = "82d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["CONTOURN"] = "83d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BLACK2N"] = "84d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["NUN"] = "85d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["NFRIGN"] = "86d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["NUREPN"] = "87d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["NFRIGFSN"] = "88d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["ADAPTFN"] = "89d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["ADAPTN"] = "8ad70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["CORAL2N"] = "8bd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["RF30N"] = "8cd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["CLEANSEN"] = "8dd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["ICEN"] = "8ed70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SPAN"] = "8fd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["PBLUEN"] = "90d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["NAILSN"] = "91d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BROWPBN"] = "92d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SPAREPN"] = "93d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["NAILSREPN"] = "94d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["PEDIN"] = "95d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["MASKN"] = "96d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["CSREPN"] = "97d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SNREPN"] = "98d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["PREPN"] = "99d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["R219N"] = "9ad70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SNREP2N"] = "9bd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["STEAMN"] = "9dd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["MASK4N"] = "9ed70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["MASK1299N"] = "9fd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BIKININ"] = "a0d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["FACEBLUSHN"] = "a1d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BROWBLUSHN"] = "a2d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["STEAMERN"] = "a3d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["FACELAVN"] = "a7d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNFACEN"] = "a8d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNBROWN"] = "a9d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNNAILN"] = "aad70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNPEDIN"] = "abd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNFACE2N"] = "acd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNBIKN"] = "add70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNCLSEN"] = "aed70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNDERMN"] = "afd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNSTEAMN"] = "b0d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNFACE3N"] = "b1d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNNURN"] = "b2d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNBIK2N"] = "b3d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNCLSE2N"] = "b4d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNCONTN"] = "b5d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNICEN"] = "b6d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SLFACECPN"] = "b7d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SLFACBRWDUON"] = "b8d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SLFLBROWN"] = "b9d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["SLFLBODYRN"] = "bad70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNFACEBROWBUNDLEN"] = "bbd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNNAILPEDIBUNDLEN"] = "bcd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNFACEBIKBUNDLEN"] = "bdd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNCLNSDERMBUNDLEN"] = "bed70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNFACENUBUNDLEN"] = "bfd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNCLNSCONTBUNDLEN"] = "c0d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["MITTN"] = "c1d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNCLEANMITTBUNDLEN"] = "c2d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNCLSEMN"] = "c3d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNMITTSN"] = "c4d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BUNPCMITTSN"] = "c5d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["PLAVENN"] = "c6d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["BLACKN"] = "c7d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["LEGTN"] = "c8d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["UA"] = "ddd4a950-0d1f-ed11-8b97-a0369f1303c7";

        this.Ids["SHR"] = "a01c7269-0d1f-ed11-8b97-a0369f1303c7";

        this.Ids["UAN"] = "2d63f980-2b22-ed11-8b97-a0369f1303c7";

        this.Ids["SHRN"] = "140f8793-2b22-ed11-8b97-a0369f1303c7";

        this.Ids["SHFEE"] = "615d1c92-c6aa-e811-93fe-a0369f1303c6";

        this.Ids["FREEMASKN"] = "9cd70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["CBAGN"] = "a4d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["FREESMN"] = "a5d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["FREEADAPTN"] = "a6d70aad-300c-ed11-8b97-a0369f1303c7";

        this.Ids["FREECSPA"] = "910a652e-f57b-ed11-8b98-a0369f1303c7";

        this.Ids["FREECSRH"] = "dfe31763-0d07-ee11-8b98-a0369f1303c7";

        this.Ids["FW4N"] = "18c64038-ef1f-ee11-8b98-a0369f1303c7";

        this.Ids["FL4N"] = "3f879b5d-ef1f-ee11-8b98-a0369f1303c7";

        this.Ids["FB4N"] = "574edd70-ef1f-ee11-8b98-a0369f1303c7";

        this.Ids["FR4N"] = "2ebf6083-ef1f-ee11-8b98-a0369f1303c7";

        this.Ids["BTU"] = "59004054-b037-ee11-8b98-a0369f1303c7";

        this.Ids["FREEREPNU"] = "8efad516-e848-ee11-8b98-a0369f1303c7";

        this.Ids["FREEREPPED"] = "ab2cc741-e848-ee11-8b98-a0369f1303c7";

        this.Ids["FREEREPNAIL"] = "24e62c61-e848-ee11-8b98-a0369f1303c7";

        this.Ids["FREEREP2PK"] = "c5ecf79f-e848-ee11-8b98-a0369f1303c7";

        this.Ids["FREEREPH2PK"] = "822e0e52-1c53-ee11-8b98-a0369f1303c7";

        this.Ids["FLEG"] = "5f141bdb-6f5c-ee11-8b98-a0369f1303c7";


        var isNullOrWhitespace = function (value) {
            let nullOrWhitespace = false;
            if (value == null || value == undefined) {
                nullOrWhitespace = true;
            } else {
                try {
                    if (value == '' || value.trim() == '' || value == 'undefined') {
                        nullOrWhitespace = true;
                    }
                } catch (e) {
                    nullOrWhitespace = false;
                }
            }

            return nullOrWhitespace;
        };

        this.ViewProduct = function () {
            let firstProduct;
            const items = document.getElementsByName("ActionCode0");

            if (items.length > 0) {

                firstProduct = items[0].value;
                const productInfo = this.ProductInfo[firstProduct];
                if (productInfo) {
                    let viewProductEvent = {
                        "ProductName": productInfo.ProductName,
                        "ProductID": this.Ids[firstProduct],
                        "SKU": productInfo.ProductSku,
                        "ImageURL": this.ImageUrls[productInfo.ProductSku],
                        "URL": isNullOrWhitespace(this.ProductUrls[productInfo.ProductSku]) ? "https://idvftfbs.dtmstage.com/" : this.ProductUrls[productInfo.ProductSku],
                        "Price": productInfo.ProductPrice
                    };

                    _learnq.push(["track", "Viewed Product", viewProductEvent]);

                    if (typeof geq !== 'undefined') {
                        geq.event('Viewed Product Reclaim', viewProductEvent);
                    }

                    console.log(viewProductEvent);
                }
            }
        };

        this.AddToCart = function (cartData) {
            if (isIdentified() && cartData && cartData.items && cartData.items.length > 0) {

                let kItems = [],
                    firstItem;
                for (let i = 0; i < cartData.items.length; i++) {
                    let item = cartData.items[i];
                    let kItem = {
                        "SKU": item.sku,
                        "ProductName": item.name,
                        "Quantity": item.qty,
                        "ItemPrice": item.price,
                        "ImageURL": this.ImageUrls[item.sku],
                        "ProductId": this.Ids[item.code],
                        "ProductURL": isNullOrWhitespace(this.ProductUrls[item.sku]) ? "https://idvftfbs.dtmstage.com/" : this.ProductUrls[item.sku]
                    };

                    if (self.Brand) {
                        kItem["Brand"] = self.Brand;
                    }

                    if (self.Category) {
                        kItem["Categories"] = [self.Category];
                    }

                    kItems.push(kItem);

                    if (items.indexOf(item.name) < 0) {
                        items.push(item.name);
                        if (!firstItem) {
                            firstItem = item;
                        }
                    }
                }

                if (!firstItem) {
                    firstItem = cartData.items[0];
                };

                let addToCartEvent = {
                    "$value": cartData.total,
                    "AddedItemProductName": firstItem.name,
                    "ProductName": firstItem.name,
                    "AddedItemSKU": firstItem.sku,
                    "SKU": firstItem.sku,
                    "AddedItemPrice": firstItem.price,
                    "ItemPrice": firstItem.Price,
                    "ProductId": this.Ids[firstItem.code],
                    "AddedItemQuantity": firstItem.qty,
                    "Quantity": firstItem.qty,
                    "AddedItemImageURL": this.ImageUrls[firstItem.sku],
                    "ImageUrl": this.ImageUrls[firstItem.sku],
                    "ProductUrl": isNullOrWhitespace(this.ProductUrls[firstItem.sku]) ? "https://idvftfbs.dtmstage.com/" : this.ProductUrls[firstItem.sku],
                    "ItemNames": cartData.itemNames,
                    "CheckoutURL": "https://idvftfbs.dtmstage.com/",
                    "Campaign": self.Campaign,
                    "Offer": self.Offer,
                    "Items": kItems
                };

                if (self.Brand) {
                    addToCartEvent["Brands"] = [self.Brand];
                }

                if (self.Category) {
                    addToCartEvent["Categories"] = [self.Category];
                }

                _learnq.push(["track", "Added to Cart", addToCartEvent]);

                if (typeof geq !== 'undefined') {
                    geq.addToCart(addToCartEvent);
                }
            }
        };

        this.StartedShoppingCartCheckout = function () {
            let itemNames = [],
                items = [],
                self = this;
	
        };


    };





    Klaviyo.prototype.Campaign = 'IDVFTFBS';
    Klaviyo.prototype.Offer = 'UPGRADE';

    const klaviyo = new Klaviyo();
</script>


<!-- Begin Impression -->
<script type='text/javascript'>
    (function () {
        var pixelElement = document.createElement('img');
        pixelElement.src = 'https://tags.w55c.net/rs?id=aa1cdee1f0ce494fb057989146d49439&t=homepage';
     var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(pixelElement, s);
 })();
</script>
<!-- End Impression -->



<!-- Begin Impression -->

<script>
    !function (w, d, t) {
        w.TiktokAnalyticsObject = t;
        var ttq = w[t] = w[t] || [];
        ttq.methods = ["page", "track", "identify", "instances", "debug", "on", "off", "once", "ready", "alias", "group", "enableCookie", "disableCookie"], ttq.setAndDefer = function (t, e) {
            t[e] = function () {
                t.push([e].concat(Array.prototype.slice.call(arguments, 0)))
            }
        };
        for (var i = 0; i < ttq.methods.length; i++) ttq.setAndDefer(ttq, ttq.methods[i]);
        ttq.instance = function (t) {
            for (var e = ttq._i[t] || [], n = 0; n < ttq.methods.length; n++) ttq.setAndDefer(e, ttq.methods[n]);
            return e
        }, ttq.load = function (e, n) {
            var i = "https://analytics.tiktok.com/i18n/pixel/events.js";
            ttq._i = ttq._i || {}, ttq._i[e] = [], ttq._i[e]._u = i, ttq._t = ttq._t || {}, ttq._t[e] = +new Date, ttq._o = ttq._o || {}, ttq._o[e] = n || {};
            var o = document.createElement("script");
            o.type = "text/javascript", o.async = !0, o.src = i + "?sdkid=" + e + "&lib=" + t;
            var a = document.getElementsByTagName("script")[0];
            a.parentNode.insertBefore(o, a)
        };

        ttq.load('CCBRAOJC77U5BD5RA6L0');
        ttq.page();

    function postAdvancedMatching(email, phone) {
        if (email !== '' && phone !== '') {
            ttq.identify({
                            email: email,
                            phone_number: phone
                    });
                }
        }

        function getFormattedParameters() {
            let emailElement = document.getElementById("Email"),
                phoneElement = document.getElementById("Phone");

            let advancedMatching = { formattedEmail: "", formattedPhone: "" };

            if (emailElement && validateEmail(emailElement.value)) {
                advancedMatching.formattedEmail = emailElement.toLowerCase();
            }
            if (phoneElement && validatePhone(phoneElement.value)) {
                advancedMatching.formattedPhone = "+1" + phoneElement.value.replace(/[^0-9\\.]+/g, '');
            }

            return advancedMatching;
        }

        function validateEmail(email) {
            if (isEmpty(email)) {
                return false;
            }
            let reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
            return reg.test(email);
        }

        function validatePhone(phone) {
            if (isEmpty(phone)) {
                return false;
            }

            return phone.length >= 10;
        }

        function isEmpty(value) {
            if (value == null) return true;
            let str = value.replace(/^\s\s*/, "").replace(/\s\s*$/, "");
            return str.length == 0;
        }


    
        let _currentCart = {};

        function addToCart(cart) {
            var contents = [];
            var total = 0;
            for (var i = 0; i < cart.items.length; i++) {
                var item = cart.items[i];
                if ((!_currentCart[item.code] || _currentCart[item.code] != item.qty) && item.price >= 0) {
                    contents.push({
                        content_type: 'product',
                        content_id: item.code,
                        price: item.price,
                        quantity: item.qty
                    });
                    total += (item.price * item.qty);
                }

                _currentCart[item.code] = item.qty;
            }

            if (contents.length > 0) {
                ttq.instance('CCBRAOJC77U5BD5RA6L0').track('AddToCart', {
                    contents: contents,
                    value: total.toFixed(2),
                    currency: 'USD'
                });
            }
        }

        function initiateCheckout() {
            let parameters = getFormattedParameters();
            postAdvancedMatching(parameters.email, parameters.phone);

            ttq.instance('CCBRAOJC77U5BD5RA6L0').track('InitiateCheckout', {
                content_type: 'product_group',
                content_id: 'IDVFTFBS1'
            });
        }


        

        var tiktokProducts = [{"ProductCode":"MAINPRODUCT","ProductPrice":1.9900},{"ProductCode":"REPLACE","ProductPrice":0.0000},{"ProductCode":"GST","ProductPrice":0.0000},{"ProductCode":"QUOTE2","ProductPrice":0.0000},{"ProductCode":"QUOTE1","ProductPrice":0.0000},{"ProductCode":"QUOTE3","ProductPrice":0.0000},{"ProductCode":"QUOTE4","ProductPrice":0.0000},{"ProductCode":"QUOTE6","ProductPrice":0.0000},{"ProductCode":"QUOTE7","ProductPrice":0.0000},{"ProductCode":"QUOTE8","ProductPrice":0.0000},{"ProductCode":"QUOTE9","ProductPrice":0.0000},{"ProductCode":"QUOTE10","ProductPrice":0.0000},{"ProductCode":"QUOTE11","ProductPrice":0.0000},{"ProductCode":"QUOTE12","ProductPrice":0.0000},{"ProductCode":"QUOTE13","ProductPrice":0.0000},{"ProductCode":"QUOTE14","ProductPrice":0.0000},{"ProductCode":"QUOTE15","ProductPrice":0.0000},{"ProductCode":"QUOTE16","ProductPrice":0.0000},{"ProductCode":"QUOTE17","ProductPrice":0.0000},{"ProductCode":"QUOTE18","ProductPrice":0.0000},{"ProductCode":"QUOTE19","ProductPrice":0.0000},{"ProductCode":"QUOTE20","ProductPrice":0.0000},{"ProductCode":"FLAWLESS","ProductPrice":0.0000},{"ProductCode":"LEGS","ProductPrice":0.0000},{"ProductCode":"DERMAPLANE","ProductPrice":0.0000},{"ProductCode":"ABOUT","ProductPrice":0.0000},{"ProductCode":"BROWS","ProductPrice":0.0000},{"ProductCode":"WHITE","ProductPrice":19.9900},{"ProductCode":"BLUSH","ProductPrice":19.9900},{"ProductCode":"LAVEN","ProductPrice":19.9900},{"ProductCode":"R2","ProductPrice":12.9900},{"ProductCode":"LEGREP","ProductPrice":24.9900},{"ProductCode":"R4","ProductPrice":19.9900},{"ProductCode":"NUREP","ProductPrice":14.9900},{"ProductCode":"LEG","ProductPrice":59.9800},{"ProductCode":"SNREP2","ProductPrice":9.9900},{"ProductCode":"BROW","ProductPrice":19.9900},{"ProductCode":"ADDSHIP","ProductPrice":0.0000},{"ProductCode":"WHITERECH","ProductPrice":29.9800},{"ProductCode":"GDQ_FLAWLESS","ProductPrice":19.9900},{"ProductCode":"GDQ_FLAWLESS6","ProductPrice":19.9900},{"ProductCode":"BOD","ProductPrice":29.9900},{"ProductCode":"BODBON","ProductPrice":0.0000},{"ProductCode":"QUOTE27","ProductPrice":0.0000},{"ProductCode":"QUOTE28","ProductPrice":0.0000},{"ProductCode":"QUOTE29","ProductPrice":0.0000},{"ProductCode":"QUOTE30","ProductPrice":0.0000},{"ProductCode":"QUOTE31","ProductPrice":0.0000},{"ProductCode":"QUOTE32","ProductPrice":0.0000},{"ProductCode":"QUOTE33","ProductPrice":0.0000},{"ProductCode":"QUOTE34","ProductPrice":0.0000},{"ProductCode":"QUOTE35","ProductPrice":0.0000},{"ProductCode":"QUOTE36","ProductPrice":0.0000},{"ProductCode":"QUOTE37","ProductPrice":0.0000},{"ProductCode":"QUOTE38","ProductPrice":0.0000},{"ProductCode":"QUOTE39","ProductPrice":0.0000},{"ProductCode":"QUOTE40","ProductPrice":0.0000},{"ProductCode":"QUOTE41","ProductPrice":0.0000},{"ProductCode":"DERMA","ProductPrice":9.9900},{"ProductCode":"LEGS20","ProductPrice":0.0000},{"ProductCode":"PRO10","ProductPrice":0.0000},{"ProductCode":"GLO10","ProductPrice":0.0000},{"ProductCode":"CONTOUR10","ProductPrice":0.0000},{"ProductCode":"FLAWLESS10","ProductPrice":0.0000},{"ProductCode":"LOVEFLAWLESS","ProductPrice":0.0000},{"ProductCode":"SURVEY10","ProductPrice":0.0000},{"ProductCode":"GLO","ProductPrice":19.9900},{"ProductCode":"CONTOUR","ProductPrice":19.9900},{"ProductCode":"BLACK","ProductPrice":19.9900},{"ProductCode":"LEGT","ProductPrice":39.9900},{"ProductCode":"AVREY10","ProductPrice":0.0000},{"ProductCode":"YASMIN10","ProductPrice":0.0000},{"ProductCode":"JESSICA10","ProductPrice":0.0000},{"ProductCode":"NABELA10","ProductPrice":0.0000},{"ProductCode":"SARAH10","ProductPrice":0.0000},{"ProductCode":"NURAZOR10","ProductPrice":0.0000},{"ProductCode":"BROWS10","ProductPrice":0.0000},{"ProductCode":"EMILY10","ProductPrice":0.0000},{"ProductCode":"SHAYLA10","ProductPrice":0.0000},{"ProductCode":"JASMINE10","ProductPrice":0.0000},{"ProductCode":"CARLI10","ProductPrice":0.0000},{"ProductCode":"DANIELLA10","ProductPrice":0.0000},{"ProductCode":"TAYLOR10","ProductPrice":0.0000},{"ProductCode":"BLACK2","ProductPrice":19.9900},{"ProductCode":"NU","ProductPrice":39.9900},{"ProductCode":"ARNELL10","ProductPrice":0.0000},{"ProductCode":"NYMA10","ProductPrice":0.0000},{"ProductCode":"AYSHA10","ProductPrice":0.0000},{"ProductCode":"QUOTE42","ProductPrice":0.0000},{"ProductCode":"QUOTE43","ProductPrice":0.0000},{"ProductCode":"QUOTE44","ProductPrice":0.0000},{"ProductCode":"NFRIG","ProductPrice":59.9900},{"ProductCode":"KAIT10","ProductPrice":0.0000},{"ProductCode":"PREP","ProductPrice":9.9900},{"ProductCode":"SUMMER10","ProductPrice":0.0000},{"ProductCode":"NATALIE10","ProductPrice":0.0000},{"ProductCode":"MEG10","ProductPrice":0.0000},{"ProductCode":"ASPYN10","ProductPrice":0.0000},{"ProductCode":"KRISTIN10","ProductPrice":0.0000},{"ProductCode":"AVA10","ProductPrice":0.0000},{"ProductCode":"ALEX10","ProductPrice":0.0000},{"ProductCode":"CHANTEL10","ProductPrice":0.0000},{"ProductCode":"GRWM10","ProductPrice":0.0000},{"ProductCode":"NFRIGFS","ProductPrice":59.9900},{"ProductCode":"CORINNA10","ProductPrice":0.0000},{"ProductCode":"RYLEY10","ProductPrice":0.0000},{"ProductCode":"LAUREN10","ProductPrice":0.0000},{"ProductCode":"GABI10","ProductPrice":0.0000},{"ProductCode":"FRIDGE20","ProductPrice":0.0000},{"ProductCode":"CASEY10","ProductPrice":0.0000},{"ProductCode":"NYJA10","ProductPrice":0.0000},{"ProductCode":"KISH10","ProductPrice":0.0000},{"ProductCode":"MADDIE10","ProductPrice":0.0000},{"ProductCode":"LINDSI10","ProductPrice":0.0000},{"ProductCode":"DANNY10","ProductPrice":0.0000},{"ProductCode":"SQUARE10","ProductPrice":0.0000},{"ProductCode":"MOM10","ProductPrice":0.0000},{"ProductCode":"TIKTOK10","ProductPrice":0.0000},{"ProductCode":"CLEANSE10","ProductPrice":0.0000},{"ProductCode":"CND20","ProductPrice":0.0000},{"ProductCode":"ADAPT","ProductPrice":4.9900},{"ProductCode":"CORAL2","ProductPrice":19.9900},{"ProductCode":"ICE10","ProductPrice":0.0000},{"ProductCode":"RF30","ProductPrice":12.9900},{"ProductCode":"DELANEY10","ProductPrice":0.0000},{"ProductCode":"SNAP10","ProductPrice":0.0000},{"ProductCode":"CHYENNE10","ProductPrice":0.0000},{"ProductCode":"KAYLEIGH10","ProductPrice":0.0000},{"ProductCode":"NEZZA10","ProductPrice":0.0000},{"ProductCode":"LYNN10","ProductPrice":0.0000},{"ProductCode":"MELISSA10","ProductPrice":0.0000},{"ProductCode":"STEPHANIE10","ProductPrice":0.0000},{"ProductCode":"NAILS10","ProductPrice":0.0000},{"ProductCode":"CLEANSE","ProductPrice":39.9900},{"ProductCode":"CLAUDIA10","ProductPrice":0.0000},{"ProductCode":"EILEEN10","ProductPrice":0.0000},{"ProductCode":"KIMBERLY10","ProductPrice":0.0000},{"ProductCode":"GOLDY10","ProductPrice":0.0000},{"ProductCode":"LUCIE10","ProductPrice":0.0000},{"ProductCode":"ASHLEY10","ProductPrice":0.0000},{"ProductCode":"NIA10","ProductPrice":0.0000},{"ProductCode":"KOUVR10","ProductPrice":0.0000},{"ProductCode":"ELLIE10","ProductPrice":0.0000},{"ProductCode":"LIV10","ProductPrice":0.0000},{"ProductCode":"YANA10","ProductPrice":0.0000},{"ProductCode":"THANKU10","ProductPrice":0.0000},{"ProductCode":"SHAHD10","ProductPrice":0.0000},{"ProductCode":"ICE","ProductPrice":9.9900},{"ProductCode":"SALE20","ProductPrice":0.0000},{"ProductCode":"BLACK20","ProductPrice":0.0000},{"ProductCode":"JERA10","ProductPrice":0.0000},{"ProductCode":"TANI10","ProductPrice":0.0000},{"ProductCode":"CARYN10","ProductPrice":0.0000},{"ProductCode":"CATIE10","ProductPrice":0.0000},{"ProductCode":"COCO10","ProductPrice":0.0000},{"ProductCode":"JULIA10","ProductPrice":0.0000},{"ProductCode":"ZAHRA10","ProductPrice":0.0000},{"ProductCode":"MARIAH10","ProductPrice":0.0000},{"ProductCode":"MONROE10","ProductPrice":0.0000},{"ProductCode":"TENISHA10","ProductPrice":0.0000},{"ProductCode":"FALLFAVE","ProductPrice":0.0000},{"ProductCode":"JENN10","ProductPrice":0.0000},{"ProductCode":"SPA","ProductPrice":29.9900},{"ProductCode":"FRIENDS20","ProductPrice":0.0000},{"ProductCode":"SPAREP","ProductPrice":0.0000},{"ProductCode":"NINA10","ProductPrice":0.0000},{"ProductCode":"ELIANA10","ProductPrice":0.0000},{"ProductCode":"LESLIE10","ProductPrice":0.0000},{"ProductCode":"SONALI10","ProductPrice":0.0000},{"ProductCode":"KENNEDY10","ProductPrice":0.0000},{"ProductCode":"DASIA10","ProductPrice":0.0000},{"ProductCode":"TAJ10","ProductPrice":0.0000},{"ProductCode":"HOLIDAY20","ProductPrice":0.0000},{"ProductCode":"FRIDAY20","ProductPrice":0.0000},{"ProductCode":"MONDAY20","ProductPrice":0.0000},{"ProductCode":"PBLUE","ProductPrice":19.9900},{"ProductCode":"NAILS","ProductPrice":19.9900},{"ProductCode":"BROWPB","ProductPrice":19.9900},{"ProductCode":"BROWS20","ProductPrice":0.0000},{"ProductCode":"NAILSREP","ProductPrice":0.0000},{"ProductCode":"PEDI","ProductPrice":19.9900},{"ProductCode":"NEWYEAR21","ProductPrice":0.0000},{"ProductCode":"HALLE20","ProductPrice":0.0000},{"ProductCode":"BEMINE25","ProductPrice":0.0000},{"ProductCode":"ASHLEY15","ProductPrice":0.0000},{"ProductCode":"DOVE10","ProductPrice":0.0000},{"ProductCode":"HALLE10","ProductPrice":0.0000},{"ProductCode":"AMELIA10","ProductPrice":0.0000},{"ProductCode":"AMOR25","ProductPrice":0.0000},{"ProductCode":"MASK","ProductPrice":9.9900},{"ProductCode":"BODREP","ProductPrice":14.9900},{"ProductCode":"SNREP","ProductPrice":7.9900},{"ProductCode":"GLOREP","ProductPrice":9.9900},{"ProductCode":"R219","ProductPrice":12.9900},{"ProductCode":"CSREP","ProductPrice":9.9900},{"ProductCode":"AMELIA15","ProductPrice":0.0000},{"ProductCode":"SPA10","ProductPrice":0.0000},{"ProductCode":"NEW10","ProductPrice":0.0000},{"ProductCode":"BEAUTY10","ProductPrice":0.0000},{"ProductCode":"BEAUTY20","ProductPrice":0.0000},{"ProductCode":"FF10","ProductPrice":0.0000},{"ProductCode":"FF20","ProductPrice":0.0000},{"ProductCode":"SAVE20","ProductPrice":0.0000},{"ProductCode":"SAVE10","ProductPrice":0.0000},{"ProductCode":"GET20","ProductPrice":0.0000},{"ProductCode":"STEAM","ProductPrice":0.0000},{"ProductCode":"DEAL20","ProductPrice":0.0000},{"ProductCode":"BEST20","ProductPrice":0.0000},{"ProductCode":"SUMMER20","ProductPrice":0.0000},{"ProductCode":"NAILS20","ProductPrice":0.0000},{"ProductCode":"SAFE20","ProductPrice":0.0000},{"ProductCode":"MASK4","ProductPrice":29.9900},{"ProductCode":"SUNNY20","ProductPrice":0.0000},{"ProductCode":"SKINCARE20","ProductPrice":0.0000},{"ProductCode":"MARIASEE10","ProductPrice":0.0000},{"ProductCode":"PEDI20","ProductPrice":0.0000},{"ProductCode":"CONTOUR20","ProductPrice":0.0000},{"ProductCode":"LESS20","ProductPrice":0.0000},{"ProductCode":"ALLURE20","ProductPrice":0.0000},{"ProductCode":"THANKYOU20","ProductPrice":0.0000},{"ProductCode":"SILK20","ProductPrice":0.0000},{"ProductCode":"MANI20","ProductPrice":0.0000},{"ProductCode":"FACE20","ProductPrice":0.0000},{"ProductCode":"FALL20","ProductPrice":0.0000},{"ProductCode":"TREAT20","ProductPrice":0.0000},{"ProductCode":"THANKS20","ProductPrice":0.0000},{"ProductCode":"PERFECT20","ProductPrice":0.0000},{"ProductCode":"CYBER30","ProductPrice":0.0000},{"ProductCode":"BROW20","ProductPrice":0.0000},{"ProductCode":"ALL20","ProductPrice":0.0000},{"ProductCode":"YSABELA15","ProductPrice":0.0000},{"ProductCode":"IVANA15","ProductPrice":0.0000},{"ProductCode":"PURECLEAN10","ProductPrice":0.0000},{"ProductCode":"BIKINI10","ProductPrice":0.0000},{"ProductCode":"NEXT20","ProductPrice":0.0000},{"ProductCode":"WOW20","ProductPrice":0.0000},{"ProductCode":"VIP20","ProductPrice":0.0000},{"ProductCode":"GIFT20","ProductPrice":0.0000},{"ProductCode":"QUICK20","ProductPrice":0.0000},{"ProductCode":"CHEERS20","ProductPrice":0.0000},{"ProductCode":"DEC20","ProductPrice":0.0000},{"ProductCode":"MASK1299","ProductPrice":12.9900},{"ProductCode":"BIKINI","ProductPrice":19.9900},{"ProductCode":"FACEBLUSH","ProductPrice":19.9900},{"ProductCode":"BROWBLUSH","ProductPrice":19.9900},{"ProductCode":"GDQ_FACE","ProductPrice":19.9900},{"ProductCode":"GDQ_BROW","ProductPrice":19.9900},{"ProductCode":"FABFACE","ProductPrice":0.0000},{"ProductCode":"PERFECT10","ProductPrice":0.0000},{"ProductCode":"STRAYHAIR10","ProductPrice":0.0000},{"ProductCode":"FACEDUO10","ProductPrice":0.0000},{"ProductCode":"WELOVEU","ProductPrice":0.0000},{"ProductCode":"STEAMER","ProductPrice":49.8800},{"ProductCode":"YOUNAILEDIT","ProductPrice":0.0000},{"ProductCode":"FACELAV","ProductPrice":19.9900},{"ProductCode":"BUNFACE","ProductPrice":17.5000},{"ProductCode":"BUNBROW","ProductPrice":17.5000},{"ProductCode":"BUNNAIL","ProductPrice":17.5000},{"ProductCode":"BUNPEDI","ProductPrice":17.5000},{"ProductCode":"BUNFACE2","ProductPrice":17.5000},{"ProductCode":"BUNBIK","ProductPrice":17.5000},{"ProductCode":"BUNCLSE","ProductPrice":35.0000},{"ProductCode":"BUNDERM","ProductPrice":17.5000},{"ProductCode":"BUNSTEAM","ProductPrice":43.5000},{"ProductCode":"BUNFACE3","ProductPrice":17.5000},{"ProductCode":"BUNNUR","ProductPrice":35.0000},{"ProductCode":"BUNBIK2","ProductPrice":17.5000},{"ProductCode":"BUNCLSE2","ProductPrice":35.0000},{"ProductCode":"BUNCONT","ProductPrice":17.0000},{"ProductCode":"BUNICE","ProductPrice":9.0000},{"ProductCode":"SLFACECP","ProductPrice":13.9900},{"ProductCode":"SLFACBRWDUO","ProductPrice":29.9900},{"ProductCode":"SLFLBROW","ProductPrice":13.9900},{"ProductCode":"SLFLBODYR","ProductPrice":19.9900},{"ProductCode":"SPRINGCLEAN","ProductPrice":0.0000},{"ProductCode":"BUNFACEBROWBUNDLE","ProductPrice":0.0000},{"ProductCode":"BUNNAILPEDIBUNDLE","ProductPrice":0.0000},{"ProductCode":"BUNFACEBIKBUNDLE","ProductPrice":0.0000},{"ProductCode":"BUNCLNSDERMBUNDLE","ProductPrice":0.0000},{"ProductCode":"BUNFACENUBUNDLE","ProductPrice":0.0000},{"ProductCode":"BUNCLNSCONTBUNDLE","ProductPrice":0.0000},{"ProductCode":"SUPER10","ProductPrice":0.0000},{"ProductCode":"UNDERARM10","ProductPrice":0.0000},{"ProductCode":"MDW2210","ProductPrice":0.0000},{"ProductCode":"MDW2215","ProductPrice":0.0000},{"ProductCode":"MDW2220","ProductPrice":0.0000},{"ProductCode":"FRESH15","ProductPrice":0.0000},{"ProductCode":"MITT","ProductPrice":19.9900},{"ProductCode":"BUNCLEANMITTBUNDLE","ProductPrice":0.0000},{"ProductCode":"BUNCLSEM","ProductPrice":35.0000},{"ProductCode":"BUNMITTS","ProductPrice":17.0000},{"ProductCode":"ALYSSA20","ProductPrice":0.0000},{"ProductCode":"PLAVEN","ProductPrice":19.9900},{"ProductCode":"HEART","ProductPrice":0.0000},{"ProductCode":"ADAPTF","ProductPrice":4.9900},{"ProductCode":"FREEMASK","ProductPrice":0.0000},{"ProductCode":"ILOVEME","ProductPrice":0.0000},{"ProductCode":"CBAG","ProductPrice":0.0000},{"ProductCode":"FREESM","ProductPrice":0.0000},{"ProductCode":"FREEADAPT","ProductPrice":0.0000},{"ProductCode":"BUNPCMITTS","ProductPrice":17.0000},{"ProductCode":"APPD2022","ProductPrice":0.0000},{"ProductCode":"APD2022","ProductPrice":0.0000},{"ProductCode":"BUNDLES","ProductPrice":0.0000},{"ProductCode":"WHITEN","ProductPrice":19.9900},{"ProductCode":"BLUSHN","ProductPrice":19.9900},{"ProductCode":"SEAN","ProductPrice":19.9900},{"ProductCode":"LAVENN","ProductPrice":19.9900},{"ProductCode":"R2N","ProductPrice":12.9900},{"ProductCode":"R4N","ProductPrice":19.9900},{"ProductCode":"LEGN","ProductPrice":59.9800},{"ProductCode":"LEGREPN","ProductPrice":24.9900},{"ProductCode":"BROWN","ProductPrice":19.9900},{"ProductCode":"WHITERECHN","ProductPrice":29.9800},{"ProductCode":"BODN","ProductPrice":29.9900},{"ProductCode":"BODREPN","ProductPrice":14.9900},{"ProductCode":"DERMAN","ProductPrice":9.9900},{"ProductCode":"BODBONN","ProductPrice":0.0000},{"ProductCode":"GLON","ProductPrice":19.9900},{"ProductCode":"GLOREPN","ProductPrice":9.9900},{"ProductCode":"CONTOURN","ProductPrice":19.9900},{"ProductCode":"BLACK2N","ProductPrice":19.9900},{"ProductCode":"NUN","ProductPrice":39.9900},{"ProductCode":"NFRIGN","ProductPrice":59.9900},{"ProductCode":"NUREPN","ProductPrice":14.9900},{"ProductCode":"NFRIGFSN","ProductPrice":59.9900},{"ProductCode":"ADAPTFN","ProductPrice":4.9900},{"ProductCode":"ADAPTN","ProductPrice":4.9900},{"ProductCode":"CORAL2N","ProductPrice":19.9900},{"ProductCode":"RF30N","ProductPrice":12.9900},{"ProductCode":"CLEANSEN","ProductPrice":39.9900},{"ProductCode":"ICEN","ProductPrice":9.9900},{"ProductCode":"SPAN","ProductPrice":29.9900},{"ProductCode":"PBLUEN","ProductPrice":19.9900},{"ProductCode":"NAILSN","ProductPrice":19.9900},{"ProductCode":"BROWPBN","ProductPrice":19.9900},{"ProductCode":"SPAREPN","ProductPrice":0.0000},{"ProductCode":"NAILSREPN","ProductPrice":0.0000},{"ProductCode":"PEDIN","ProductPrice":19.9900},{"ProductCode":"MASKN","ProductPrice":9.9900},{"ProductCode":"CSREPN","ProductPrice":9.9900},{"ProductCode":"SNREPN","ProductPrice":7.9900},{"ProductCode":"PREPN","ProductPrice":9.9900},{"ProductCode":"R219N","ProductPrice":12.9900},{"ProductCode":"SNREP2N","ProductPrice":9.9900},{"ProductCode":"STEAMN","ProductPrice":0.0000},{"ProductCode":"MASK4N","ProductPrice":29.9900},{"ProductCode":"MASK1299N","ProductPrice":12.9900},{"ProductCode":"BIKININ","ProductPrice":19.9900},{"ProductCode":"FACEBLUSHN","ProductPrice":19.9900},{"ProductCode":"BROWBLUSHN","ProductPrice":19.9900},{"ProductCode":"STEAMERN","ProductPrice":49.8800},{"ProductCode":"FACELAVN","ProductPrice":19.9900},{"ProductCode":"BUNFACEN","ProductPrice":17.5000},{"ProductCode":"BUNBROWN","ProductPrice":17.5000},{"ProductCode":"BUNNAILN","ProductPrice":17.5000},{"ProductCode":"BUNPEDIN","ProductPrice":17.5000},{"ProductCode":"BUNFACE2N","ProductPrice":17.5000},{"ProductCode":"BUNBIKN","ProductPrice":17.5000},{"ProductCode":"BUNCLSEN","ProductPrice":35.0000},{"ProductCode":"BUNDERMN","ProductPrice":17.5000},{"ProductCode":"BUNSTEAMN","ProductPrice":43.5000},{"ProductCode":"BUNFACE3N","ProductPrice":17.5000},{"ProductCode":"BUNNURN","ProductPrice":35.0000},{"ProductCode":"BUNBIK2N","ProductPrice":17.5000},{"ProductCode":"BUNCLSE2N","ProductPrice":35.0000},{"ProductCode":"BUNCONTN","ProductPrice":17.0000},{"ProductCode":"BUNICEN","ProductPrice":9.0000},{"ProductCode":"SLFACECPN","ProductPrice":13.9900},{"ProductCode":"SLFACBRWDUON","ProductPrice":29.9900},{"ProductCode":"SLFLBROWN","ProductPrice":13.9900},{"ProductCode":"SLFLBODYRN","ProductPrice":19.9900},{"ProductCode":"BUNFACEBROWBUNDLEN","ProductPrice":0.0000},{"ProductCode":"BUNNAILPEDIBUNDLEN","ProductPrice":0.0000},{"ProductCode":"BUNFACEBIKBUNDLEN","ProductPrice":0.0000},{"ProductCode":"BUNCLNSDERMBUNDLEN","ProductPrice":0.0000},{"ProductCode":"BUNFACENUBUNDLEN","ProductPrice":0.0000},{"ProductCode":"BUNCLNSCONTBUNDLEN","ProductPrice":0.0000},{"ProductCode":"MITTN","ProductPrice":19.9900},{"ProductCode":"BUNCLEANMITTBUNDLEN","ProductPrice":0.0000},{"ProductCode":"BUNCLSEMN","ProductPrice":35.0000},{"ProductCode":"BUNMITTSN","ProductPrice":17.0000},{"ProductCode":"BUNPCMITTSN","ProductPrice":17.0000},{"ProductCode":"PLAVENN","ProductPrice":19.9900},{"ProductCode":"BLACKN","ProductPrice":19.9900},{"ProductCode":"LEGTN","ProductPrice":39.9900},{"ProductCode":"FLAWLESS15","ProductPrice":0.0000},{"ProductCode":"SHIPFREE22","ProductPrice":0.0000},{"ProductCode":"UA","ProductPrice":29.9900},{"ProductCode":"SHR","ProductPrice":19.9900},{"ProductCode":"UAN","ProductPrice":29.9900},{"ProductCode":"SHRN","ProductPrice":19.9900},{"ProductCode":"WINNERONE","ProductPrice":0.0000},{"ProductCode":"WINNERTWO","ProductPrice":0.0000},{"ProductCode":"WINNERTHREE","ProductPrice":0.0000},{"ProductCode":"WINNERTEST","ProductPrice":0.0000},{"ProductCode":"WINNERTEST2","ProductPrice":0.0000},{"ProductCode":"BUNDLES15","ProductPrice":0.0000},{"ProductCode":"WELCOME10","ProductPrice":0.0000},{"ProductCode":"SHFEE","ProductPrice":0.0000},{"ProductCode":"FREEMASKN","ProductPrice":0.0000},{"ProductCode":"CBAGN","ProductPrice":0.0000},{"ProductCode":"FREESMN","ProductPrice":0.0000},{"ProductCode":"FREEADAPTN","ProductPrice":0.0000},{"ProductCode":"SPADAY","ProductPrice":0.0000},{"ProductCode":"BEAUTY25","ProductPrice":0.0000},{"ProductCode":"TIKTOK30","ProductPrice":0.0000},{"ProductCode":"FCLEANSE","ProductPrice":0.0000},{"ProductCode":"FABFAM","ProductPrice":0.0000},{"ProductCode":"GET50","ProductPrice":0.0000},{"ProductCode":"SPA30","ProductPrice":0.0000},{"ProductCode":"HANKY","ProductPrice":0.0000},{"ProductCode":"RDFFEE","ProductPrice":0.0000},{"ProductCode":"MERRY","ProductPrice":0.0000},{"ProductCode":"WINNERFOUR","ProductPrice":0.0000},{"ProductCode":"WINNERFIVE","ProductPrice":0.0000},{"ProductCode":"WINNERSIX","ProductPrice":0.0000},{"ProductCode":"FREECSPA","ProductPrice":0.0000},{"ProductCode":"HR30","ProductPrice":0.0000},{"ProductCode":"BOGOFC","ProductPrice":0.0000},{"ProductCode":"COOL23","ProductPrice":0.0000},{"ProductCode":"FF2","ProductPrice":0.0000},{"ProductCode":"SB2023","ProductPrice":0.0000},{"ProductCode":"FFSHIPFREE22","ProductPrice":0.0000},{"ProductCode":"SPRING25","ProductPrice":0.0000},{"ProductCode":"SONYA20","ProductPrice":0.0000},{"ProductCode":"DAFNE20","ProductPrice":0.0000},{"ProductCode":"KIARRA20","ProductPrice":0.0000},{"ProductCode":"MDWSALE10","ProductPrice":0.0000},{"ProductCode":"MDWSALE15","ProductPrice":0.0000},{"ProductCode":"MDWSALE20","ProductPrice":0.0000},{"ProductCode":"MOM20","ProductPrice":0.0000},{"ProductCode":"MISSYOU","ProductPrice":0.0000},{"ProductCode":"MISSEDYOU","ProductPrice":0.0000},{"ProductCode":"FREECSRH","ProductPrice":0.0000},{"ProductCode":"SPADAY1","ProductPrice":0.0000},{"ProductCode":"FW4N","ProductPrice":19.9900},{"ProductCode":"FL4N","ProductPrice":19.9900},{"ProductCode":"FB4N","ProductPrice":19.9900},{"ProductCode":"FR4N","ProductPrice":19.9900},{"ProductCode":"PARISBLUE","ProductPrice":0.0000},{"ProductCode":"BTU","ProductPrice":29.9900},{"ProductCode":"NAILEDIT","ProductPrice":0.0000},{"ProductCode":"FREEREPNU","ProductPrice":0.0000},{"ProductCode":"FREEREPPED","ProductPrice":0.0000},{"ProductCode":"FREEREPNAIL","ProductPrice":0.0000},{"ProductCode":"FREEREP2PK","ProductPrice":0.0000},{"ProductCode":"FREEREPH2PK","ProductPrice":0.0000},{"ProductCode":"FLEG","ProductPrice":0.0000}];


        document.querySelector("body").addEventListener('click', function (e) {
            var buttonElement = e.target.closest("a[data-products]");
            if (buttonElement) {
                let cartProductCode = e.srcElement.getAttribute("data-products");
                let quantityElement = document.getElementById(cartProductCode + "Qty");
                let itemQuantity = parseInt(quantityElement.value);
                let itemMaxQuantity = parseInt(quantityElement.getAttribute("data-max-qty"));
                let item = { code: cartProductCode, price: getItemPrice(cartProductCode), qty: itemQuantity };

                if (canTriggerAddToCart(item, itemQuantity, itemMaxQuantity)) {
                    let parameters = getFormattedParameters();
                    postAdvancedMatching(parameters.email, parameters.phone);
                    addToCartCheckout(item);
                }
            }
        });

        function canTriggerAddToCart(tiktokItem, itemAddQuantity, itemMaxQuantity) {
            let cantriggerAddToCart = false;
            let items = getItems();
            let itemsCount = items.length;

            if (items.length === 0) {
                cantriggerAddToCart = true;
            }
            else {
                for (let i = 0; i < itemsCount; i++) {
                    if (!cantriggerAddToCart && tiktokItem.code === items[i].id && (items[i].qty + itemAddQuantity) <= itemMaxQuantity) {
                        cantriggerAddToCart = true;
                    }
                    else if (!cantriggerAddToCart && !items[tiktokItem.code]) {
                        cantriggerAddToCart = true;
                    }
                }
            }

            return cantriggerAddToCart;
        }

        function getItemPrice(productCode) {
            let productsCount = tiktokProducts.length;
            let price = 0.00;

            for (let i = 0; i < productsCount; i++) {
                if (tiktokProducts.length > 0 && tiktokProducts[i].ProductCode === productCode) {
                    price = tiktokProducts[i].ProductPrice;
                    break;
                }
            }

            return price;
        }

        function addToCartCheckout(item) {
            var contents = [];
            contents.push({
                content_type: 'product',
                content_id: item.code,
                price: item.price,
                quantity: item.qty
            });
            var total = (item.price * item.qty);

            if (contents.length > 0) {
                ttq.instance('CCBRAOJC77U5BD5RA6L0').track('AddToCart', {
                    contents: contents,
                    value: total.toFixed(2),
                    currency: 'USD'
                });
            }
        }

        


    }(window, document, 'ttq');

</script>

<!-- End Impression -->


<!-- Code: 2818b04a-f212-4a2a-975c-b18ffe04cb91 -->
<script>
    
    $(document).ready(function () {
        
		var __fromSubmitters = [];
		$('form')
			.each(function (i, item){
				$(item).find('input[type="submit"], input[type="image"], button[type="submit"]')
				.bind('click', function (e){
					__fromSubmitters[$(item)] = $(this);
				});
			});
		$('form')
		.bind('submit', function (e){
			var self = $(this);
			if(typeof(self.attr('data-submitting-state')) == 'undefined'){
                e.preventDefault();
                if (typeof (self.attr('data-processing-message')) == 'undefined') {
                    $.facebox('<div role="alert">' + (typeof (__processingMessage) == "undefined" ? "Processing..." : __processingMessage) + '</div>');
                } else {
                    var processingMessage = self.attr('data-processing-message');
                    $.facebox('<div role="alert">' + processingMessage + '</div>');
                }
				self.attr('data-submitting-state', 'complete');
				setTimeout(function (){
                    _ValidationRunning = false;
                    var submitter = __fromSubmitters[self];
                    if (submitter != null) {
                        submitter.trigger('click');
                    } else {
                        self.submit();
                    }
				}, 250);
				return false;
			} else {
			return true;
			}
		});
        
    });
    
</script>


<link rel="stylesheet" href="https://idvftfbs.dtmstage.com/Shared/css/expresscheckout/expresscheckout.css?v=6.0.1722.1545">
<style>
    .dtm .checkout-option .grayed {
        opacity: 0.3;
    }

</style>
<script type="text/javascript" src="https://idvftfbs.dtmstage.com/Shared/js/ExpressCheckout.js?v=6.0.1722.1545"></script>
<script type="text/javascript">

    _expressCheckoutEngine.Register('PayPalEC', 1, '/shared/images/payment/paypal.svg',
        '/shared/images/pp-checkout-logo-large.png?v=6.0.1722.1545', '/shared/images/pp-checkout-logo-large.png?v=6.0.1722.1545', '/shared/images/pp-checkout-logo-large.png?v=6.0.1722.1545', '&nbsp;<a href="https://www.paypal.com/us/webapps/mpp/paypal-popup" target="_blank" class="link" style="" title="Learn How To Pay with PayPal">What is PayPal<span class="link__advisal"> <span class="link__container">Opens in a new window</span></span></a>');
    var $paymentType = $("#PaymentType");
    $(document).ready(function () {
        _expressCheckoutEngine.initialize();
    });

    registerEvent('_dtmExpressCheckoutPaymentClick', function (data) {
        if (data.detail.paymentType.match(/PayPal/i)) {

            var hasDisclaimer = typeof $('#disclaimer') != "undefined" && $('#disclaimer').length > 0;

            if ($paymentType.length === 0) { $paymentType = $("#PaymentType"); }

            
                  if ($paymentType.length > 0) {
                      $paymentType.val("paypal");
                  }
             

            if (hasDisclaimer) {
                setTimeout(function () {
                    $.scrollTo('#disclaimer');
                }, 100);
            }
        }
    });

    
</script>


<style>
    #paypal-button,
    .zoid-outlet,
    .zoid-component-frame {
        width: 300px !important;
        margin: 0 auto;
    }
</style>
<script>

    addEventListener("DOMContentLoaded", function () {

        let paypalScript = document.createElement('script');
        paypalScript.type = 'text/javascript';
        paypalScript.src = "https://www.paypalobjects.com/api/checkout.js?v=6.0.1722.1545";
        paypalScript.defer = true;
        // insert framework js into the DOM
        document.getElementsByTagName("body")[0].appendChild(paypalScript);

        let serializeScript = document.createElement('script');
        serializeScript.type = 'text/javascript';
        serializeScript.src = "/Shared/js/jquery.serialize.js?v=6.0.1722.1545";
        serializeScript.defer = true;
        // insert framework js into the DOM
        document.getElementsByTagName("body")[0].appendChild(serializeScript); 

    });
    let paypalECAuthorized = false;
    registerEvent('PaymentOptionSelected', function (data) {
        var acceptOffer = $('#AcceptOfferButton').length > 0 ? $('#AcceptOfferButton') : $('.AcceptOfferButton');
        if (/paypal/i.test(data.detail || '')) {
            if ($('#paypal-button').length == 0) {

                acceptOffer.after('<div id="paypal-button"></div>');
                paypal.Button.render({
                    env: 'production',
                    
                    payment: function (resolve) {
                        var valid = true;
                       
                        if (typeof (customPaypalValidation) === 'function') {
                            valid = customPaypalValidation();
                        }
                        if (valid && !paypalECAuthorized) {
                            var payload = $('form').serializeJSON();
                            payload["RemoteType"] = payload["OrderType"];

                            
                            payload["acceptOffer"] = "true";

                            
                            $.post('/UPGRADE/1.0000/index.dtm', payload, function (data) {
                                if (data.errors && data.errors.length > 0) {
                                    if (typeof _dtmShoppingCart != 'undefined') {
                                        _dtmShoppingCart.RemoveErrors(_dtmShoppingCart.CurrentErrors);
                                        _dtmShoppingCart.AddErrors(data.errors);
                                    } else {
                                        alert(data.errors.join());
                                    }
                                    resolve(null);

                                } else {
                                    resolve(data.details.token);
                                }
                            })
                                .error(function () {
                                    resolve(null);
                                });
                        } else {
                            resolve(null);
                        }
                    },
                    onAuthorize: function (data, actions) {
                        paypalECAuthorized = true;
                        $.facebox('<h1>' + (typeof (__processingMessage) == "undefined" ? "Processing Order . . ." : __processingMessage) + '</h1>');
                        return actions.redirect();
                    },
                    onCancel: function (data, actions) {
                        return actions.redirect();
                    },
                    onError: function (err) {
                        if (err && err.message.indexOf('Cannot read property \'indexOf\' of null') > -1) {
                            console.log("handled null token error.");
                        } else {
                            console.log(err);
                        }
                        paypal.checkout.closeFlow();
                    }
                }, '#paypal-button');
                $('#paypal-button').show();
                
                acceptOffer.hide();
            } else {
                $('#paypal-button').show();
                $('#paypalEC-disclaimer').show();
                acceptOffer.hide();
            }
        } else {
            $('#paypal-button').hide();
            $('#paypalEC-disclaimer').hide();
        }
    });

    
    if (typeof _dtm.expressCheckout === "function") {

        $(window).on('load', function (e) {
            $('#paymentFormHeadline').text('CHOOSE YOUR PAYMENT METHOD');
            
            _dtm.expressCheckout({ addPayPalButton: false });
            
        });
    }
    
</script>


<!-- 
    Load `web-vitals` using a classic script that sets the global `webVitals` object.
    https://github.com/GoogleChrome/web-vitals
 -->
<script defer src="https://idvftfbs.dtmstage.com/shared/js/web-vitals/dist/first-input-delay.min.js"></script>
<script defer src="https://idvftfbs.dtmstage.com/shared/js/web-vitals/dist/web-vitals.es5.umd.min.js"></script>
<script>
    addEventListener('DOMContentLoaded', function() {
        // webVitals.getCLS(console.log, true);
        // webVitals.getFID(console.log);
        // webVitals.getFCP(console.log);
        // webVitals.getLCP(console.log);
        // webVitals.getTTFB(console.log);

		const hud = document.querySelector(".hud");
		if (!hud) return;

		document.body.append(hud);
    });
</script>
<link rel="stylesheet" href="https://idvftfbs.dtmstage.com/shared/hud/css/hud.css?v=6.0.1722.1545" />
<script src="https://idvftfbs.dtmstage.com/shared/js/moment.min.js?v=6.0.1722.1545"></script>

<!-- // BEGIN Hud Template -->
<div class="hud">
    <div class="dtmhud-radial-menu">
        <div class="dtmhud-mask">
            
<svg class="hud__svg" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="362.215px" height="108.66px" viewBox="0 0 362.215 108.66" enable-background="new 0 0 362.215 108.66"
	 xml:space="preserve">
<g class="animate hud__svg__dtm">
	<path class="letter__d" fill="#EDC936" d="M100.38,97.328h7.452c8.383,0,12.263-4.191,12.263-12.574V23.903c0-8.381-3.88-12.572-12.263-12.572h-7.452
		V97.328z M87.963,0h20.49c16.299,0,24.06,7.76,24.06,24.061v60.538c0,16.299-7.761,24.061-24.06,24.061h-20.49V0z"/>
	<polygon class="letter__t" fill="#EDC936" points="164.562,108.66 164.562,11.486 148.263,11.486 148.263,0 193.28,0 193.28,11.486 176.981,11.486
		176.981,108.66 	"/>
	<polygon class="letter__m" fill="#EDC936" points="275.877,0 275.877,108.66 263.769,108.66 263.769,18.783 248.868,108.66 236.139,108.66
		221.238,18.783 221.238,108.66 209.44,108.66 209.44,0 228.998,0 242.815,85.686 256.627,0 	"/>
</g>
<g class="animate hud__svg__brackets">
	<g class="animate hud__svg__bracket-left">
		<polygon fill="#EDC936" points="11.676,54.589 53.803,12.37 53.803,0.72 0,54.643 53.803,108.088 53.803,96.437 	"/>
		<polygon fill="#333333" class="bracket__in" points="33.688,54.633 53.962,34.324 53.962,23.243 22.595,54.691 53.962,85.849 53.962,74.771 	"/>
		<polyline fill="#333333" class="bracket__in" points="53.976,64.243 44.257,54.59 53.976,44.847 	"/>
	</g>
	<g class="animate hud__svg__bracket-right">
		<polygon fill="#EDC936" points="308.413,0.72 308.413,12.37 350.538,54.22 308.413,96.441 308.413,108.089 362.215,54.166 	"/>
		<polygon fill="#333333" class="bracket__in" points="308.255,22.958 308.255,34.041 328.527,54.176 308.255,74.484 308.255,85.567 339.621,54.118 	"/>
		<polyline fill="#333333"  class="bracket__in" points="308.24,44.567 317.958,54.22 308.24,63.962 	"/>
	</g>
</g>
</svg>

        </div>
    </div>
    <div class="hud__overlay">
        <!--
        <div class="hud__header">
            <div class="dtmhud-mask-anchor"></div>
            <div class="hud__title">HUD</div>
        </div>
        <div class="hud__body"></div>g
        -->
    </div>
</div>

<!-- // END Hud Template -->
<script id="track_script_hud">
    (function ($) {

        // Detect touch support
        $.support.touch = 'ontouchend' in document;

        // Ignore browsers without touch support
        if (!$.support.touch) {
            return;
        }

        var mouseProto = $.ui.mouse.prototype,
            _mouseInit = mouseProto._mouseInit,
            _mouseDestroy = mouseProto._mouseDestroy,
            touchHandled;

        /**
         * Simulate a mouse event based on a corresponding touch event
         * @param {Object} event A touch event
         * @param {String} simulatedType The corresponding mouse event
         */
        function simulateMouseEvent(event, simulatedType) {

            // Ignore multi-touch events
            if (event.originalEvent.touches.length > 1) {
                return;
            }

            event.preventDefault();

            var touch = event.originalEvent.changedTouches[0],
                simulatedEvent = document.createEvent('MouseEvents');

            // Initialize the simulated mouse event using the touch event's coordinates
            simulatedEvent.initMouseEvent(
                simulatedType,    // type
                true,             // bubbles
                true,             // cancelable
                window,           // view
                1,                // detail
                touch.screenX,    // screenX
                touch.screenY,    // screenY
                touch.clientX,    // clientX
                touch.clientY,    // clientY
                false,            // ctrlKey
                false,            // altKey
                false,            // shiftKey
                false,            // metaKey
                0,                // button
                null              // relatedTarget
            );

            // Dispatch the simulated event to the target element
            event.target.dispatchEvent(simulatedEvent);
        }

        /**
         * Handle the jQuery UI widget's touchstart events
         * @param {Object} event The widget element's touchstart event
         */
        mouseProto._touchStart = function (event) {

            var self = this;

            // Ignore the event if another widget is already being handled
            if (touchHandled || !self._mouseCapture(event.originalEvent.changedTouches[0])) {
                return;
            }

            // Set the flag to prevent other widgets from inheriting the touch event
            touchHandled = true;

            // Track movement to determine if interaction was a click
            self._touchMoved = false;

            // Simulate the mouseover event
            simulateMouseEvent(event, 'mouseover');

            // Simulate the mousemove event
            simulateMouseEvent(event, 'mousemove');

            // Simulate the mousedown event
            simulateMouseEvent(event, 'mousedown');
        };

        /**
         * Handle the jQuery UI widget's touchmove events
         * @param {Object} event The document's touchmove event
         */
        mouseProto._touchMove = function (event) {

            // Ignore event if not handled
            if (!touchHandled) {
                return;
            }

            // Interaction was not a click
            this._touchMoved = true;

            // Simulate the mousemove event
            simulateMouseEvent(event, 'mousemove');
        };

        /**
         * Handle the jQuery UI widget's touchend events
         * @param {Object} event The document's touchend event
         */
        mouseProto._touchEnd = function (event) {

            // Ignore event if not handled
            if (!touchHandled) {
                return;
            }

            // Simulate the mouseup event
            simulateMouseEvent(event, 'mouseup');

            // Simulate the mouseout event
            simulateMouseEvent(event, 'mouseout');

            // If the touch interaction did not move, it should trigger a click
            if (!this._touchMoved) {

                // Simulate the click event
                simulateMouseEvent(event, 'click');
            }

            // Unset the flag to allow other widgets to inherit the touch event
            touchHandled = false;
        };

        /**
         * A duck punch of the $.ui.mouse _mouseInit method to support touch events.
         * This method extends the widget with bound touch event handlers that
         * translate touch events to mouse events and pass them to the widget's
         * original mouse event handling methods.
         */
        mouseProto._mouseInit = function () {

            var self = this;

            // Delegate the touch handlers to the widget's element
            self.element.bind({
                touchstart: $.proxy(self, '_touchStart'),
                touchmove: $.proxy(self, '_touchMove'),
                touchend: $.proxy(self, '_touchEnd')
            });

            // Call the original $.ui.mouse init method
            _mouseInit.call(self);
        };

        /**
         * Remove the touch event handlers
         */
        mouseProto._mouseDestroy = function () {

            var self = this;

            // Delegate the touch handlers to the widget's element
            self.element.unbind({
                touchstart: $.proxy(self, '_touchStart'),
                touchmove: $.proxy(self, '_touchMove'),
                touchend: $.proxy(self, '_touchEnd')
            });

            // Call the original $.ui.mouse destroy method
            _mouseDestroy.call(self);
        };

    })(jQuery);

    (function (dtmHud, $) {
        //Private Property
        var active1 = false;
        var cardTypes = null;

        var currentPage;
        var firstView = true;
        var defer = new $.Deferred();

        var $body = $('body');

        //Public Property
        dtmHud.setLinks = {};
        dtmHud.lastCardType = 'visa';

        //Public Address Collection
        dtmHud.addresses = [];
        dtmHud.addresses["Florida"] = { street: "224 Datura St", street2: "Ste 1300", city: "West Palm Beach", state: "FL", zip: "33401", country: "USA" };
        dtmHud.addresses["Georgia"] = { street: "3149 Welmingham Dr SW", street2: "", city: "Atlanta", state: "GA", zip: "30331", country: "USA" };
        dtmHud.addresses["Indiana"] = { street: "8001 Broadway", street2: "Ste 201", city: "Merrillville", state: "IN", zip: "46410", country: "USA" };
        dtmHud.addresses["California"] = { street: "4140 Redding St", street2: "", city: "Oakland", state: "CA", zip: "94619", country: "USA" };
        dtmHud.addresses["Connecticut"] = { street: "132 Terry Rd", street2: "", city: "HARTFORD", state: "CT", zip: "06105", country: "USA" };
        dtmHud.addresses["New Jersey"] = { street: "10 Charles Drive", street2: "", city: "Fairfield", state: "NJ", zip: "07004", country: "USA" };
        dtmHud.addresses["Nevada"] = { street: "1001 Shadow Ln", street2: "", city: "Las Vegas", state: "NV", zip: "89106", country: "USA" };
        dtmHud.addresses["New York"] = { street: "250 Joralemon St", street2: "", city: "Brooklyn", state: "NY", zip: "11201", country: "USA" };
        dtmHud.addresses["Ohio"] = { street: "2726 W Market St", street2: "", city: "Akron", state: "OH", zip: "44333", country: "USA" };
        dtmHud.addresses["Vermont"] = { street: "1 College St", street2: "", city: "Burlington", state: "VT", zip: "05401", country: "USA" };
        dtmHud.addresses["Pennsylvania"] = { street: "1 Pennsylvania Ave", street2: "", city: "Hanover", state: "PA", zip: "17331", country: "USA" };
        dtmHud.addresses["Utah"] = { street: "8857 S 500 E", street2: "", city: "Sandy", state: "UT", zip: "84070", country: "USA" };
        dtmHud.addresses["Washington"] = { street: "1620 N Monroe St", street2: "", city: "Spokane", state: "WA", zip: "99205", country: "USA" };
        dtmHud.addresses["Hawaii"] = { street: "1164 Bishop St", street2: "Ste 124", city: "Honolulu", state: "HI", zip: "96813", country: "USA" };
        dtmHud.addresses["Alaska"] = { street: "930 Quiet Creek Dr", street2: "", city: "Homer", state: "AK", zip: "99603", country: "USA" };
        dtmHud.addresses["Puerto Rico"] = { street: "200 Convention Boulevard", street2: "", city: "San Juan", state: "PR", zip: "00907", country: "USA" };
        dtmHud.addresses["Guam"] = { street: "1475 Pale San Vitores Rd", street2: "", city: "Tamuning", state: "GU", zip: "96913", country: "USA" };
        dtmHud.addresses["Virgin Islands"] = { street: "6900 Great Bay", street2: "", city: "St. Thomas", state: "VI", zip: "00802", country: "USA" };
        dtmHud.addresses["Canada"] = { street: "2 Carlton St", street2: "Ste 1400", city: "Toronto", state: "ON", zip: "M5B 1J3", country: "CAN" };


        dtmHud.addresses.sort(function (a, b) {
            if (a.key < b.key) return -1;
            if (a.key > b.key) return 1;
            return 0;
        });

        // Public Logo Methods
        dtmHud.gfx = {
            logo: {
                group: $('.hud__svg'),
                br: {},
                abbr: {}
            }
        }
        dtmHud.gfx.logo.br.group = dtmHud.gfx.logo.group.find('.hud__svg__brackets');
        dtmHud.gfx.logo.br.left = dtmHud.gfx.logo.br.group.find('.hud__svg__bracket-left');
        dtmHud.gfx.logo.br.right = dtmHud.gfx.logo.br.group.find('.hud__svg__bracket-right');
        dtmHud.gfx.logo.br.child = dtmHud.gfx.logo.br.group.find('.bracket__in');
        dtmHud.gfx.logo.abbr.group = dtmHud.gfx.logo.group.find('.hud__svg__dtm');
        dtmHud.gfx.logo.abbr.d = dtmHud.gfx.logo.abbr.group.find('.letter__d');
        dtmHud.gfx.logo.abbr.t = dtmHud.gfx.logo.abbr.group.find('.letter__t');
        dtmHud.gfx.logo.abbr.m = dtmHud.gfx.logo.abbr.group.find('.letter__m');

        // Public Template Builder
        dtmHud.getTemplate = function () {
            var $stylesheet = $('<link/>', {
                rel: 'stylesheet',
                type: 'text/css',
                href: '/shared/hud/css/template.css'
            }).appendTo('body');

            $stylesheet.load(function () {
                $.get('/shared/hud/view/template.html', function (response) {
                    $(response).appendTo($('.hud__overlay'));
                    $('.hud').addClass('is-ready');
                    firstView = false;
                    defer.resolve();
                });
            });

            return defer.promise();
        };

        dtmHud.removeRecaptcha = function () {
            if (typeof $('.g-recaptcha') != "undefined") {
                $('.g-recaptcha').remove();
            } 
        };

        // Public Page Finder
        dtmHud.getPage = function (page, callback) {
            if (page !== currentPage) {
                var makeRequest = function () {
                    callback = callback || function () { };
                    $.get('/shared/hud/view/' + page + '.html', function (response) {
                        $('.hud__header').removeClass('is-showing-' + currentPage);
                        currentPage = page;
                        active1 = false;
                        $('.hud__body').html(response);
                        $('.hud__header').addClass('is-showing-' + page);
                        $('.hud__header [data-hud-page-title]').text(page);
                        dtmHud.onMenuAction(true);
                        $('.hud').show();
                        $('.hud__overlay').addClass('is-overlayed');
                        $('.dtmhud-mask').appendTo($('.dtmhud-mask-anchor'));
                        callback();
                    });
                };

                if (firstView) {
                    dtmHud.getTemplate().done(makeRequest);
                } else {
                    makeRequest();
                }
            } else {
                $('.hud').show();
                $('.hud__overlay').addClass('is-overlayed');
                $('.dtmhud-mask').appendTo($('.dtmhud-mask-anchor'));
            }
        };

        // Public Module Builder
        dtmHud.build = {};
        dtmHud.build.getGridTile = function (options) {
            options = options || {};

            var $tile = $('<div/>', { class: 'hud__tile' });

            if (options.img) {
                var $imgdiv = $('<div/>', { class: 'hud__tile--img' });
                var $img = $('<img/>', { src: options.img });

                $img.appendTo($imgdiv);
                $imgdiv.appendTo($tile);
            }

            if (options.html) {
                var $html = $('<div/>', { class: 'hud__tile--img', html: options.html });
                $html.appendTo($tile);
            }

            if (options.info) {
                var $info = $('<div/>', { class: 'hud__tile--info' });
                $info.appendTo($tile);

                if (options.title) {
                    var $title = $('<div/>', {
                        class: 'hud__info--title',
                        text: options.title
                    });
                    $title.appendTo($info);
                }

                if (options.metadata) {
                    var $metadata = $('<div/>', {
                        class: 'hud__info--metadata',
                        html: options.metadata
                    });
                    $metadata.appendTo($info);
                }
            }

            if (options.callback && typeof options.callback === 'function') {
                options.callback($tile);
            }

            return $tile;
        };

        //Public Method
        dtmHud.cart = function () {
            $.post('/shared/services/dtmhud.ashx?cmd=cart&covid=b6a095f0-0809-ed11-8b97-a0369f1303c7', function (response) {
                console.log(response);
                var htmlContent = '<div style="padding: 10px">';
                htmlContent += 'Whats in my Cart <br>Cookie Date: '
                    + moment(response.CookieDate).format('M/D/YYYY h:mm:ss A') + '<br/>Visitor Exp. '
                    + moment(response.VisitorExpirationDate).format('M/D/YYYY h:mm:ss A') + '<br/>Order Exp. '
                    + moment(response.OrderExpirationDate).format('M/D/YYYY h:mm:ss A');


                if (response.cart) {
                    htmlContent += '<h4>Cart Items (DtmContext.ShoppingCart)&nbsp;<i class="fa fa-info-circle dtmhud-help-toggle"></i>' +
                        '<div class="dtmhud-help-toggleme dtmhud-help">' +
                        '<p>Cart items are persisted to the visitor session but do not belong to an order.</p>' +
                        '<p>These items are stored in this manner to keep state between refreshes or page navigations since an order does not exist yet.</p>' +
                        '</div></h4>';
                    htmlContent += renderItemsToTable(response.cart);
                }

                if (response.order && response.OrderId > 0) {
                    htmlContent += '<h4>Order Items (DtmContext.Order.OrderItems)&nbsp;<i class="fa fa-info-circle dtmhud-help-toggle"></i>' +
                        '&nbsp;<a target="_blank" href="https://international.digitaltargetmarketing.com/OrderManager.mvc/OrderDetails?orderId=' +
                        response.OrderId + '">View in CM</a>' +
                        '<div class="dtmhud-help-toggleme dtmhud-help">' +
                        '<p>Orders items are persisted to the order, these are the final items that will be exported and reportable.</p>' +
                        '</div></h4>';
                    htmlContent += renderItemsToTable(response.order);
                }

                if (response.rollbackEnabled) {
                    htmlContent += '<h4>Rollback Order Items (DtmContext.Order.ContextOrderItems)&nbsp;<i class="fa fa-info-circle dtmhud-help-toggle"></i>' +
                        '<div class="dtmhud-help-toggleme dtmhud-help">' +
                        '<p>Rollback Orders actions/items are not persisted to the order immediately.</p>' +
                        '<p>Actions after the index page are stored in a &quot;rollback&quot; bucket and are not persisted to the order until the user reaches the confirmation page.</p>' +
                        '</div></h4>';
                    htmlContent += renderItemsToTable(response.rollbackOrder);
                }
                htmlContent += '</div>';
                $.fancybox.open({
                    autoSize: false,
                    type: 'html',
                    content: htmlContent,
                    width: '80%',
                    height: '80%'
                });
            });
        };

        dtmHud.getSettings = function () {
            var $spotlight = $('<div class="hud--spotlight"><input class="spotlight__input" type="text" /></div>');
            $.fancybox({
                wrapCSS: 'fancybox--spotlight',
                content: $spotlight,
                beforeShow: function () {
                    $('.spotlight__input').keyup(function (event) {
                        if (event.keyCode == 13) {
                            var getSetting = $(this).val();
                            // get data from Setting service
                            $.post('/Shared/Services/GetSetting.ashx?getSetting=' + getSetting, function (data) {
                                if (data.length > 0) {
                                    console.log(data);
                                }
                            });
                        }
                    });
                },
            });
        };

        dtmHud.card = function () {
            if (cardTypes == null) {
                var cardNumbers = "4556162510588781,5432406724858499,5178052467438137,378282246310005,6011111111111117,5555555555554444,4444333322221111,4408041021101088,6011000990139424,4929343978169740,4012888888881881,371449635398431,5119282427392932,5431111111111111,341111111111111,6011601160116611,379601494832007,4111111111111111,3530111333300000,2223000048400011,4012000077777777,4217651111111119,2223000048400011,4012000077777777,4217651111111119,6011000990139424"
                    .split(',');
                // group by card type, take 1 per group, ax, m, d, v
                var types = [];
                for (var i = 0; i < cardNumbers.length; i++) {
                    var cn = cardNumbers[i];
                    var type = getCardType(cn);
                    var code = type.code;

                    if (types[type.name] == null) {
                        types[type.name] = { code: code, cn: cn };
                    }
                }
                cardTypes = types;
            }
        };

        jQuery.fn.outer = function () {
            return $($('<div></div>').html(this.clone())).html();
        }

        //Private Methods

        function onHelpToggle(event) {
            $(this).parent().find('.dtmhud-help').slideToggle();
        }

        function getCardType(number) {
            // visa
            var re = new RegExp("^4");
            if (number.match(re) != null)
                return { name: "visa", code: "v" };

            // Mastercard
            re = new RegExp("^5[1-5]");
            if (number.match(re) != null)
                return { name: "mastercard", code: "m" };

            // AMEX
            re = new RegExp("^3[47]");
            if (number.match(re) != null)
                return { name: "amex", code: "a" };

            // Discover
            re = new RegExp("^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)");
            if (number.match(re) != null)
                return { name: "discover", code: "d" };

            // Diners
            re = new RegExp("^36");
            if (number.match(re) != null)
                return "Diners";

            // Diners - Carte Blanche
            re = new RegExp("^30[0-5]");
            if (number.match(re) != null)
                return "Diners - Carte Blanche";

            // JCB
            re = new RegExp("^(?:2131|1800|35[0-9]{3})[0-9]{11}$");
            if (number.match(re) != null)
                return { name: "jcb", code: "j" };

            // Visa Electron
            re = new RegExp("^(4026|417500|4508|4844|491(3|7))");
            if (number.match(re) != null)
                return "Visa Electron";

            return "";
        }

        function getTestAddress(isFloridaUser, location) {
            var value = isFloridaUser ? dtmHud.addresses["Florida"] : dtmHud.addresses["Indiana"];
            if (location != null && location.length > 0 && dtmHud.addresses.hasOwnProperty(location)) {
                value = dtmHud.addresses[location];
            }

            return value;
        }

        dtmHud.onSelectCardType = function (type, showLocationDialog, location) {
            var cardNumber = cardTypes[type].cn;
            var expMonth = "05";
            var expYear = "2025";
            var firstName = "Tester";// make request to CM to get username, if user is currently authenticated to CM, it should return you the name, if not leave default Tester
            var lastName = "Unknown";
            var fullName = firstName + " " + lastName;
            var isFloridaUser = "False".toLowerCase() == "true";
            dtmHud.lastCardType = type;
            var closeHud = false;

            var email = firstName + "@digitaltargetmarketing.com";
            var phone = "555-555-5555";
            var cvv = type == "amex" ? "1234" : "123"

            var address = {};
            if (showLocationDialog != null && showLocationDialog && location == null) {
                dtmHud.getPage('locations', function () { currentPage = ''; });
            }
            else if (location != null) {
                address = getTestAddress(isFloridaUser, location);
                closeHud = true;
            }
            else {
                address = getTestAddress(isFloridaUser);
            }

            var formValues =
                {
                    firstName: firstName,
                    lastName: lastName,
                    fullName: fullName,
                    street: address.street,
                    street2: address.street2,
                    city: address.city,
                    state: address.state,
                    zip: address.zip,
                    country: address.country,
                    cardNumber: cardNumber,
                    expMonth: expMonth,
                    expYear: expYear,
                    cvv2: cvv,
                    email: email,
                    phone: phone
                };

            if ($('.checkout-option').length > 0) {
                // select card type
                $('#otCARD').trigger('click');
            }

            if (closeHud) {
                dtmHud.onMenuAction();
            }

            $.scrollTo('#paymentForm');
            setFormValue('#BillingFirstName', formValues.firstName);
            setFormValue('#BillingLastName', formValues.lastName);
            setFormValue('#BillingFullName', formValues.fullName);
            setFormValue('#BillingName', formValues.fullName);
            setFormValue('#BillingStreet', formValues.street);
            setFormValue('#BillingStreet2', formValues.street2);
            setFormValue('#BillingCity', formValues.city);
            setFormValue('#BillingState', formValues.state);
            setFormValue('#BillingZip', formValues.zip);
            setFormValue('#BillingCountry', formValues.country);
            setFormValue('#CardNumber', formValues.cardNumber, true);
            setFormValue('#CardExpirationMonth', formValues.expMonth);
            setFormValue('#CardExpirationYear', formValues.expYear);
            setFormValue('#CardCvv2', formValues.cvv2);
            setFormValue('#Email', formValues.email);
            setFormValue('#Phone', formValues.phone);

            history.pushState(null, null, '?cc=' + cardTypes[type].code);
        }

        function setFormValue(target, value , triggerChange) {
            if ($(target).length > 0) {
                var setValue = false;
                if ($(target).is("select")) {
                    if ($(target + ' option[value="' + value + '"]').length > 0
                        || $(target + ' option:contains("' + value + '")').length > 0) {
                        setValue = true;
                    }
                } else {
                    setValue = true;
                }

                if (setValue) {
                    $(target).val(value);
                }

                if (triggerChange != null && triggerChange){
                     $(target).change();
                }
                
            }
        }

        function showPopup() {
            $('.dtmhud-overlay')
                .css('visibility', 'visible')
                .css('opacity', 1);
        }

        function onClose() {
            $('.dtmhud-overlay')
                .css('visibility', 'hidden')
                .css('opacity', 0);
        }

        function renderItemsToTable(items) {
            /*
            {
                ProductName,
                ProductSku,
                ProductCode,
                ProductType,
                Price,
                Shipping,
                Quantity
            }
            */
            var htmlContent = '';
            htmlContent += '<table class="orderItemsTable reviewTable">';
            htmlContent += '<thead class="reviewTableHead"><tr><th>Product Code</th><th>Product</th><th>Price</th><th>Shipping</th><th>Qty</th></tr></thead>';
            htmlContent += '<tbody>';
            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                htmlContent += '<tr>' +
                    '<td>' + item.ProductCode + '</td>' +
                    '<td>' + item.ProductName + '</td>' +
                    '<td>' + item.Price + '</td>' +
                    '<td>' + item.Shipping + '</td>' +
                    '<td>' + item.Quantity + '</td>' +
                    '</tr>';
            }
            htmlContent += '</tbody>';
            htmlContent += '</table>';
            return htmlContent;
        }

        dtmHud.onMenuAction = function (preventDefaultPage) {
            active1 === false ? dtmHud.openAnimation(dtmHud.gfx.logo, preventDefaultPage) : dtmHud.closeAnimation(dtmHud.gfx.logo);
            active1 = !active1;
        }

        dtmHud.openAnimation = function (_, preventDefaultPage) {

            _.group.attr('data-animate', 'scale-down');
            _.br.group.css('transform', 'rotate(0)');
            _.br.child.attr('data-animate', 'fade-out');

            $.each([_.br.left, _.br.right], function (k, v) {
                v.attr('data-animate', 'horizontal-out');
            });

            $.each([_.abbr.d, _.abbr.t, _.abbr.m], function (k, v) {
                v.attr('data-animate', 'vertical-in');
            });

            _.abbr.group.attr('data-animate', 'fade-in');

            if (!preventDefaultPage || typeof preventDefaultPage !== 'boolean') {
                dtmHud.getPage(currentPage || 'hud');
            }

        };

        dtmHud.closeAnimation = function (_, status) {
            switch (status) {

                // switch toggles to close animation position
                case 1:
                default:

                    _.br.child.attr('data-animate', 'fade-in');
                    $.each(['left', 'right'], function (k, v) {
                        _.br[v].attr('data-animate', 'horizontal-in-' + v);
                    });

                    $.each([_.abbr.d, _.abbr.m], function (k, v) {
                        v.attr('data-animate', 'vertical-out-down');
                    });

                    _.abbr.t.attr('data-animate', 'vertical-out-top');
                    _.abbr.group.attr('data-animate', 'fade-out');

                    $('.dtmhud-mask').appendTo($('.dtmhud-radial-menu'));

                    break;

                // update transiton states after CSS animation is complete
                case 2:

                    _.group.attr('data-animate', 'scale-up');
                    _.br.group.attr('data-animate', 'spin-out')
                        .removeAttr('style');

                    _.br.group.removeAttr('data-animate');

                    break;

            }

            $('.hud__overlay').removeClass('is-overlayed');

        };

        // define a handler
        function filterKeystroke(e) {
            // key command G translates to key code 71
            if (e.altKey && e.keyCode === 71) {
                if (currentPage !== 'graphics') {
                    dtmHud.getPage('graphics', function () {
                        dtmHud.getGraphics('shop');
                    });
                } else {
                    dtmHud.onMenuAction();
                }
                return false;
            }

            // key command L translates to key code 76
            if (e.altKey && e.keyCode === 76) {
                if (currentPage !== 'links') {
                    dtmHud.getPage('links');
                } else {
                    dtmHud.onMenuAction();
                }
                return false;
            }

            // key command V translates to key code 86
            if (e.altKey && e.keyCode === 86) {
                dtmHud.onSelectCardType('visa', e.ctrlKey);
                dtmHud.closeAnimation(dtmHud.gfx.logo);
            }

            // key command M translates to key code 77
            if (e.altKey && e.keyCode === 77) {
                dtmHud.onSelectCardType('mastercard', e.ctrlKey);
                //if (!e.ctrlKey) {
                //    dtmHud.closeAnimation(dtmHud.gfx.logo);
                //}
            }

            // key command A translate to key code 65
            if (e.altKey && e.keyCode === 65) {
                dtmHud.onSelectCardType('amex', e.ctrlKey);
                dtmHud.closeAnimation(dtmHud.gfx.logo);
            }

            // key command D translate to key code 68
            if (e.altKey && e.keyCode === 68) {
                dtmHud.onSelectCardType('discover', e.ctrlKey);
                dtmHud.closeAnimation(dtmHud.gfx.logo);
            }

            // key command J translate to key code 74
            if (e.altKey && e.keyCode === 74) {
                dtmHud.onSelectCardType('jcb', e.ctrlKey);
                dtmHud.closeAnimation(dtmHud.gfx.logo);
            }


            // key command S to translate to key code 83
            if (e.altKey && e.keyCode === 83) {
                console.log(dtmHud.getSettings());
            }

            //// key command C to translate to key code 67
            //if (e.altKey && e.keyCode === 67) {
            //    console.log(dtmHud.snippet());
            //}

            // key command T to translate to key code 84
            if (e.altKey && e.keyCode === 84) {
                console.log(dtmHud.cart());
            }

            // key command R to translate to key code 84
            if (e.altKey && e.keyCode === 82) {
                dtmHud.removeRecaptcha();
            }
        }

        // Events
        $(document).ready(function () {
            // cache body element
            var $body = $('body');

            $('.dtmhud-mask').on('click', dtmHud.onMenuAction);
            $('.dtmhud-close').on('click', onClose);
            $('body').on('click', '.dtmhud-help-toggle', onHelpToggle);

            try {
                $('.dtmhud-radial-menu').draggable();
            } catch (e) {
                console.warn(e.message);
            }

            $('body').on('click', '[data-hud-page]', function () {
                var page = $(this).data('hud-page');
                dtmHud.getPage(page);
            });

            $('body').on('click', '[data-recaptcha]', function () {
                dtmHud.removeRecaptcha();
                dtmHud.onMenuAction();
            });

            // register the handler
            document.addEventListener('keyup', filterKeystroke, false);

            // force SVG to anchor at the center origin
            dtmHud.gfx.logo.br.group.css('transform', 'rotate(90deg)');

            dtmHud.gfx.logo.abbr.group.on('oanimationend msAnimationEnd animationend', function () {
                // we only want to run during the closing animation phase

                if ($(this).attr('data-animate') === 'fade-out') {
                    dtmHud.closeAnimation(dtmHud.gfx.logo, 2);
                }
            });

            dtmHud.card();

            // check if query contains special getgraphics with parameter
            if (window.location.search.match(/getgraphics=/g)) {
                // fetch value of getgraphics (should match a folder name)
                
                dtmHud.getPage('graphics', function () {
                    //dtmHud.onMenuAction(true);
                    dtmHud.getGraphics('');
                });
            }

            // check if query contains special autofill with parameter
            if (window.location.search.match(/cc=/g)) {
                // check if query contains visa
                if (window.location.search.match(/cc=v/g)) {
                    dtmHud.onSelectCardType('visa');
                    // check if query contains master card
                } else if (window.location.search.match(/cc=m/g)) {
                    dtmHud.onSelectCardType('mastercard');
                    // check if query contains amex
                } else if (window.location.search.match(/cc=a/g)) {
                    dtmHud.onSelectCardType('amex');
                    // check if query contains discover
                } else if (window.location.search.match(/cc=d/g)) {
                    dtmHud.onSelectCardType('discover');
                }
                else if (window.location.search.match(/cc=j/g)) {
                    dtmHud.onSelectCardType('jcb');
                }
            }

            if (window.location.search.match(/linkcheck/g)) {
                dtmHud.getPage('links');
            }

            if (window.location.search.match(/perfcheck/g)) {
                dtmHud.getPage('performance');
            }
            //if (window.location.search.match(/snippet[=]/g)) {
            //    dtmHud.snippet();
            //    $.scrollTo('[data-sn-id="' + QueryString.snippet + '"].dtm-sn-footer');
            //}
        });
    }(window.dtmHud = window.dtmHud || {}, jQuery));
</script>

<link rel="stylesheet" href="https://idvftfbs.dtmstage.com/shared/hud/css/popover.css">

<script src="https://idvftfbs.dtmstage.com/shared/js/dtm-form-listener.js" defer></script>
<script>
    (function () {
        if (window.dtmFormListener) {
            window.dtmFormListener.Init();
        } else {
            addEventListener("DTMFormListenerReady", function () {
                window.dtmFormListener.Init();
            });
        }
    })();
</script>

    <style>
        .hud {
            display: none;
        }
    </style>
</div>

<script>
    //updateAddToCartSection();

    function updateAddToCartSection() {
        $('.product-variant__radio').click(function () {
            var newAddToCartSection = $("#" + this.value + "_AddToCartSection");
            var str = $(this.name).selector;
            var groupSectionValue = str.substring(
                str.indexOf("-") + 1,
                str.lastIndexOf("-")
            );
            var addToCartGroupSection = $("." + groupSectionValue + "_AddToCartSectionGroup");

            addToCartGroupSection.hide();
            newAddToCartSection.show();
        });
    }

    const setBraintreeHostedFieldsStyles = function () {
        return {
            'font-size': '1em',
            'font-family': 'Helvetica, Arial, sans-serif',
            'font-weight': 'normal',
            'line-height': 'normal',
            'color': '#333',
        };
    };
</script>
<script>
    window.addEventListener("klaviyoForms", function (e) {
        console.log("klaviyo test", e);

        if (e && e.detail && e.detail.type == 'submit') {
            var formEvent = e.detail;
            if (formEvent.formId == 'T9QMVM' || formEvent.formId == 'TXkScX') {
                var promo = document.getElementById("promoCode");
                var btn = document.getElementById("emailSubscribeButton");
                if (promo && btn) {
                    promo.value = "WELCOME10";
                    btn.click();
                } else {
                    handleCartChange("WELCOME10", 1);
                }

            }
        }
    });
</script>


	</body>

</html>
<!-- 62.4004, [0d0cc9a6-1599-44b2-9f58-4768f5fec622], 75|69|82|82|73|71|65|78 -->